<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Quay for Federation | Pablo Iranzo G√≥mez blog</title><meta name=keywords content="Quay,Kubernetes,container,federation,OpenShift,FOSS"><meta name=description content="Why this article?
For Federation of OpenShift/Kubernetes clusters we want not only to demo some applications, but build a solution that covers all that will be needed in a real-world deployment.
Colleagues in the Solutions Engineering team have been working on
demonstrating an application running on different clusters over a Federated Control Plane, allowing it to &lsquo;roam&rsquo; between clusters with shared data access as a way to demonstrate how an application can &lsquo;scale&rsquo; from on-premise deployment to external clouds in order to satisfy business requirements for peak demands."><meta name=author content="Pablo Iranzo G√≥mez"><link rel=canonical href=https://iranzo.io/blog/2019/01/08/quay-for-federation/><meta name=google-site-verification content="Bk4Z5ucHLyPXqlZlj5LzANpYBBSvxqBW4E8i-Kwf-bQ"><meta name=yandex-verification content="993ede96cdfbee95"><link crossorigin=anonymous href=../../../../../assets/css/stylesheet.css rel="preload stylesheet" as=style><link rel=icon href=https://iranzo.io/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://iranzo.io/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://iranzo.io/favicon-32x32.png><link rel=apple-touch-icon href=https://iranzo.io/apple-touch-icon.png><link rel=mask-icon href=https://iranzo.io/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://iranzo.io/blog/2019/01/08/quay-for-federation/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script async src="https://www.googletagmanager.com/gtag/js?id=G-ZL9P943TP1"></script><script>var dnt,doNotTrack=!1;if(!1&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-ZL9P943TP1")}</script><meta property="og:url" content="https://iranzo.io/blog/2019/01/08/quay-for-federation/"><meta property="og:site_name" content="Pablo Iranzo G√≥mez blog"><meta property="og:title" content="Quay for Federation"><meta property="og:description" content="Why this article? For Federation of OpenShift/Kubernetes clusters we want not only to demo some applications, but build a solution that covers all that will be needed in a real-world deployment.
Colleagues in the Solutions Engineering team have been working on demonstrating an application running on different clusters over a Federated Control Plane, allowing it to ‚Äòroam‚Äô between clusters with shared data access as a way to demonstrate how an application can ‚Äòscale‚Äô from on-premise deployment to external clouds in order to satisfy business requirements for peak demands."><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="article:section" content="blog"><meta property="article:published_time" content="2019-01-08T17:30:36+01:00"><meta property="article:modified_time" content="2023-08-25T09:48:47+00:00"><meta property="article:tag" content="Quay"><meta property="article:tag" content="Kubernetes"><meta property="article:tag" content="Container"><meta property="article:tag" content="Federation"><meta property="article:tag" content="OpenShift"><meta property="article:tag" content="FOSS"><meta property="og:image" content="https://iranzo.io/mugshot.png"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://iranzo.io/mugshot.png"><meta name=twitter:title content="Quay for Federation"><meta name=twitter:description content="Why this article?
For Federation of OpenShift/Kubernetes clusters we want not only to demo some applications, but build a solution that covers all that will be needed in a real-world deployment.
Colleagues in the Solutions Engineering team have been working on
demonstrating an application running on different clusters over a Federated Control Plane, allowing it to &lsquo;roam&rsquo; between clusters with shared data access as a way to demonstrate how an application can &lsquo;scale&rsquo; from on-premise deployment to external clouds in order to satisfy business requirements for peak demands."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Blogs","item":"https://iranzo.io/blog/"},{"@type":"ListItem","position":2,"name":"Quay for Federation","item":"https://iranzo.io/blog/2019/01/08/quay-for-federation/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Quay for Federation","name":"Quay for Federation","description":"Why this article? For Federation of OpenShift/Kubernetes clusters we want not only to demo some applications, but build a solution that covers all that will be needed in a real-world deployment.\nColleagues in the Solutions Engineering team have been working on demonstrating an application running on different clusters over a Federated Control Plane, allowing it to \u0026lsquo;roam\u0026rsquo; between clusters with shared data access as a way to demonstrate how an application can \u0026lsquo;scale\u0026rsquo; from on-premise deployment to external clouds in order to satisfy business requirements for peak demands.\n","keywords":["Quay","Kubernetes","container","federation","OpenShift","FOSS"],"articleBody":"Why this article? For Federation of OpenShift/Kubernetes clusters we want not only to demo some applications, but build a solution that covers all that will be needed in a real-world deployment.\nColleagues in the Solutions Engineering team have been working on demonstrating an application running on different clusters over a Federated Control Plane, allowing it to ‚Äòroam‚Äô between clusters with shared data access as a way to demonstrate how an application can ‚Äòscale‚Äô from on-premise deployment to external clouds in order to satisfy business requirements for peak demands.\nThis article tries to demonstrate on how to setup Quay, as a container registry for your applications, in a way that can work both for this Federated approach as well as High-Availability setup.\nWhat is Quay? The one liner would be: Quay is a container registry.\nThe extended one, would be more in the lines of:\nQuay is a container registry that can be used via the provided service at https://quay.io or can be used via Quay Enterprise as ‚Äòon premise‚Äô registry.\nA container registry provides a point for containers to be downloaded or uploaded for later consumption.\nWhy quay? Quay allows to be configured either to use the provided service via https://quay.io or deploy it on premise, so that you gain additional control over the setup like which namespaces to replicate, policies, etc.\nQuay features clair analysis of images, allowing to detect known vulnerabilities from different sources to later check the images.\nAlso, allows to automate builds when a push to a repository has happened, allowing to quickly spawn an update container image when our tracked repository has a new commit that can be later updated in our OpenShift/Kubernetes image stream.\nQuay can also, when having several storage backends defined, do geo-replication, that allows OpenShift to grab the needed bytes from the closest backend while handling in the background the copy of new data to the other replicas.\nWhat is Swift? Swift is object storage provided by OpenStack Environment, defined at https://wiki.openstack.org/wiki/Swift as:\nThe OpenStack Object Store project, known as Swift, offers cloud storage software so that you can store and retrieve lots of data with a simple API. It‚Äôs built for scale and optimized for durability, availability, and concurrency across the entire data set. Swift is ideal for storing unstructured data that can grow without bound.\nSwift allows to define a container (not in the https://www.opencontainers.org/ sense but in a ‚Äòdata storage‚Äô).\nHow does it come to play with Quay? Quay allows to define storage backend based on swift that can be used together with other backends to provide geo-replication for availability.\nThe Setup process of Swift for Quay At the beginning it was not easy to find out all the required configuration variables or settings to define, but what finally worked for the setup described in this article was:\nCreate the Swift container First we do need to create a swift container in OpenStack that will hold the information from Quay:\nCreate swift container for holding the storage:\n(overcloud) [stack@osp-ait-director ~]$ openstack container create quay-enterprise Output: account container x-trans-id AUTH_b3b8ce2eca3c4556ac01c12772b0d141 quay-enterprise txd7d654f499db457da0fa0-005bf53d32 Configuration settings defined in Quay Setting Value Storage Engine OpenStack Storage (Swift) Swift Auth Version 3 Swift Auth URL \\$YOURKEYSTONE PUBLIC ENDPOINT (like http://aaa.bbb.ccc.ddd:5000) Swift container name \\$YOURCONTAINER (created with swift container create ‚Äôname‚Äô) Storage path \\$WHATEVER (we did use /quay) Username \\$OSP_USERNAME (we did use admin) key/password \\$OSP_PASSWORD(we did use redhat) OS OPTIONS drop-down \u003c‚Äî‚Äì This is an important one if not it will fail tenant_id \\$YOURTENANTID (I did use ‚Äòadmin‚Äô id as obtained with openstack project list|grep admin) Once done, Quay should ‚Äòvalidate‚Äô the upload and swift list $YOURCONTAINER should give something like:\n(overcloud) [stack@osp-director ~]$ swift list quay-enterprise quay/_verify Showing that the verification file has been created succesfully.\nGeoreplication Quay allows to define several backends that can be also configured as a foundation for GeoReplication.\nGeoreplication in quay, is used to:\ndefine a ‚Äòzone name‚Äô for a storage backend when booting Quay containers or apps, define which backend is ‚Äòclosest‚Äô (via environment variable QUAY_DISTRIBUTED_STORAGE_PREFERENCE) Quay will store and replicate on the different backends defined the information uploaded. The requirement is that the backend is an object storage, but you can also define ‚Äòmixed‚Äô backends like for example GCE, AWS, Swift, Ceph RadosGW, etc. Quay will take care of the copy and once the backend ‚Äòclosest‚Äô to the quay instance is ready, it will serve from that one (or fallback to the one having the actual data).\nFor each one of the configured backends, a different number of settings will be requested to do the proper configuration.\nGoogle Cloud Storage For setting Google Cloud Storage, we did use the following values:\nSetting Value Location ID $yourvalue Storage Engine Google Cloud Storage Cloud Access Key GOOGXXXXXXXX Cloud Secret Key pksXXXXXX GCS Bucket quay-enterprise Storage Directory /datastorage/registry Amazon S3 For setting Amazon S3 storage, we did use the following values:\nSetting Value Location ID $yourvalue Storage Engine Amazon S3 S3 Bucket quay-enterprise Storage Directory /quay/ait AWS Access Key AKIAXXXXXXXX AWS Secret Key /9bkfXXXXXXXXXX Validation of the replication Once all the defined storage backends have been configured, there‚Äôs a button in the interface that will validate access and create the ‚Äòmarker‚Äô files on each storage backend to verify the access permissions to them similar to what was shown on Swift configuration.\nQuay SSL deployment This procedure will guide you through the configuration of Quay with SSL certificates so the deployment is both secure and deployed in a highly available enterprise way.\nSSL Certificates Setting up certificates requires several steps involving:\nCreating a CA Create a Certificate Signing Request with all the possible quay hostnames Sign the certificates Upload the certificates on Quay Create CA Execution of generate-ca.sh\n./generate-ca.sh With output:\n2018/11/29 15:01:13 [INFO] generating a new CA key and certificate from CSR 2018/11/29 15:01:13 [INFO] generate received request 2018/11/29 15:01:13 [INFO] received CSR 2018/11/29 15:01:13 [INFO] generating key: rsa-2048 2018/11/29 15:01:13 [INFO] encoded CSR 2018/11/29 15:01:13 [INFO] signed certificate with serial number 432855461933024796113382064222588753737107796958 And creates:\n-rw-rw-r--. 1 iranzo iranzo 232 nov 29 15:01 ca-config.json -rw-r--r--. 1 iranzo iranzo 1001 nov 29 15:01 ca.csr -rw-rw-r--. 1 iranzo iranzo 208 nov 29 15:01 ca-csr.json -rw-------. 1 iranzo iranzo 1679 nov 29 15:01 ca-key.pem -rw-rw-r--. 1 iranzo iranzo 1359 nov 29 15:01 ca.pem Create Quay Certs We are going to use the same certificate for each replica, we need to know the hostname that will be used on the OCP routes beforehand in order to use it for the SAN property in the certificate.\nHaving each of the routes in the SAN makes it possible to use the same cert for each replica, so we can federate a single secret containing those certs rather than creating one SSL secret for each cluster.\nExecution of generate-cert.sh\n./generate-cert.sh quay-enterprise With output:\n2018/11/29 15:01:26 [INFO] generate received request 2018/11/29 15:01:26 [INFO] received CSR 2018/11/29 15:01:26 [INFO] generating key: rsa-2048 2018/11/29 15:01:26 [INFO] encoded CSR 2018/11/29 15:01:26 [INFO] signed certificate with serial number 570248288515480165542553575432827729263232937534 Now, we have all the required certificates for Quay generated.\n-rw-r--r--. 1 iranzo iranzo 1001 nov 29 15:01 quay-enterprise.csr -rw-rw-r--. 1 iranzo iranzo 208 nov 29 15:01 quay-enterprise-csr.json -rw-------. 1 iranzo iranzo 1675 nov 29 15:01 quay-enterprise-key.pem -rw-rw-r--. 1 iranzo iranzo 1809 nov 29 15:01 quay-enterprise.pem Load Quay certificates Now using the web interface of quay, we can start uploading the certificates required for operation.\nCustom SSL Certificates Here, load the quay.pem\nServer Configuration **TLS** Certificate: load the quay-enterprise.pem Key: load the quay-enterprise-key.pem\nAt this point Quay will be using the certificates, but by default the service created only works on port 80.\nREMEMBER: We‚Äôll need to edit:\nthe app the route So that both work on port 443 instead of port 80 that is used by default.\nWe‚Äôll also need to load ca.pem and quay-enterprise.pem into our /etc/pki/ca-trust/source/anchors folder and then run:\nupdate-ca-trust extract service docker restart # Now let's go login into the registry docker login https://quay-enterprise-quay-enterprise.apps.leo-fed.e2e.bos.example.com # Let's download a container: docker pull quay.io/mavazque/pacman # let's tag and upload to our registry docker images|grep pacman quay.io/mavazque/pacman latest 6c5211874850 29 hours ago 689 MB # Tag and upload # Find image docker images|grep pacman quay.io/mavazque/pacman latest 6c5211874850 29 hours ago 689 MB # Tag image docker tag 6c5211874850 quay-enterprise-quay-enterprise.apps.leo-fed.e2e.bos.example.com/admin/pacman:latest # Upload image docker push quay-enterprise-quay-enterprise.apps.leo-fed.e2e.bos.example.com/admin/pacman The push refers to a repository [quay-enterprise-quay-enterprise.apps.leo-fed.e2e.bos.example.com/admin/pacman] fb2d3be23d30: Pushed c02d067bd364: Pushed 3edd111b03f2: Pushed 2221babd26ac: Pushed 911d290ce59f: Pushed fae583f1d4e5: Pushed 9d22e51f0c6d: Pushed 58b8d417193d: Pushing [===================================\u003e ] 225.5 MB/320.1 MB 704a8634956f: Pushing [==================================================\u003e] 127 MB 05f0b6bcfa5c: Pushed 0972cc82b682: Pushing [=============================\u003e ] 74.2 MB/126.8 MB OpenShift certificate Unless we also load the SSL certificate from Quay into OpenShift, we‚Äôll be facing issues like this: Wrap up At this point, we‚Äôve Quay setup for using geo-replication for HA and faster speeds from each cluster, we do have an underlying postgres setup using replication across sites and the URL‚Äôs have been secured for being used by our servers downloading images from there to deploy our applications.\nHope that you‚Äôve enjoyed it!\n","wordCount":"1492","inLanguage":"en","image":"https://iranzo.io/mugshot.png","datePublished":"2019-01-08T17:30:36+01:00","dateModified":"2023-08-25T09:48:47.258Z","author":{"@type":"Person","name":"Pablo Iranzo G√≥mez"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://iranzo.io/blog/2019/01/08/quay-for-federation/"},"publisher":{"@type":"Organization","name":"Pablo Iranzo G√≥mez blog","logo":{"@type":"ImageObject","url":"https://iranzo.io/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://iranzo.io/ accesskey=h title="Home (Alt + H)"><img src=https://iranzo.io/apple-icon-152x152.png alt aria-label=logo height=35>Home</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)" aria-label="Toggle theme">
<svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
<svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button><ul class=lang-switch><li>|</li><li><a href=https://iranzo.io/es/ title=Spanish aria-label=Spanish>Es</a></li></ul></div></div><ul id=menu><li><a href=https://iranzo.io/ title=üè†Home><span>üè†Home</span></a></li><li><a href=https://iranzo.io/about/ title=üóíÔ∏èAbout><span>üóíÔ∏èAbout</span></a></li><li><a href=https://iranzo.io/redken_bot/ title=üêòredken_bot><span>üêòredken_bot</span></a></li><li><a href=https://iranzo.io/projects/ title=üìêProjects><span>üìêProjects</span></a></li><li><a href=https://iranzo.io/archives/ title="üóÑÔ∏è Archives"><span>üóÑÔ∏è Archives</span></a></li><li><a href=https://iranzo.io/categories/ title=üó∫Ô∏èCategories><span>üó∫Ô∏èCategories</span></a></li><li><a href=https://iranzo.io/tags/ title=üè∑Ô∏èTags><span>üè∑Ô∏èTags</span></a></li><li><a href=https://iranzo.io/search title="üîéSearch (Alt + /)" accesskey=/><span>üîéSearch</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://iranzo.io/>Home</a>&nbsp;¬ª&nbsp;<a href=https://iranzo.io/blog/>Blogs</a></div><h1 class="post-title entry-hint-parent">Quay for Federation</h1><div class=post-meta><span title='2019-01-08 17:30:36 +0100 +0100'>January 8, 2019</span>&nbsp;¬∑&nbsp;8 min&nbsp;¬∑&nbsp;Pablo Iranzo G√≥mez</div></header><div class=toc><details open><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><ul><li><a href=#why-this-article aria-label="Why this article?">Why this article?</a></li><li><a href=#what-is-quay aria-label="What is Quay?">What is Quay?</a></li><li><a href=#why-quay aria-label="Why quay?">Why quay?</a></li><li><a href=#what-is-swift aria-label="What is Swift?">What is Swift?</a><ul><li><a href=#how-does-it-come-to-play-with-quay aria-label="How does it come to play with Quay?">How does it come to play with Quay?</a></li><li><a href=#the-setup-process-of-swift-for-quay aria-label="The Setup process of Swift for Quay">The Setup process of Swift for Quay</a><ul><li><a href=#create-the-swift-container aria-label="Create the Swift container">Create the Swift container</a></li><li><a href=#configuration-settings-defined-in-quay aria-label="Configuration settings defined in Quay">Configuration settings defined in Quay</a></li></ul></li></ul></li><li><a href=#georeplication aria-label=Georeplication>Georeplication</a><ul><li><a href=#google-cloud-storage aria-label="Google Cloud Storage">Google Cloud Storage</a></li><li><a href=#amazon-s3 aria-label="Amazon S3">Amazon S3</a></li><li><a href=#validation-of-the-replication aria-label="Validation of the replication">Validation of the replication</a></li></ul></li><li><a href=#quay-ssl-deployment aria-label="Quay SSL deployment">Quay SSL deployment</a><ul><li><a href=#ssl-certificates aria-label="SSL Certificates">SSL Certificates</a><ul><li><a href=#create-ca aria-label="Create CA">Create CA</a></li><li><a href=#create-quay-certs aria-label="Create Quay Certs">Create Quay Certs</a></li><li><a href=#load-quay-certificates aria-label="Load Quay certificates">Load Quay certificates</a></li></ul></li><li><a href=#openshift-certificate aria-label="OpenShift certificate">OpenShift certificate</a></li></ul></li><li><a href=#wrap-up aria-label="Wrap up">Wrap up</a></li></ul></div></details></div><div class=post-content><h2 id=why-this-article>Why this article?<a hidden class=anchor aria-hidden=true href=#why-this-article>#</a></h2><p>For Federation of OpenShift/Kubernetes clusters we want not only to demo some applications, but build a solution that covers all that will be needed in a real-world deployment.</p><p>Colleagues in the Solutions Engineering team have been working on
demonstrating an application running on different clusters over a Federated Control Plane, allowing it to &lsquo;roam&rsquo; between clusters with shared data access as a way to demonstrate how an application can &lsquo;scale&rsquo; from on-premise deployment to external clouds in order to satisfy business requirements for peak demands.</p><p>This article tries to demonstrate on how to setup Quay, as a container registry for your applications, in a way that can work both for this Federated approach as well as High-Availability setup.</p><h2 id=what-is-quay>What is Quay?<a hidden class=anchor aria-hidden=true href=#what-is-quay>#</a></h2><p>The one liner would be: <code>Quay is a container registry</code>.</p><p>The extended one, would be more in the lines of:</p><blockquote><p>Quay is a container registry that can be used via the provided service at <a href=https://quay.io>https://quay.io</a> or can be used via Quay Enterprise as &lsquo;on premise&rsquo; registry.</p></blockquote><p>A container registry provides a point for containers to be downloaded or uploaded for later consumption.</p><h2 id=why-quay>Why quay?<a hidden class=anchor aria-hidden=true href=#why-quay>#</a></h2><p>Quay allows to be configured either to use the provided service via <a href=https://quay.io>https://quay.io</a> or deploy it on premise, so that you gain additional control over the setup like which namespaces to replicate, policies, etc.</p><p>Quay features <code>clair</code> analysis of images, allowing to detect known vulnerabilities from different sources to later check the images.</p><p>Also, allows to automate builds when a push to a repository has happened, allowing to quickly spawn an update container image when our tracked repository has a new commit that can be later updated in our OpenShift/Kubernetes image stream.</p><p>Quay can also, when having several storage backends defined, do <a href=../../../../../blog/2019/01/08/quay-for-federation/#georeplication>geo-replication</a>, that allows OpenShift to grab the needed bytes from the closest backend while handling in the background the copy of new data to the other replicas.</p><h2 id=what-is-swift>What is Swift?<a hidden class=anchor aria-hidden=true href=#what-is-swift>#</a></h2><p>Swift is object storage provided by OpenStack Environment, defined at <a href=https://wiki.openstack.org/wiki/Swift>https://wiki.openstack.org/wiki/Swift</a> as:</p><blockquote><p>The OpenStack Object Store project, known as Swift, offers cloud storage software so that you can store and retrieve lots of data with a simple API. It&rsquo;s built for scale and optimized for durability, availability, and concurrency across the entire data set. Swift is ideal for storing unstructured data that can grow without bound.</p></blockquote><p>Swift allows to define a <code>container</code> (not in the <a href=https://www.opencontainers.org/>https://www.opencontainers.org/</a> sense but in a &lsquo;data storage&rsquo;).</p><h3 id=how-does-it-come-to-play-with-quay>How does it come to play with Quay?<a hidden class=anchor aria-hidden=true href=#how-does-it-come-to-play-with-quay>#</a></h3><p>Quay allows to define storage backend based on swift that can be used together with other backends to provide
geo-replication for availability.</p><h3 id=the-setup-process-of-swift-for-quay>The Setup process of Swift for Quay<a hidden class=anchor aria-hidden=true href=#the-setup-process-of-swift-for-quay>#</a></h3><p>At the beginning it was not easy to find out all the required configuration variables or settings to define, but what finally worked for the setup described in this article was:</p><h4 id=create-the-swift-container>Create the Swift container<a hidden class=anchor aria-hidden=true href=#create-the-swift-container>#</a></h4><p>First we do need to create a swift container in OpenStack that will hold the information from Quay:</p><ul><li><p>Create swift container for holding the storage:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>    <span style=color:#f92672>(</span>overcloud<span style=color:#f92672>)</span> <span style=color:#f92672>[</span>stack@osp-ait-director ~<span style=color:#f92672>]</span>$ openstack container create quay-enterprise
</span></span></code></pre></div><ul><li>Output:</li></ul></li></ul><table><thead><tr><th>account</th><th>container</th><th><code>x-trans-id</code></th></tr></thead><tbody><tr><td><code>AUTH_b3b8ce2eca3c4556ac01c12772b0d141</code></td><td>quay-enterprise</td><td><code>txd7d654f499db457da0fa0-005bf53d32</code></td></tr></tbody></table><h4 id=configuration-settings-defined-in-quay>Configuration settings defined in Quay<a hidden class=anchor aria-hidden=true href=#configuration-settings-defined-in-quay>#</a></h4><table><thead><tr><th>Setting</th><th>Value</th></tr></thead><tbody><tr><td><code>Storage Engine</code></td><td>OpenStack Storage (Swift)</td></tr><tr><td><code>Swift Auth Version</code></td><td>3</td></tr><tr><td><code>Swift Auth URL</code></td><td><code>\$YOURKEYSTONE PUBLIC ENDPOINT</code> (like <a href=http://aaa.bbb.ccc.ddd:5000>http://aaa.bbb.ccc.ddd:5000</a>)</td></tr><tr><td><code>Swift container name</code></td><td><code>\$YOURCONTAINER</code> (created with swift container create &rsquo;name&rsquo;)</td></tr><tr><td><code>Storage path</code></td><td><code>\$WHATEVER</code> (we did use <code>/quay</code>)</td></tr><tr><td><code>Username</code></td><td><code>\$OSP_USERNAME</code> (we did use <code>admin</code>)</td></tr><tr><td><code>key/password</code></td><td><code>\$OSP_PASSWORD</code>(we did use <code>redhat</code>)</td></tr><tr><td>OS OPTIONS drop-down</td><td>&lt;&mdash;&ndash; This is an important one if not it will fail</td></tr><tr><td><code>tenant_id</code></td><td><code>\$YOURTENANTID</code> (I did use &lsquo;admin&rsquo; id as obtained with <code>openstack project list|grep admin</code>)</td></tr></tbody></table><p>Once done, Quay should &lsquo;validate&rsquo; the upload and <code>swift list $YOURCONTAINER</code> should give something like:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span><span style=color:#f92672>(</span>overcloud<span style=color:#f92672>)</span> <span style=color:#f92672>[</span>stack@osp-director ~<span style=color:#f92672>]</span>$ swift list quay-enterprise
</span></span><span style=display:flex><span>quay/_verify
</span></span></code></pre></div><p>Showing that the verification file has been created succesfully.</p><h2 id=georeplication>Georeplication<a hidden class=anchor aria-hidden=true href=#georeplication>#</a></h2><p>Quay allows to define several backends that can be also configured as a foundation for GeoReplication.</p><p>Georeplication in quay, is used to:</p><ul><li>define a &lsquo;zone name&rsquo; for a storage backend</li><li>when booting Quay containers or apps, define which backend is &lsquo;closest&rsquo; (via environment variable <code>QUAY_DISTRIBUTED_STORAGE_PREFERENCE</code>)</li></ul><p>Quay will store and replicate on the different backends defined the information uploaded. The requirement is that the backend is an object storage, but you can also define &lsquo;mixed&rsquo; backends like for example GCE, AWS, Swift, Ceph RadosGW, etc. Quay will take care of the copy and once the backend &lsquo;closest&rsquo; to the quay instance is ready, it will serve from that one (or fallback to the one having the actual data).</p><p>For each one of the configured backends, a different number of settings will be requested to do the proper configuration.</p><h3 id=google-cloud-storage>Google Cloud Storage<a hidden class=anchor aria-hidden=true href=#google-cloud-storage>#</a></h3><p>For setting Google Cloud Storage, we did use the following values:</p><table><thead><tr><th>Setting</th><th>Value</th></tr></thead><tbody><tr><td>Location ID</td><td>$yourvalue</td></tr><tr><td>Storage Engine</td><td>Google Cloud Storage</td></tr><tr><td>Cloud Access Key</td><td>GOOGXXXXXXXX</td></tr><tr><td>Cloud Secret Key</td><td>pksXXXXXX</td></tr><tr><td>GCS Bucket</td><td>quay-enterprise</td></tr><tr><td>Storage Directory</td><td>/datastorage/registry</td></tr></tbody></table><h3 id=amazon-s3>Amazon S3<a hidden class=anchor aria-hidden=true href=#amazon-s3>#</a></h3><p>For setting Amazon S3 storage, we did use the following values:</p><table><thead><tr><th>Setting</th><th>Value</th></tr></thead><tbody><tr><td>Location ID</td><td>$yourvalue</td></tr><tr><td>Storage Engine</td><td>Amazon S3</td></tr><tr><td>S3 Bucket</td><td>quay-enterprise</td></tr><tr><td>Storage Directory</td><td>/quay/ait</td></tr><tr><td>AWS Access Key</td><td>AKIAXXXXXXXX</td></tr><tr><td>AWS Secret Key</td><td>/9bkfXXXXXXXXXX</td></tr></tbody></table><h3 id=validation-of-the-replication>Validation of the replication<a hidden class=anchor aria-hidden=true href=#validation-of-the-replication>#</a></h3><p>Once all the defined storage backends have been configured, there&rsquo;s a button in the interface that will validate access and create the &lsquo;marker&rsquo; files on each storage backend to verify the access permissions to them similar to what was shown on Swift configuration.</p><h2 id=quay-ssl-deployment>Quay SSL deployment<a hidden class=anchor aria-hidden=true href=#quay-ssl-deployment>#</a></h2><p>This procedure will guide you through the configuration of Quay with SSL certificates so the deployment is both secure and deployed in a highly available enterprise way.</p><h3 id=ssl-certificates>SSL Certificates<a hidden class=anchor aria-hidden=true href=#ssl-certificates>#</a></h3><p>Setting up certificates requires several steps involving:</p><ul><li>Creating a CA</li><li>Create a Certificate Signing Request with all the possible quay hostnames</li><li>Sign the certificates</li><li>Upload the certificates on Quay</li></ul><h4 id=create-ca>Create CA<a hidden class=anchor aria-hidden=true href=#create-ca>#</a></h4><p>Execution of <a href=other/generate-ca.sh>generate-ca.sh</a></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>./generate-ca.sh
</span></span></code></pre></div><p>With output:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>2018/11/29 15:01:13 <span style=color:#f92672>[</span>INFO<span style=color:#f92672>]</span> generating a new CA key and certificate from CSR
</span></span><span style=display:flex><span>2018/11/29 15:01:13 <span style=color:#f92672>[</span>INFO<span style=color:#f92672>]</span> generate received request
</span></span><span style=display:flex><span>2018/11/29 15:01:13 <span style=color:#f92672>[</span>INFO<span style=color:#f92672>]</span> received CSR
</span></span><span style=display:flex><span>2018/11/29 15:01:13 <span style=color:#f92672>[</span>INFO<span style=color:#f92672>]</span> generating key: rsa-2048
</span></span><span style=display:flex><span>2018/11/29 15:01:13 <span style=color:#f92672>[</span>INFO<span style=color:#f92672>]</span> encoded CSR
</span></span><span style=display:flex><span>2018/11/29 15:01:13 <span style=color:#f92672>[</span>INFO<span style=color:#f92672>]</span> signed certificate with serial number <span style=color:#ae81ff>432855461933024796113382064222588753737107796958</span>
</span></span></code></pre></div><p>And creates:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>-rw-rw-r--. <span style=color:#ae81ff>1</span> iranzo iranzo  <span style=color:#ae81ff>232</span> nov <span style=color:#ae81ff>29</span> 15:01 ca-config.json
</span></span><span style=display:flex><span>-rw-r--r--. <span style=color:#ae81ff>1</span> iranzo iranzo <span style=color:#ae81ff>1001</span> nov <span style=color:#ae81ff>29</span> 15:01 ca.csr
</span></span><span style=display:flex><span>-rw-rw-r--. <span style=color:#ae81ff>1</span> iranzo iranzo  <span style=color:#ae81ff>208</span> nov <span style=color:#ae81ff>29</span> 15:01 ca-csr.json
</span></span><span style=display:flex><span>-rw-------. <span style=color:#ae81ff>1</span> iranzo iranzo <span style=color:#ae81ff>1679</span> nov <span style=color:#ae81ff>29</span> 15:01 ca-key.pem
</span></span><span style=display:flex><span>-rw-rw-r--. <span style=color:#ae81ff>1</span> iranzo iranzo <span style=color:#ae81ff>1359</span> nov <span style=color:#ae81ff>29</span> 15:01 ca.pem
</span></span></code></pre></div><h4 id=create-quay-certs>Create Quay Certs<a hidden class=anchor aria-hidden=true href=#create-quay-certs>#</a></h4><p>We are going to use the same certificate for each replica, we need to know the hostname that will be used on the OCP routes beforehand in order to use it for the SAN property in the certificate.</p><p>Having each of the routes in the SAN makes it possible to use the same cert for each replica, so we can federate a single secret containing those certs rather than creating one SSL secret for each cluster.</p><p>Execution of <a href=other/generate-cert.sh>generate-cert.sh</a></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>./generate-cert.sh quay-enterprise
</span></span></code></pre></div><p>With output:</p><pre tabindex=0><code>2018/11/29 15:01:26 [INFO] generate received request
2018/11/29 15:01:26 [INFO] received CSR
2018/11/29 15:01:26 [INFO] generating key: rsa-2048
2018/11/29 15:01:26 [INFO] encoded CSR
2018/11/29 15:01:26 [INFO] signed certificate with serial number 570248288515480165542553575432827729263232937534
</code></pre><p>Now, we have all the required certificates for Quay generated.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>-rw-r--r--. <span style=color:#ae81ff>1</span> iranzo iranzo <span style=color:#ae81ff>1001</span> nov <span style=color:#ae81ff>29</span> 15:01 quay-enterprise.csr
</span></span><span style=display:flex><span>-rw-rw-r--. <span style=color:#ae81ff>1</span> iranzo iranzo  <span style=color:#ae81ff>208</span> nov <span style=color:#ae81ff>29</span> 15:01 quay-enterprise-csr.json
</span></span><span style=display:flex><span>-rw-------. <span style=color:#ae81ff>1</span> iranzo iranzo <span style=color:#ae81ff>1675</span> nov <span style=color:#ae81ff>29</span> 15:01 quay-enterprise-key.pem
</span></span><span style=display:flex><span>-rw-rw-r--. <span style=color:#ae81ff>1</span> iranzo iranzo <span style=color:#ae81ff>1809</span> nov <span style=color:#ae81ff>29</span> 15:01 quay-enterprise.pem
</span></span></code></pre></div><h4 id=load-quay-certificates>Load Quay certificates<a hidden class=anchor aria-hidden=true href=#load-quay-certificates>#</a></h4><p>Now using the web interface of quay, we can start uploading the certificates required for operation.</p><p><strong><em>Custom SSL Certificates</em></strong>
Here, load the <code>quay.pem</code></p><p><img alt="Certificate load" loading=lazy src=../../../../../blog/2019/01/08/quay-for-federation/2018-11-29-15-32-08.png></p><p><strong><em>Server Configuration</em></strong> *<strong>*TLS**</strong>
Certificate: load the <code>quay-enterprise.pem</code>
Key: load the <code>quay-enterprise-key.pem</code></p><p><img alt="Certificate configuration" loading=lazy src=../../../../../blog/2019/01/08/quay-for-federation/2018-11-29-15-33-02.png></p><p>At this point Quay will be using the certificates, but by default the service created only works on port 80.</p><p><strong>REMEMBER</strong>: We&rsquo;ll need to edit:</p><ul><li>the app</li><li>the route</li></ul><p>So that both work on port 443 instead of port 80 that is used by default.</p><p>We&rsquo;ll also need to load <code>ca.pem</code> and <code>quay-enterprise.pem</code> into our <code>/etc/pki/ca-trust/source/anchors</code> folder and then run:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>update-ca-trust extract
</span></span><span style=display:flex><span>service docker restart
</span></span><span style=display:flex><span><span style=color:#75715e># Now let&#39;s go login into the registry</span>
</span></span><span style=display:flex><span>docker login https://quay-enterprise-quay-enterprise.apps.leo-fed.e2e.bos.example.com
</span></span><span style=display:flex><span><span style=color:#75715e># Let&#39;s download a container:</span>
</span></span><span style=display:flex><span>docker pull quay.io/mavazque/pacman
</span></span><span style=display:flex><span><span style=color:#75715e># let&#39;s tag and upload to our registry</span>
</span></span><span style=display:flex><span>docker images|grep pacman
</span></span><span style=display:flex><span>quay.io/mavazque/pacman                                                          latest              6c5211874850        <span style=color:#ae81ff>29</span> hours ago        <span style=color:#ae81ff>689</span> MB
</span></span><span style=display:flex><span><span style=color:#75715e># Tag and upload</span>
</span></span><span style=display:flex><span><span style=color:#75715e># Find image</span>
</span></span><span style=display:flex><span>docker images|grep pacman
</span></span><span style=display:flex><span>quay.io/mavazque/pacman                                                          latest              6c5211874850        <span style=color:#ae81ff>29</span> hours ago        <span style=color:#ae81ff>689</span> MB
</span></span><span style=display:flex><span><span style=color:#75715e># Tag image</span>
</span></span><span style=display:flex><span>docker tag 6c5211874850 quay-enterprise-quay-enterprise.apps.leo-fed.e2e.bos.example.com/admin/pacman:latest
</span></span><span style=display:flex><span><span style=color:#75715e># Upload image</span>
</span></span><span style=display:flex><span>docker push quay-enterprise-quay-enterprise.apps.leo-fed.e2e.bos.example.com/admin/pacman
</span></span><span style=display:flex><span>The push refers to a repository <span style=color:#f92672>[</span>quay-enterprise-quay-enterprise.apps.leo-fed.e2e.bos.example.com/admin/pacman<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>fb2d3be23d30: Pushed
</span></span><span style=display:flex><span>c02d067bd364: Pushed
</span></span><span style=display:flex><span>3edd111b03f2: Pushed
</span></span><span style=display:flex><span>2221babd26ac: Pushed
</span></span><span style=display:flex><span>911d290ce59f: Pushed
</span></span><span style=display:flex><span>fae583f1d4e5: Pushed
</span></span><span style=display:flex><span>9d22e51f0c6d: Pushed
</span></span><span style=display:flex><span>58b8d417193d: Pushing <span style=color:#f92672>[===================================</span>&gt;               <span style=color:#f92672>]</span> 225.5 MB/320.1 MB
</span></span><span style=display:flex><span>704a8634956f: Pushing <span style=color:#f92672>[==================================================</span>&gt;<span style=color:#f92672>]</span>   <span style=color:#ae81ff>127</span> MB
</span></span><span style=display:flex><span>05f0b6bcfa5c: Pushed
</span></span><span style=display:flex><span>0972cc82b682: Pushing <span style=color:#f92672>[=============================</span>&gt;                     <span style=color:#f92672>]</span>  74.2 MB/126.8 MB
</span></span></code></pre></div><h3 id=openshift-certificate>OpenShift certificate<a hidden class=anchor aria-hidden=true href=#openshift-certificate>#</a></h3><p>Unless we also load the SSL certificate from Quay into OpenShift, we&rsquo;ll be facing issues like this:
<img alt="Failure when Certificate has not been imported" loading=lazy src=../../../../../blog/2019/01/08/quay-for-federation/2018-12-03-15-41-02.png></p><h2 id=wrap-up>Wrap up<a hidden class=anchor aria-hidden=true href=#wrap-up>#</a></h2><p>At this point, we&rsquo;ve Quay setup for using geo-replication for HA and faster speeds from each cluster, we do have an underlying postgres setup using replication across sites and the URL&rsquo;s have been secured for being used by our servers downloading images from there to deploy our applications.</p><p>Hope that you&rsquo;ve enjoyed it!</p></div><footer class=post-footer><ul class=post-tags><li><a href=https://iranzo.io/tags/quay/>Quay</a></li><li><a href=https://iranzo.io/tags/kubernetes/>Kubernetes</a></li><li><a href=https://iranzo.io/tags/container/>Container</a></li><li><a href=https://iranzo.io/tags/federation/>Federation</a></li><li><a href=https://iranzo.io/tags/openshift/>OpenShift</a></li><li><a href=https://iranzo.io/tags/foss/>FOSS</a></li></ul><nav class=paginav><a class=prev href=https://iranzo.io/blog/2019/01/08/postgres-repl-ssl-replication/><span class=title>¬´ Prev</span><br><span>Postgres repl SSL replication</span>
</a><a class=next href=https://iranzo.io/blog/2018/12/30/android-tv-and-netflixs-tvq-pm-100-5.2.5-error/><span class=title>Next ¬ª</span><br><span>Android TV and Netflix's tvq-pm-100 (5.2.5) error</span></a></nav><ul class=share-buttons><li><a target=_blank rel="noopener noreferrer" aria-label="share Quay for Federation on x" href="https://x.com/intent/tweet/?text=Quay%20for%20Federation&amp;url=https%3a%2f%2firanzo.io%2fblog%2f2019%2f01%2f08%2fquay-for-federation%2f&amp;hashtags=Quay%2cKubernetes%2ccontainer%2cfederation%2cOpenShift%2cFOSS"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentColor"><path d="M512 62.554V449.446C512 483.97 483.97 512 449.446 512H62.554C28.03 512 0 483.97.0 449.446V62.554C0 28.03 28.029.0 62.554.0H449.446C483.971.0 512 28.03 512 62.554zM269.951 190.75 182.567 75.216H56L207.216 272.95 63.9 436.783h61.366L235.9 310.383l96.667 126.4H456L298.367 228.367l134-153.151H371.033zM127.633 110h36.468l219.38 290.065H349.5z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Quay for Federation on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2firanzo.io%2fblog%2f2019%2f01%2f08%2fquay-for-federation%2f&amp;title=Quay%20for%20Federation&amp;summary=Quay%20for%20Federation&amp;source=https%3a%2f%2firanzo.io%2fblog%2f2019%2f01%2f08%2fquay-for-federation%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentColor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Quay for Federation on reddit" href="https://reddit.com/submit?url=https%3a%2f%2firanzo.io%2fblog%2f2019%2f01%2f08%2fquay-for-federation%2f&title=Quay%20for%20Federation"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentColor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Quay for Federation on facebook" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2firanzo.io%2fblog%2f2019%2f01%2f08%2fquay-for-federation%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentColor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Quay for Federation on whatsapp" href="https://api.whatsapp.com/send?text=Quay%20for%20Federation%20-%20https%3a%2f%2firanzo.io%2fblog%2f2019%2f01%2f08%2fquay-for-federation%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentColor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Quay for Federation on telegram" href="https://telegram.me/share/url?text=Quay%20for%20Federation&amp;url=https%3a%2f%2firanzo.io%2fblog%2f2019%2f01%2f08%2fquay-for-federation%2f"><svg viewBox="2 2 28 28" height="30" width="30" fill="currentColor"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Quay for Federation on ycombinator" href="https://news.ycombinator.com/submitlink?t=Quay%20for%20Federation&u=https%3a%2f%2firanzo.io%2fblog%2f2019%2f01%2f08%2fquay-for-federation%2f"><svg width="30" height="30" viewBox="0 0 512 512" fill="currentColor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554V449.446C512 483.97 483.97 512 449.446 512H62.554C28.03 512 0 483.97.0 449.446V62.554C0 28.03 28.029.0 62.554.0H449.446zM183.8767 87.9921h-62.034L230.6673 292.4508V424.0079h50.6655V292.4508L390.1575 87.9921H328.1233L256 238.2489z"/></svg></a></li></ul></footer></article></main><footer class=footer><span>&copy; 2025 <a href=https://iranzo.io/>Pablo Iranzo G√≥mez blog</a></span> ¬∑
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
<a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentColor"><path d="M12 6H0l6-6z"/></svg></a><center><small>This blog is a participant in the Amazon Associate Program, an affiliate advertising program designed to provide a means for sites to earn advertising fees by advertising and linking to Amazon.</small></center><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>