<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Language detection in @redken_bot | Pablo Iranzo Gómez blog</title>
<meta name=keywords content="English,language,python,foss,telegram"><meta name=description content="Introduction
Before the move to Python3, redken had per-group language configuration by using i18n, with the upgrade/rewrite of Python3 code there were some issues and I had to remove the support, defaulting everything to English (most of the outputs where already in English so not a great loss).
On another side, having to manually configure each channel could be problematic as most users just add the bot to their groups but don&rsquo;t care about other settings that might be useful like welcome message, inactivity for kicking out inactive users, etc."><meta name=author content="Pablo Iranzo Gómez"><link rel=canonical href=https://iranzo.io/blog/2020/03/25/language-detection-in-@redken_bot/><meta name=google-site-verification content="Bk4Z5ucHLyPXqlZlj5LzANpYBBSvxqBW4E8i-Kwf-bQ"><meta name=yandex-verification content="993ede96cdfbee95"><link crossorigin=anonymous href=../../../../../assets/css/stylesheet.css rel="preload stylesheet" as=style><link rel=icon href=https://iranzo.io/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://iranzo.io/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://iranzo.io/favicon-32x32.png><link rel=apple-touch-icon href=https://iranzo.io/apple-touch-icon.png><link rel=mask-icon href=https://iranzo.io/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://iranzo.io/blog/2020/03/25/language-detection-in-@redken_bot/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script async src="https://www.googletagmanager.com/gtag/js?id=G-ZL9P943TP1"></script><script>var dnt,doNotTrack=!1;if(!1&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-ZL9P943TP1")}</script><meta property="og:url" content="https://iranzo.io/blog/2020/03/25/language-detection-in-@redken_bot/"><meta property="og:site_name" content="Pablo Iranzo Gómez blog"><meta property="og:title" content="Language detection in @redken_bot"><meta property="og:description" content="Introduction Before the move to Python3, redken had per-group language configuration by using i18n, with the upgrade/rewrite of Python3 code there were some issues and I had to remove the support, defaulting everything to English (most of the outputs where already in English so not a great loss).
On another side, having to manually configure each channel could be problematic as most users just add the bot to their groups but don’t care about other settings that might be useful like welcome message, inactivity for kicking out inactive users, etc."><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="article:section" content="blog"><meta property="article:published_time" content="2020-03-25T20:00:24+01:00"><meta property="article:modified_time" content="2023-08-25T09:46:05+00:00"><meta property="article:tag" content="English"><meta property="article:tag" content="Language"><meta property="article:tag" content="Python"><meta property="article:tag" content="FOSS"><meta property="article:tag" content="Telegram"><meta property="og:image" content="https://iranzo.io/mugshot.png"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://iranzo.io/mugshot.png"><meta name=twitter:title content="Language detection in @redken_bot"><meta name=twitter:description content="Introduction
Before the move to Python3, redken had per-group language configuration by using i18n, with the upgrade/rewrite of Python3 code there were some issues and I had to remove the support, defaulting everything to English (most of the outputs where already in English so not a great loss).
On another side, having to manually configure each channel could be problematic as most users just add the bot to their groups but don&rsquo;t care about other settings that might be useful like welcome message, inactivity for kicking out inactive users, etc."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Blogs","item":"https://iranzo.io/blog/"},{"@type":"ListItem","position":2,"name":"Language detection in @redken_bot","item":"https://iranzo.io/blog/2020/03/25/language-detection-in-@redken_bot/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Language detection in @redken_bot","name":"Language detection in @redken_bot","description":"Introduction Before the move to Python3, redken had per-group language configuration by using i18n, with the upgrade/rewrite of Python3 code there were some issues and I had to remove the support, defaulting everything to English (most of the outputs where already in English so not a great loss).\nOn another side, having to manually configure each channel could be problematic as most users just add the bot to their groups but don\u0026rsquo;t care about other settings that might be useful like welcome message, inactivity for kicking out inactive users, etc.\n","keywords":["English","language","python","foss","telegram"],"articleBody":"Introduction Before the move to Python3, redken had per-group language configuration by using i18n, with the upgrade/rewrite of Python3 code there were some issues and I had to remove the support, defaulting everything to English (most of the outputs where already in English so not a great loss).\nOn another side, having to manually configure each channel could be problematic as most users just add the bot to their groups but don’t care about other settings that might be useful like welcome message, inactivity for kicking out inactive users, etc.\nTelegram’s approach Initial version was added by expanding regular function that processes the Telegram-Server message to also take consideration of the user-indicated language and use that to store a new field in the database with the language, but that came with problems:\nNot all users had the language configured, so most times it was \"\" When talking on a group, the id was the group one, so if a user had language set to something and then other user wrote on the chat, it was just storing the ’last used’ language interface. Python to the rescue As the bot is written in Python, I did a quick search for language detection and found langdetect which is a port of a Java library to Python that can find certain words, etc in the texts and give some hint about the language.\nSo, instead of using the almost-always-empty user defined language for the interface, it started using langdetect for getting the message language based on the text.\nThis of course, solved on of the problems (no-configured language by users), still left the one on the ’last-language-used’ and introduced a new one:\nlangdetect does a guess based on common words, accents, characters, etc but it’s just that: a guess. The approach then was to use it to calculate averages based on prior count and new value.\nIn this way, the language moved from being just a string to become a dictionary, storing count and lang: % values, for example:\n{ \"count\": 272, \"en\": 2.2, \"es\": 75.36, \"it\": 3.74, \"ca\": 3.48, \"fi\": 2.3, \"fr\": 1.64, \"pt\": 1.73, \"et\": 0.97, \"ro\": 0.68, \"de\": 1.11, \"hr\": 0.68, \"sw\": 1.09, \"tl\": 0.96, \"lt\": 0.68, \"sk\": 1.22, \"so\": 1.16, \"da\": 1.18, \"sv\": 0.67, \"tr\": 0.58, \"hu\": 0.46, \"vi\": 0.43, \"sl\": 0.41, \"no\": 0.37, } This is my status, from 272 messages, the library has detected Spanish 75% of times, plus some other messages. As you might infer, there are lot of languages listed there that I never used, so it’s really important to keep this values refreshing with higher message counts.\nFor groups, this becomes even more interesting, as the message languages get updates for each user that speaks in the channel, giving ‘faster’, good results on the language being used:\nEnglish group:\n{ \"count\": 56, \"tr\": 1.79, \"en\": 80.36, \"da\": 1.79, \"af\": 1.79, \"sl\": 1.79, \"ca\": 1.79, \"es\": 1.79, \"fi\": 1.79, \"nl\": 1.79, \"it\": 1.79, \"sq\": 1.79, \"so\": 1.79, } Spanish group:\n{ \"count\": 140, \"es\": 61.42, \"fi\": 0.68, \"ca\": 1.46, \"it\": 5.72, \"tr\": 0.68, \"sw\": 1.46, \"pt\": 5.74, \"so\": 2.12, \"en\": 8.58, \"pl\": 0.68, \"sv\": 1.48, \"hr\": 0.68, \"sk\": 0.67, \"cy\": 3.58, \"tl\": 1.43, \"sl\": 0.68, \"no\": 1.44, \"de\": 0.69, \"da\": 0.7, } Of course, before integrating this code into @redken_bot, I did a small program to validate it:\nfrom langdetect import detect import json # Add some sentences to an array to test text = [] text.append( \"It could be that your new system is not getting as much throughput to your hard disks as it should be\" ) text.append( \"Il mio machina e piu veloce\", ) text.append( \"Je suis tres desolè\", ) text.append( \"El caballo blando de santiago era blanco\", ) text.append( \"My tailor is rich\", ) text.append( \"En un lugar de la Mancha de cuyo nombre no quiero acordarme\", ) text.append(\"Good morning, hello, good morning hello\") text.append( \"No es cierto angel de amor que en esta apartada orilla no luce el sol sino brilla\" ) text.append(\"Tears will be falling under the heavy rain\") text.append(\"Que'l heure est il?\") text.append(\"Caracol, col col, saca los cuernos al sol\") # Create dictionary empty for this to work language = {} language[\"count\"] = 0 # Process each line in text for line in text: # As we'll be iterating later over a dictionary, prepare updates in a different one updates = {} # Detec language in the line received language_code = detect(line) print(\" \") print(\"Processing Line with detected language \", language_code, \"|\", line) updates[\"count\"] = language[\"count\"] + 1 # Check if we need to add key to language if language_code not in language: print(\"New key in language, preparing updates\") # New language % is 100 over the total number of updates received before, so 100% for the first message in a group updates[language_code] = 100 / updates[\"count\"] # Process each key we already had in language for key in language: # If the new language matches the one detected, give it a 100%, else, 0% , so that we work on % for each language if key == language_code: value = 100 else: value = 0 # As we store message count in the same dictionary, we just skip it if key != \"count\": print(\"Processing key %s in language for average updates\" % key) updates[key] = float( \"{0:.2f}\".format( language[key] + ((value - language[key]) / updates[\"count\"]) ) ) print(\"New average: %s for language %s\" % (updates[key], key)) print(\"Updates: %s\" % updates) language.update(updates) print(language) # Validate that final sum of % is close to 100% (consider rounding problems) accum = 0 for key in language: if key != \"count\": accum = accum + language[key] print(float(\"{0:.2f}\".format(accum))) # Dump the json of the final detected languages print(json.dumps(language)) Which, when executed, gives as final results:\nProcessing Line with detected language fr | Que'l heure est il? Processing key en in language for average updates New average: 40.0 for language en Processing key it in language for average updates New average: 10.0 for language it Processing key fr in language for average updates New average: 20.0 for language fr Processing key es in language for average updates New average: 30.0 for language es Updates: {'count': 10, 'en': 40.0, 'it': 10.0, 'fr': 20.0, 'es': 30.0} {'count': 10, 'en': 40.0, 'it': 10.0, 'fr': 20.0, 'es': 30.0} 100.0 Processing Line with detected language es | Caracol, col col, saca los cuernos al sol Processing key en in language for average updates New average: 36.36 for language en Processing key it in language for average updates New average: 9.09 for language it Processing key fr in language for average updates New average: 18.18 for language fr Processing key es in language for average updates New average: 36.36 for language es Updates: {'count': 11, 'en': 36.36, 'it': 9.09, 'fr': 18.18, 'es': 36.36} {'count': 11, 'en': 36.36, 'it': 9.09, 'fr': 18.18, 'es': 36.36} 99.99 {\"count\": 11, \"en\": 36.36, \"it\": 9.09, \"fr\": 18.18, \"es\": 36.36} Conclusion Above code was adapted to redken, so when a new user message was received, both the group when the user wrote a sentence and the user itself, got a new dictionary of languages detected.\nThis approach, of using the ‘moving %’, just requires prior value for language and items count to calculate the new one reducing both the information needed to be stored to a minimum.\nIn the future, when I’m adding back strings for languages, I can automate how redken reacts per channel (unless overridden) so that it provides messages in a more natural way for users.\nEnjoy! (and if you do, you can Buy Me a Coffee ) ","wordCount":"1255","inLanguage":"en","image":"https://iranzo.io/mugshot.png","datePublished":"2020-03-25T20:00:24+01:00","dateModified":"2023-08-25T09:46:05.101Z","author":{"@type":"Person","name":"Pablo Iranzo Gómez"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://iranzo.io/blog/2020/03/25/language-detection-in-@redken_bot/"},"publisher":{"@type":"Organization","name":"Pablo Iranzo Gómez blog","logo":{"@type":"ImageObject","url":"https://iranzo.io/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://iranzo.io/ accesskey=h title="Home (Alt + H)"><img src=https://iranzo.io/apple-icon-152x152.png alt aria-label=logo height=35>Home</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)" aria-label="Toggle theme"><svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button><ul class=lang-switch><li>|</li><li><a href=https://iranzo.io/es/ title=Spanish aria-label=Spanish>Es</a></li></ul></div></div><ul id=menu><li><a href=https://iranzo.io/ title=🏠Home><span>🏠Home</span></a></li><li><a href=https://iranzo.io/about/ title=🗒️About><span>🗒️About</span></a></li><li><a href=https://iranzo.io/redken_bot/ title=🐘redken_bot><span>🐘redken_bot</span></a></li><li><a href=https://iranzo.io/projects/ title=📐Projects><span>📐Projects</span></a></li><li><a href=https://iranzo.io/archives/ title="🗄️ Archives"><span>🗄️ Archives</span></a></li><li><a href=https://iranzo.io/categories/ title=🗺️Categories><span>🗺️Categories</span></a></li><li><a href=https://iranzo.io/tags/ title=🏷️Tags><span>🏷️Tags</span></a></li><li><a href=https://iranzo.io/search title="🔎Search (Alt + /)" accesskey=/><span>🔎Search</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://iranzo.io/>Home</a>&nbsp;»&nbsp;<a href=https://iranzo.io/blog/>Blogs</a></div><h1 class="post-title entry-hint-parent">Language detection in @redken_bot</h1><div class=post-meta><span title='2020-03-25 20:00:24 +0100 +0100'>March 25, 2020</span>&nbsp;·&nbsp;6 min&nbsp;·&nbsp;Pablo Iranzo Gómez</div></header><div class=toc><details open><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><ul><li><a href=#introduction aria-label=Introduction>Introduction</a></li><li><a href=#telegrams-approach aria-label="Telegram&rsquo;s approach">Telegram&rsquo;s approach</a></li><li><a href=#python-to-the-rescue aria-label="Python to the rescue">Python to the rescue</a></li><li><a href=#conclusion aria-label=Conclusion>Conclusion</a></li></ul></div></details></div><div class=post-content><h2 id=introduction>Introduction<a hidden class=anchor aria-hidden=true href=#introduction>#</a></h2><p>Before the move to Python3, <a href=https://t.me/redken_bot>redken</a> had per-group language configuration by using i18n, with the upgrade/rewrite of Python3 code there were some issues and I had to remove the support, defaulting everything to English (most of the outputs where already in English so not a great loss).</p><p>On another side, having to manually configure each channel could be problematic as most users just add the bot to their groups but don&rsquo;t care about other settings that might be useful like <code>welcome</code> message, <code>inactivity</code> for kicking out inactive users, etc.</p><h2 id=telegrams-approach>Telegram&rsquo;s approach<a hidden class=anchor aria-hidden=true href=#telegrams-approach>#</a></h2><p>Initial version was added by expanding regular function that processes the Telegram-Server message to also take consideration of the user-indicated language and use that to store a new field in the database with the language, but that came with problems:</p><ul><li>Not all users had the language configured, so most times it was ""</li><li>When talking on a group, the <code>id</code> was the group one, so if a user had language set to something and then other user wrote on the chat, it was just storing the &rsquo;last used&rsquo; language interface.</li></ul><h2 id=python-to-the-rescue>Python to the rescue<a hidden class=anchor aria-hidden=true href=#python-to-the-rescue>#</a></h2><p>As the bot is written in Python, I did a quick search for language detection and found <a href=https://github.com/Mimino666/langdetect><code>langdetect</code></a> which is a port of a Java library to Python that can find certain words, etc in the texts and give some hint about the language.</p><p>So, instead of using the almost-always-empty user defined language for the interface, it started using <code>langdetect</code> for getting the message language based on the text.</p><p>This of course, solved on of the problems (no-configured language by users), still left the one on the &rsquo;last-language-used&rsquo; and introduced a new one:</p><ul><li><code>langdetect</code> does a guess based on common words, accents, characters, etc but it&rsquo;s just that: a guess.</li></ul><p>The approach then was to use it to calculate averages based on prior count and new value.</p><p>In this way, the language moved from being just a string to become a dictionary, storing <code>count</code> and <code>lang: %</code> values, for example:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-py data-lang=py><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;count&#34;</span>: <span style=color:#ae81ff>272</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;en&#34;</span>: <span style=color:#ae81ff>2.2</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;es&#34;</span>: <span style=color:#ae81ff>75.36</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;it&#34;</span>: <span style=color:#ae81ff>3.74</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;ca&#34;</span>: <span style=color:#ae81ff>3.48</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;fi&#34;</span>: <span style=color:#ae81ff>2.3</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;fr&#34;</span>: <span style=color:#ae81ff>1.64</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;pt&#34;</span>: <span style=color:#ae81ff>1.73</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;et&#34;</span>: <span style=color:#ae81ff>0.97</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;ro&#34;</span>: <span style=color:#ae81ff>0.68</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;de&#34;</span>: <span style=color:#ae81ff>1.11</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;hr&#34;</span>: <span style=color:#ae81ff>0.68</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;sw&#34;</span>: <span style=color:#ae81ff>1.09</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;tl&#34;</span>: <span style=color:#ae81ff>0.96</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;lt&#34;</span>: <span style=color:#ae81ff>0.68</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;sk&#34;</span>: <span style=color:#ae81ff>1.22</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;so&#34;</span>: <span style=color:#ae81ff>1.16</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;da&#34;</span>: <span style=color:#ae81ff>1.18</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;sv&#34;</span>: <span style=color:#ae81ff>0.67</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;tr&#34;</span>: <span style=color:#ae81ff>0.58</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;hu&#34;</span>: <span style=color:#ae81ff>0.46</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;vi&#34;</span>: <span style=color:#ae81ff>0.43</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;sl&#34;</span>: <span style=color:#ae81ff>0.41</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;no&#34;</span>: <span style=color:#ae81ff>0.37</span>,
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>This is my status, from 272 messages, the library has detected Spanish 75% of times, plus some other messages. As you might infer, there are lot of languages listed there that I never used, so it&rsquo;s really important to keep this values refreshing with higher message counts.</p><p>For groups, this becomes even more interesting, as the message languages get updates for each user that speaks in the channel, giving &lsquo;faster&rsquo;, good results on the language being used:</p><p>English group:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-py data-lang=py><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;count&#34;</span>: <span style=color:#ae81ff>56</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;tr&#34;</span>: <span style=color:#ae81ff>1.79</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;en&#34;</span>: <span style=color:#ae81ff>80.36</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;da&#34;</span>: <span style=color:#ae81ff>1.79</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;af&#34;</span>: <span style=color:#ae81ff>1.79</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;sl&#34;</span>: <span style=color:#ae81ff>1.79</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;ca&#34;</span>: <span style=color:#ae81ff>1.79</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;es&#34;</span>: <span style=color:#ae81ff>1.79</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;fi&#34;</span>: <span style=color:#ae81ff>1.79</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;nl&#34;</span>: <span style=color:#ae81ff>1.79</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;it&#34;</span>: <span style=color:#ae81ff>1.79</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;sq&#34;</span>: <span style=color:#ae81ff>1.79</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;so&#34;</span>: <span style=color:#ae81ff>1.79</span>,
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>Spanish group:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-py data-lang=py><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;count&#34;</span>: <span style=color:#ae81ff>140</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;es&#34;</span>: <span style=color:#ae81ff>61.42</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;fi&#34;</span>: <span style=color:#ae81ff>0.68</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;ca&#34;</span>: <span style=color:#ae81ff>1.46</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;it&#34;</span>: <span style=color:#ae81ff>5.72</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;tr&#34;</span>: <span style=color:#ae81ff>0.68</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;sw&#34;</span>: <span style=color:#ae81ff>1.46</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;pt&#34;</span>: <span style=color:#ae81ff>5.74</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;so&#34;</span>: <span style=color:#ae81ff>2.12</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;en&#34;</span>: <span style=color:#ae81ff>8.58</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;pl&#34;</span>: <span style=color:#ae81ff>0.68</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;sv&#34;</span>: <span style=color:#ae81ff>1.48</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;hr&#34;</span>: <span style=color:#ae81ff>0.68</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;sk&#34;</span>: <span style=color:#ae81ff>0.67</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;cy&#34;</span>: <span style=color:#ae81ff>3.58</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;tl&#34;</span>: <span style=color:#ae81ff>1.43</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;sl&#34;</span>: <span style=color:#ae81ff>0.68</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;no&#34;</span>: <span style=color:#ae81ff>1.44</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;de&#34;</span>: <span style=color:#ae81ff>0.69</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;da&#34;</span>: <span style=color:#ae81ff>0.7</span>,
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>Of course, before integrating this code into <a href=https://t.me/redken_bot>@redken_bot</a>, I did a small program to validate it:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-py data-lang=py><span style=display:flex><span><span style=color:#f92672>from</span> langdetect <span style=color:#f92672>import</span> detect
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> json
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Add some sentences to an array to test</span>
</span></span><span style=display:flex><span>text <span style=color:#f92672>=</span> []
</span></span><span style=display:flex><span>text<span style=color:#f92672>.</span>append(
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;It could be that your new system is not getting as much throughput to your hard disks as it should be&#34;</span>
</span></span><span style=display:flex><span>)
</span></span><span style=display:flex><span>text<span style=color:#f92672>.</span>append(
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;Il mio machina e piu veloce&#34;</span>,
</span></span><span style=display:flex><span>)
</span></span><span style=display:flex><span>text<span style=color:#f92672>.</span>append(
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;Je suis tres desolè&#34;</span>,
</span></span><span style=display:flex><span>)
</span></span><span style=display:flex><span>text<span style=color:#f92672>.</span>append(
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;El caballo blando de santiago era blanco&#34;</span>,
</span></span><span style=display:flex><span>)
</span></span><span style=display:flex><span>text<span style=color:#f92672>.</span>append(
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;My tailor is rich&#34;</span>,
</span></span><span style=display:flex><span>)
</span></span><span style=display:flex><span>text<span style=color:#f92672>.</span>append(
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;En un lugar de la Mancha de cuyo nombre no quiero acordarme&#34;</span>,
</span></span><span style=display:flex><span>)
</span></span><span style=display:flex><span>text<span style=color:#f92672>.</span>append(<span style=color:#e6db74>&#34;Good morning, hello, good morning hello&#34;</span>)
</span></span><span style=display:flex><span>text<span style=color:#f92672>.</span>append(
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;No es cierto angel de amor que en esta apartada orilla no luce el sol sino brilla&#34;</span>
</span></span><span style=display:flex><span>)
</span></span><span style=display:flex><span>text<span style=color:#f92672>.</span>append(<span style=color:#e6db74>&#34;Tears will be falling under the heavy rain&#34;</span>)
</span></span><span style=display:flex><span>text<span style=color:#f92672>.</span>append(<span style=color:#e6db74>&#34;Que&#39;l heure est il?&#34;</span>)
</span></span><span style=display:flex><span>text<span style=color:#f92672>.</span>append(<span style=color:#e6db74>&#34;Caracol, col col, saca los cuernos al sol&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Create dictionary empty for this to work</span>
</span></span><span style=display:flex><span>language <span style=color:#f92672>=</span> {}
</span></span><span style=display:flex><span>language[<span style=color:#e6db74>&#34;count&#34;</span>] <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Process each line in text</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> line <span style=color:#f92672>in</span> text:
</span></span><span style=display:flex><span>    <span style=color:#75715e># As we&#39;ll be iterating later over a dictionary, prepare updates in a different one</span>
</span></span><span style=display:flex><span>    updates <span style=color:#f92672>=</span> {}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e># Detec language in the line received</span>
</span></span><span style=display:flex><span>    language_code <span style=color:#f92672>=</span> detect(line)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    print(<span style=color:#e6db74>&#34; &#34;</span>)
</span></span><span style=display:flex><span>    print(<span style=color:#e6db74>&#34;Processing Line with detected language &#34;</span>, language_code, <span style=color:#e6db74>&#34;|&#34;</span>, line)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    updates[<span style=color:#e6db74>&#34;count&#34;</span>] <span style=color:#f92672>=</span> language[<span style=color:#e6db74>&#34;count&#34;</span>] <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e># Check if we need to add key to language</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> language_code <span style=color:#f92672>not</span> <span style=color:#f92672>in</span> language:
</span></span><span style=display:flex><span>        print(<span style=color:#e6db74>&#34;New key in language, preparing updates&#34;</span>)
</span></span><span style=display:flex><span>        <span style=color:#75715e># New language % is 100 over the total number of updates received before, so 100% for the first message in a group</span>
</span></span><span style=display:flex><span>        updates[language_code] <span style=color:#f92672>=</span> <span style=color:#ae81ff>100</span> <span style=color:#f92672>/</span> updates[<span style=color:#e6db74>&#34;count&#34;</span>]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e># Process each key we already had in language</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> key <span style=color:#f92672>in</span> language:
</span></span><span style=display:flex><span>        <span style=color:#75715e># If the new language matches the one detected, give it a 100%, else, 0% , so that we work on % for each language</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> key <span style=color:#f92672>==</span> language_code:
</span></span><span style=display:flex><span>            value <span style=color:#f92672>=</span> <span style=color:#ae81ff>100</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>else</span>:
</span></span><span style=display:flex><span>            value <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e># As we store message count in the same dictionary, we just skip it</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> key <span style=color:#f92672>!=</span> <span style=color:#e6db74>&#34;count&#34;</span>:
</span></span><span style=display:flex><span>            print(<span style=color:#e6db74>&#34;Processing key </span><span style=color:#e6db74>%s</span><span style=color:#e6db74> in language for average updates&#34;</span> <span style=color:#f92672>%</span> key)
</span></span><span style=display:flex><span>            updates[key] <span style=color:#f92672>=</span> float(
</span></span><span style=display:flex><span>                <span style=color:#e6db74>&#34;</span><span style=color:#e6db74>{0:.2f}</span><span style=color:#e6db74>&#34;</span><span style=color:#f92672>.</span>format(
</span></span><span style=display:flex><span>                    language[key] <span style=color:#f92672>+</span> ((value <span style=color:#f92672>-</span> language[key]) <span style=color:#f92672>/</span> updates[<span style=color:#e6db74>&#34;count&#34;</span>])
</span></span><span style=display:flex><span>                )
</span></span><span style=display:flex><span>            )
</span></span><span style=display:flex><span>            print(<span style=color:#e6db74>&#34;New average: </span><span style=color:#e6db74>%s</span><span style=color:#e6db74> for language </span><span style=color:#e6db74>%s</span><span style=color:#e6db74>&#34;</span> <span style=color:#f92672>%</span> (updates[key], key))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    print(<span style=color:#e6db74>&#34;Updates: </span><span style=color:#e6db74>%s</span><span style=color:#e6db74>&#34;</span> <span style=color:#f92672>%</span> updates)
</span></span><span style=display:flex><span>    language<span style=color:#f92672>.</span>update(updates)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    print(language)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e># Validate that final sum of % is close to 100% (consider rounding problems)</span>
</span></span><span style=display:flex><span>    accum <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> key <span style=color:#f92672>in</span> language:
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> key <span style=color:#f92672>!=</span> <span style=color:#e6db74>&#34;count&#34;</span>:
</span></span><span style=display:flex><span>            accum <span style=color:#f92672>=</span> accum <span style=color:#f92672>+</span> language[key]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    print(float(<span style=color:#e6db74>&#34;</span><span style=color:#e6db74>{0:.2f}</span><span style=color:#e6db74>&#34;</span><span style=color:#f92672>.</span>format(accum)))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Dump the json of the final detected languages</span>
</span></span><span style=display:flex><span>print(json<span style=color:#f92672>.</span>dumps(language))
</span></span></code></pre></div><p>Which, when executed, gives as final results:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>Processing Line with detected language  fr | Que<span style=color:#e6db74>&#39;l heure est il?
</span></span></span><span style=display:flex><span><span style=color:#e6db74>Processing key en in language for average updates
</span></span></span><span style=display:flex><span><span style=color:#e6db74>New average: 40.0 for language en
</span></span></span><span style=display:flex><span><span style=color:#e6db74>Processing key it in language for average updates
</span></span></span><span style=display:flex><span><span style=color:#e6db74>New average: 10.0 for language it
</span></span></span><span style=display:flex><span><span style=color:#e6db74>Processing key fr in language for average updates
</span></span></span><span style=display:flex><span><span style=color:#e6db74>New average: 20.0 for language fr
</span></span></span><span style=display:flex><span><span style=color:#e6db74>Processing key es in language for average updates
</span></span></span><span style=display:flex><span><span style=color:#e6db74>New average: 30.0 for language es
</span></span></span><span style=display:flex><span><span style=color:#e6db74>Updates: {&#39;</span>count<span style=color:#e6db74>&#39;: 10, &#39;</span>en<span style=color:#e6db74>&#39;: 40.0, &#39;</span>it<span style=color:#e6db74>&#39;: 10.0, &#39;</span>fr<span style=color:#e6db74>&#39;: 20.0, &#39;</span>es<span style=color:#e6db74>&#39;: 30.0}
</span></span></span><span style=display:flex><span><span style=color:#e6db74>{&#39;</span>count<span style=color:#e6db74>&#39;: 10, &#39;</span>en<span style=color:#e6db74>&#39;: 40.0, &#39;</span>it<span style=color:#e6db74>&#39;: 10.0, &#39;</span>fr<span style=color:#e6db74>&#39;: 20.0, &#39;</span>es<span style=color:#e6db74>&#39;: 30.0}
</span></span></span><span style=display:flex><span><span style=color:#e6db74>100.0
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>Processing Line with detected language  es | Caracol, col col, saca los cuernos al sol
</span></span></span><span style=display:flex><span><span style=color:#e6db74>Processing key en in language for average updates
</span></span></span><span style=display:flex><span><span style=color:#e6db74>New average: 36.36 for language en
</span></span></span><span style=display:flex><span><span style=color:#e6db74>Processing key it in language for average updates
</span></span></span><span style=display:flex><span><span style=color:#e6db74>New average: 9.09 for language it
</span></span></span><span style=display:flex><span><span style=color:#e6db74>Processing key fr in language for average updates
</span></span></span><span style=display:flex><span><span style=color:#e6db74>New average: 18.18 for language fr
</span></span></span><span style=display:flex><span><span style=color:#e6db74>Processing key es in language for average updates
</span></span></span><span style=display:flex><span><span style=color:#e6db74>New average: 36.36 for language es
</span></span></span><span style=display:flex><span><span style=color:#e6db74>Updates: {&#39;</span>count<span style=color:#e6db74>&#39;: 11, &#39;</span>en<span style=color:#e6db74>&#39;: 36.36, &#39;</span>it<span style=color:#e6db74>&#39;: 9.09, &#39;</span>fr<span style=color:#e6db74>&#39;: 18.18, &#39;</span>es<span style=color:#e6db74>&#39;: 36.36}
</span></span></span><span style=display:flex><span><span style=color:#e6db74>{&#39;</span>count<span style=color:#e6db74>&#39;: 11, &#39;</span>en<span style=color:#e6db74>&#39;: 36.36, &#39;</span>it<span style=color:#e6db74>&#39;: 9.09, &#39;</span>fr<span style=color:#e6db74>&#39;: 18.18, &#39;</span>es<span style=color:#960050;background-color:#1e0010>&#39;</span>: 36.36<span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>99.99
</span></span><span style=display:flex><span><span style=color:#f92672>{</span><span style=color:#e6db74>&#34;count&#34;</span>: 11, <span style=color:#e6db74>&#34;en&#34;</span>: 36.36, <span style=color:#e6db74>&#34;it&#34;</span>: 9.09, <span style=color:#e6db74>&#34;fr&#34;</span>: 18.18, <span style=color:#e6db74>&#34;es&#34;</span>: 36.36<span style=color:#f92672>}</span>
</span></span></code></pre></div><h2 id=conclusion>Conclusion<a hidden class=anchor aria-hidden=true href=#conclusion>#</a></h2><p>Above code was adapted to redken, so when a new user message was received, both the group when the user wrote a sentence and the user itself, got a new dictionary of languages detected.</p><p>This approach, of using the &lsquo;moving %&rsquo;, just requires prior value for language and items count to calculate the new one reducing both the information needed to be stored to a minimum.</p><p>In the future, when I&rsquo;m adding back strings for languages, I can automate how redken reacts per channel (unless overridden) so that it provides messages in a more natural way for users.</p><p>Enjoy! (and if you do, you can
<a href=https://ko-fi.com/I2I4KDA0V target=_blank><img src=https://storage.ko-fi.com/cdn/brandasset/kofi_s_logo_nolabel.png height=36 style=border:0;height:36px;vertical-align:middle;display:inline-block border=0>
</img>
Buy Me a Coffee
</a>)</p></div><footer class=post-footer><ul class=post-tags><li><a href=https://iranzo.io/tags/english/>English</a></li><li><a href=https://iranzo.io/tags/language/>Language</a></li><li><a href=https://iranzo.io/tags/python/>Python</a></li><li><a href=https://iranzo.io/tags/foss/>FOSS</a></li><li><a href=https://iranzo.io/tags/telegram/>Telegram</a></li></ul><nav class=paginav><a class=prev href=https://iranzo.io/blog/2020/04/08/lego-10266-nasa-lunar-lander/><span class=title>« Prev</span><br><span>Lego 10266 NASA Lunar Lander</span>
</a><a class=next href=https://iranzo.io/blog/2020/03/24/english-game-baker-street/><span class=title>Next »</span><br><span>English Game - Baker Street</span></a></nav><ul class=share-buttons><li><a target=_blank rel="noopener noreferrer" aria-label="share Language detection in @redken_bot on x" href="https://x.com/intent/tweet/?text=Language%20detection%20in%20%40redken_bot&amp;url=https%3a%2f%2firanzo.io%2fblog%2f2020%2f03%2f25%2flanguage-detection-in-%40redken_bot%2f&amp;hashtags=English%2clanguage%2cpython%2cfoss%2ctelegram"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M512 62.554V449.446C512 483.97 483.97 512 449.446 512H62.554C28.03 512 0 483.97.0 449.446V62.554C0 28.03 28.029.0 62.554.0H449.446C483.971.0 512 28.03 512 62.554zM269.951 190.75 182.567 75.216H56L207.216 272.95 63.9 436.783h61.366L235.9 310.383l96.667 126.4H456L298.367 228.367l134-153.151H371.033zM127.633 110h36.468l219.38 290.065H349.5z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Language detection in @redken_bot on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2firanzo.io%2fblog%2f2020%2f03%2f25%2flanguage-detection-in-%40redken_bot%2f&amp;title=Language%20detection%20in%20%40redken_bot&amp;summary=Language%20detection%20in%20%40redken_bot&amp;source=https%3a%2f%2firanzo.io%2fblog%2f2020%2f03%2f25%2flanguage-detection-in-%40redken_bot%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Language detection in @redken_bot on reddit" href="https://reddit.com/submit?url=https%3a%2f%2firanzo.io%2fblog%2f2020%2f03%2f25%2flanguage-detection-in-%40redken_bot%2f&title=Language%20detection%20in%20%40redken_bot"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Language detection in @redken_bot on facebook" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2firanzo.io%2fblog%2f2020%2f03%2f25%2flanguage-detection-in-%40redken_bot%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Language detection in @redken_bot on whatsapp" href="https://api.whatsapp.com/send?text=Language%20detection%20in%20%40redken_bot%20-%20https%3a%2f%2firanzo.io%2fblog%2f2020%2f03%2f25%2flanguage-detection-in-%40redken_bot%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Language detection in @redken_bot on telegram" href="https://telegram.me/share/url?text=Language%20detection%20in%20%40redken_bot&amp;url=https%3a%2f%2firanzo.io%2fblog%2f2020%2f03%2f25%2flanguage-detection-in-%40redken_bot%2f"><svg viewBox="2 2 28 28" height="30" width="30" fill="currentcolor"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Language detection in @redken_bot on ycombinator" href="https://news.ycombinator.com/submitlink?t=Language%20detection%20in%20%40redken_bot&u=https%3a%2f%2firanzo.io%2fblog%2f2020%2f03%2f25%2flanguage-detection-in-%40redken_bot%2f"><svg width="30" height="30" viewBox="0 0 512 512" fill="currentcolor" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape"><path d="M449.446.0C483.971.0 512 28.03 512 62.554V449.446C512 483.97 483.97 512 449.446 512H62.554C28.03 512 0 483.97.0 449.446V62.554C0 28.03 28.029.0 62.554.0H449.446zM183.8767 87.9921h-62.034L230.6673 292.4508V424.0079h50.6655V292.4508L390.1575 87.9921H328.1233L256 238.2489z"/></svg></a></li></ul></footer></article></main><footer class=footer><span>&copy; 2025 <a href=https://iranzo.io/>Pablo Iranzo Gómez blog</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><center><small>This blog is a participant in the Amazon Associate Program, an affiliate advertising program designed to provide a means for sites to earn advertising fees by advertising and linking to Amazon.</small></center><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>