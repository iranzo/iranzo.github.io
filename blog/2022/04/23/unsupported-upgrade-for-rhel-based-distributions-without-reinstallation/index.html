<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Unsupported upgrade for RHEL-based distributions without reinstallation | Pablo Iranzo Gómez blog</title>
<meta name=keywords content="Linux,FOSS,CentOS,RHEL,Red Hat Enterprise Linux,AlmaLinux,Oracle Linux,Rocky Linux"><meta name=description content="Most systems, based on RHEL, were not able to upgrade without
reinstallation, or best said, not supported. The new version, that was
released at around 18 months later contained so many changes that it was
hard to test the upgrades themselves until leapp was introduced.
Check the lifecycle here: https://access.redhat.com/support/policy/updates/errata
However, the biggest problem could be the incompatibility of packages or
package formats&mldr; but as usually there were some middle layers it was
possible to upgrade without reinstallation by performing some manual steps."><meta name=author content="Pablo Iranzo Gómez"><link rel=canonical href=https://iranzo.io/blog/2022/04/23/unsupported-upgrade-for-rhel-based-distributions-without-reinstallation/><meta name=google-site-verification content="Bk4Z5ucHLyPXqlZlj5LzANpYBBSvxqBW4E8i-Kwf-bQ"><meta name=yandex-verification content="993ede96cdfbee95"><link crossorigin=anonymous href=../../../../../assets/css/stylesheet.css rel="preload stylesheet" as=style><link rel=icon href=https://iranzo.io/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://iranzo.io/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://iranzo.io/favicon-32x32.png><link rel=apple-touch-icon href=https://iranzo.io/apple-touch-icon.png><link rel=mask-icon href=https://iranzo.io/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://iranzo.io/blog/2022/04/23/unsupported-upgrade-for-rhel-based-distributions-without-reinstallation/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script async src="https://www.googletagmanager.com/gtag/js?id=G-ZL9P943TP1"></script><script>var dnt,doNotTrack=!1;if(!1&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-ZL9P943TP1")}</script><meta property="og:url" content="https://iranzo.io/blog/2022/04/23/unsupported-upgrade-for-rhel-based-distributions-without-reinstallation/"><meta property="og:site_name" content="Pablo Iranzo Gómez blog"><meta property="og:title" content="Unsupported upgrade for RHEL-based distributions without reinstallation"><meta property="og:description" content="Most systems, based on RHEL, were not able to upgrade without reinstallation, or best said, not supported. The new version, that was released at around 18 months later contained so many changes that it was hard to test the upgrades themselves until leapp was introduced.
Check the lifecycle here: https://access.redhat.com/support/policy/updates/errata
However, the biggest problem could be the incompatibility of packages or package formats… but as usually there were some middle layers it was possible to upgrade without reinstallation by performing some manual steps."><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="article:section" content="blog"><meta property="article:published_time" content="2022-04-23T21:23:48+00:00"><meta property="article:modified_time" content="2023-08-25T09:45:44+00:00"><meta property="article:tag" content="Linux"><meta property="article:tag" content="FOSS"><meta property="article:tag" content="CentOS"><meta property="article:tag" content="RHEL"><meta property="article:tag" content="Red Hat Enterprise Linux"><meta property="article:tag" content="AlmaLinux"><meta property="og:image" content="https://iranzo.io/mugshot.png"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://iranzo.io/mugshot.png"><meta name=twitter:title content="Unsupported upgrade for RHEL-based distributions without reinstallation"><meta name=twitter:description content="Most systems, based on RHEL, were not able to upgrade without
reinstallation, or best said, not supported. The new version, that was
released at around 18 months later contained so many changes that it was
hard to test the upgrades themselves until leapp was introduced.
Check the lifecycle here: https://access.redhat.com/support/policy/updates/errata
However, the biggest problem could be the incompatibility of packages or
package formats&mldr; but as usually there were some middle layers it was
possible to upgrade without reinstallation by performing some manual steps."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Blogs","item":"https://iranzo.io/blog/"},{"@type":"ListItem","position":2,"name":"Unsupported upgrade for RHEL-based distributions without reinstallation","item":"https://iranzo.io/blog/2022/04/23/unsupported-upgrade-for-rhel-based-distributions-without-reinstallation/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Unsupported upgrade for RHEL-based distributions without reinstallation","name":"Unsupported upgrade for RHEL-based distributions without reinstallation","description":"Most systems, based on RHEL, were not able to upgrade without reinstallation, or best said, not supported. The new version, that was released at around 18 months later contained so many changes that it was hard to test the upgrades themselves until leapp was introduced.\nCheck the lifecycle here: https://access.redhat.com/support/policy/updates/errata\nHowever, the biggest problem could be the incompatibility of packages or package formats\u0026hellip; but as usually there were some middle layers it was possible to upgrade without reinstallation by performing some manual steps.\n","keywords":["Linux","FOSS","CentOS","RHEL","Red Hat Enterprise Linux","AlmaLinux","Oracle Linux","Rocky Linux"],"articleBody":"Most systems, based on RHEL, were not able to upgrade without reinstallation, or best said, not supported. The new version, that was released at around 18 months later contained so many changes that it was hard to test the upgrades themselves until leapp was introduced.\nCheck the lifecycle here: https://access.redhat.com/support/policy/updates/errata\nHowever, the biggest problem could be the incompatibility of packages or package formats… but as usually there were some middle layers it was possible to upgrade without reinstallation by performing some manual steps.\nWarning\nThis procedure is completely unsupported, it should not be used on production systems and doesn’t ensure service availability during the upgrade. Or even system availability once finished…\nIn the past, the method that could be used, was to provide the upgradeany parameter to anaconda installer via the command line options, but this still required to boot from an ISO (or physical media) to perform the upgrade, and have little chance of recovery in case of any failure during the installation as anaconda environment was very limited in recovery options.\nIn brief:\nWe’ll move in unsupported ways from one release to another Package dependencies will require removing some packages or forcing installations ignoring dependencies that might cause issues At some point, if a power cut happens, the system might not be recoverable as it will be missing important parts. There could be leftovers in the system This will be a lengthy, process and prone to failure Upgrade the systems always before you reach to this situation, this is not something you want to do on regular basis because product has reached End-Of-Life (EOL) It should be easier to work on automating deployments and configurations so in the future you can redeploy on newer releases or newer hardware and get a track of all the performed configurations, etc, ideally on a control version system for traceability. Downloading files from older servers might be difficult, or even connecting to them, because of now obsoleted SSL or other crypto libraries. Don’t do this unless you want to fully risk the system you had For each release, try to download .0 and .latest versions, we will use .0 when upgrading from prior major, and before moving to next major version, we’ll update to the latest minor… in this way we might catch some errors of packages not upgraded or procedures… like kernel scripts that might install on the .0 but end up in an unbootable system, moving from .0 to .latest will allows us to reduce the chances of hitting this kind of issues. Preparation steps In order to start, it is safe to perform some steps:\nPerform a backup and prepare for reinstallation Ensure there’s enough free disk Get a copy of the install media on the system we’re going to update and have it at hand in case we need to recover Use tmux1 or screen as screen multiplexers so that we can recover in case of network connectivity issues Ensure that tools like wget are installed Have access to remote console, either via BMC or the virtualization platform if that’s the case. Check the documentation for the next release to see what are the breaking changes included in the release notes for each version, this will give us some hints about packages that we were using and are no longer available in our system. Upgrade the system To have a smoother experience, first step is to fully update the system to the latest version of the packages\n# EL5 onwards yum update --skip-broken Once we made sure that no further updates are available we’re ready for the next steps.\nDownload the install media to the system As indicated in the previous section, we need to download the install media to the system, this will make sure that we’ll have available a copy we can use without requiring network access to install whatever is needed in our host.\nWe’ll mount it to /mnt and create a repository file for using it in each release step. For mounting, we’ll execute:\nmount -o loop /root/rhel${VERSION}.iso /mnt Attempting the update The package managers yum and dnf include a flag that might be really useful as long as we’ve compatible repositories or we’ve made available our ISO install media on our system and created a custom repo definition for it.\nWe’ll follow this procedure on a RHEL base system, starting with RHEL 4.8 until RHEL 9 Beta.\nLet’s get ready on the environment…\nRHEL 4.8 installation Proceed to install RHEL 4.8 via the ISO on the system so that we’ve the test-bed ready for our procedure. Note\nAs you might have experienced… using a recent system to connect to a legacy one could be complicated as some insecure protocols have been disabled.\nCreate an entry like this in your .ssh/config file, so that insecure methods can be used to connect:\nHost 192.168.2.82 HostKeyAlgorithms=+ssh-rsa KexAlgorithms=+diffie-hellman-group1-sha1 PubkeyAcceptedKeyTypes=+ssh-rsa User root or alternatively on the command line:\nssh -oHostKeyAlgorithms=+ssh-rsa -oPubkeyAcceptedKeyTypes=+ssh-rsa root@192.168.2.8 RHEL 4.8 used up2date as method for connecting to RHN, however, as it is out of the support cycle I wouldn’t expect to get RHN working for it.\nAt that time, CentOS had the chance to create repositories and copy over the yum command so that it could be used on it, but let’s try to use what we’ve in the system… first of all, we need to load the RHEL ISO image into our system.\nAs we don’t have access to RHN, let’s loopback mount the ISO image and let’s install screen:\n[root@rhel-instance mnt]# mount /root/rhel4.8.iso /mnt [root@rhel-instance mnt]# cd /mnt [root@rhel-instance mnt]# rpm -Uvh RedHat/RPMS/screen-4.0.2-5.x86_64.rpm Preparing... ########################################### [100%] 1:screen ########################################### [100%] [root@rhel-instance mnt]# From this point, we should execute screen and continue working from within that shell\nWe can now cd into our user home folder and umount /mnt to start the process.\nRHEL 4.8 to RHEL 5.x upgrade First, let’s mount RHEL 5.x CD-ROM on /mnt and let’s start over…\nIn RHEL5, we used to have the main OS packages in the Server/ folder so let’s cd into it via cd /mnt/Server.\nIf you’re familiar with rpm the first attempt would be to use rpm -Fvh *.rpm to freshen all the packages, that is, install the updated versions and carry on… but we’ll get into a dependency hell, and if you attempt it, lot of the installed packages might have been already removed, and not be possible to upgrade…\nTo make our life easier, we need to do whatever we can to get yum and rpm packages updated to RHEL 5 versions, so that we can later use yum for the dependency resolution.\nNow, we begin a loop of package additions and removals to get to some state we can move forward…\nWhen we first attempt to update rpm, yum, etc. we begging requiring python and upgrading it will complain about some of the system-config-lvm or system-config-network… so the procedure is a try-and-error approach:\nrpm -e system-config-lvm rpm -e system-config-network rpm -e system-config-packages rpm -e gnome-python2-bonobo gnome-python2 gnome-python2-canvas And then start attempting to upgrade yum and rpm while you get into dependency hell like this:\nSo… we realized it is a pain, so let’s grab some ‘CentOS’ packages from the CentOS 4.9 VAULT that we can use to get yum working:\n$$ python-elementtree-1.2.6-5.el4.centos.x86_64.rpm python-sqlite-1.1.7-1.2.1.x86_64.rpm python-urlgrabber-2.9.8-2.noarch.rpm sqlite-3.3.6-2.x86_64.rpm yum-2.4.3-4.el4.centos.noarch.rpm yum-metadata-parser-1.0-8.el4.centos.x86_64.rpm$$\nLet’s copy them to our system (in case we haven’t downloaded them there) and let’s install them… using --nodeps as the packages require yumconf that we will not find as a built package:\n# Disable SELinux Enforcing setenforce 0 # Preferably, configure SElinux to be in permissive mode via editing the /etc/selinux/config file and setting it to 'SELINUX=permissive' # Install the packages for yum rpm -Uvh --nodeps python-elementtree-1.2.6-5.el4.centos.x86_64.rpm python-sqlite-1.1.7-1.2.1.x86_64.rpm python-urlgrabber-2.9.8-2.noarch.rpm sqlite-3.3.6-2.x86_64.rpm yum-2.4.3-4.el4.centos.noarch.rpm yum-metadata-parser-1.0-8.el4.centos.x86_64.rpm Now, let’s create a repo file at /etc/yum.repos.d/cdrom.repo with the following contents:\n[cdrom] name=CDROM baseurl=file:///mnt/Server/ enabled=1 gpgcheck=0 From this point, we could use yum to install packages…\nFirst packages to upgrade should be… again… yum and rpm and it will start several dependency loop checks that we’ll need to resolve… but in a lot easier way than having to manually specify the packages to upgrade.\nAs we’re on a server, let’s remove some more packages to get this progressing:\nrpm -e pcmcia-cs pm-utils bluez-utils rpm -e xorg-x11-xfs chkfontpath urw-fonts rpm -e kudzu system-config-mouse system-config-network-tui system-config-soundcard --nodeps rpm -e autofs libgnomeui up2date Now, let’s update some packages:\nyum update hwdata --\u003e Restarting Dependency Resolution with new changes. --\u003e Populating transaction set with selected packages. Please wait. ---\u003e Package glibc-common.x86_64 0:2.5-123 set to be updated --\u003e Running transaction check --\u003e Processing Conflict: glibc-common conflicts glibc \u003c 2.5 --\u003e Processing Dependency: glibc-common = 2.3.4-2.43 for package: glibc --\u003e Restarting Dependency Resolution with new changes. --\u003e Populating transaction set with selected packages. Please wait. ---\u003e Package glibc.i686 0:2.5-123 set to be updated --\u003e Running transaction check Dependencies Resolved ============================================================================= Package Arch Version Repository Size ============================================================================= Updating: hwdata noarch 0.213.30-1.el5 cdrom 477 k Updating for dependencies: glibc x86_64 2.5-123 cdrom 4.8 M glibc i686 2.5-123 cdrom 5.4 M glibc-common x86_64 2.5-123 cdrom 16 M module-init-tools x86_64 3.3-0.pre3.1.63.el5 cdrom 446 k Transaction Summary ============================================================================= Install 0 Package(s) Update 5 Package(s) Remove 0 Package(s) Total download size: 28 M Is this ok [y/N]: y Downloading Packages: Running Transaction Test Finished Transaction Test Transaction Test Succeeded Running Transaction Updating : glibc-common ####################### [ 1/10] Updating : glibc ####################### [ 2/10] Updating : glibc [ 3/10]warning: /etc/localtime created as /etc/localtime.rpmnew Updating : glibc [ 3/10]warning: /etc/nsswitch.conf created as /etc/nsswitch.conf.rpmnew Updating : glibc ####################### [ 3/10] Updating : module-init-tools ####################### [ 4/10] Updating : hwdata ####################### [ 5/10] Cleanup : glibc ####################### [ 6/10] Cleanup : module-init-tools ####################### [ 7/10] Cleanup : glibc-common ####################### [ 8/10] Cleanup : glibc ####################### [ 9/10] Cleanup : hwdata ####################### [10/10] Updated: hwdata.noarch 0:0.213.30-1.el5 Dependency Updated: glibc.x86_64 0:2.5-123 glibc.i686 0:2.5-123 glibc-common.x86_64 0:2.5-123 module-init-tools.x86_64 0:3.3-0.pre3.1.63.el5 Complete! First packages updated using yum!!\nNow, we’re hitting several issues with kernel being incompatible… so let’s remove it but just from the database (as well as other packages):\nrpm -e kernel --nodeps --justdb --noscripts rpm -e python-elementtree util-linux yum initscripts glib2 procps --justdb --noscripts rpm -e system-config-securitylevel After those steps… that again… are critical we can start updating some more packages:\nyum -y install yum hal initscripts After it finishes, we can try again to update yum:\n[root@rhel-instance ~]# yum install yum There was a problem importing one of the Python modules required to run yum. The error leading to this problem was: No module named urlgrabber Please install a package which provides this module, or verify that the module is installed correctly. It's possible that the above module doesn't match the current version of Python, which is: 2.4.3 (#1, Oct 23 2012, 22:02:41) [GCC 4.1.2 20080704 (Red Hat 4.1.2-54)] If you cannot solve this problem yourself, please go to the yum faq at: http://wiki.linux.duke.edu/YumFaq And BAM!, it fails… let’s check RPM for yum:\n[root@rhel-instance ~]# rpm -q yum rpmdb: Program version 4.3 doesn't match environment version error: db4 error(-30974) from dbenv-\u003eopen: DB_VERSION_MISMATCH: Database environment version mismatch error: cannot open Packages index using db3 - (-30974) error: cannot open Packages database in /var/lib/rpm package yum is not installed BAM!, rpm can’t find the packages…\nLet’s remove the old database of rpm:\nrm -fv /var/lib/rpm/__db* [root@rhel-instance ~]# cd /var/lib/rpm/ [root@rhel-instance rpm]# ls Basenames __db.000 __db.002 Dirnames Group Name Providename Pubkeys Requireversion Sigmd5 Conflictname __db.001 __db.003 Filemd5s Installtid Packages Provideversion Requirename Sha1header Triggername [root@rhel-instance rpm]# ls -l total 19800 -rw-r--r-- 1 root root 1445888 Mar 25 21:58 Basenames -rw-r--r-- 1 root root 12288 Mar 25 21:58 Conflictname -rw-r--r-- 1 root root 0 Mar 25 22:00 __db.000 -rw-r--r-- 1 root root 16384 Mar 25 20:02 __db.001 -rw-r--r-- 1 root root 1318912 Mar 25 20:02 __db.002 -rw-r--r-- 1 root root 663552 Mar 25 20:02 __db.003 -rw-r--r-- 1 root root 352256 Mar 25 21:58 Dirnames -rw-r--r-- 1 root root 2613248 Mar 25 21:58 Filemd5s -rw-r--r-- 1 root root 12288 Mar 25 21:58 Group -rw-r--r-- 1 root root 16384 Mar 25 21:58 Installtid -rw-r--r-- 1 root root 24576 Mar 25 21:58 Name -rw-r--r-- 1 root root 14315520 Mar 25 21:58 Packages -rw-r--r-- 1 root root 180224 Mar 25 21:58 Providename -rw-r--r-- 1 root root 65536 Mar 25 21:58 Provideversion -rw-r--r-- 1 root root 12288 Mar 25 21:57 Pubkeys -rw-r--r-- 1 root root 188416 Mar 25 21:58 Requirename -rw-r--r-- 1 root root 102400 Mar 25 21:58 Requireversion -rw-r--r-- 1 root root 45056 Mar 25 21:58 Sha1header -rw-r--r-- 1 root root 45056 Mar 25 21:58 Sigmd5 -rw-r--r-- 1 root root 12288 Mar 25 21:58 Triggername [root@rhel-instance rpm]# rm -fv __db.00* removed `__db.000' removed `__db.001' removed `__db.002' removed `__db.003' [root@rhel-instance rpm]# rpm -q yum yum-3.2.22-40.el5 Now, as you can see, we’ve yum again :-) (but it still doesn’t work)…\nLet’s manually install the missing libraries:\nrpm -Uvh python-urlgrabber-3.1.0-6.el5.noarch.rpm m2crypto-0.16-9.el5.x86_64.rpm Next one failing after this… is sqlite…\nLet’s reinstall it:\nrpm -Uvh --force python-sqlite-1.1.7-1.2.1.x86_64.rpm After this step, yum works again, so let’s find next target for installation… but first let’s install some more packages with rpm:\nrpm -Uvh rhn-client-tools-0.4.20.1-9.el5.noarch.rpm python-dmidecode-3.10.13-1.el5_5.1.x86_64.rpm rhn-check-0.4.20.1-9.el5.noarch.rpm rhn-setup-0.4.20.1-9.el5.noarch.rpm rhnsd-4.7.0-14.el5.x86_64.rpm yum-rhn-plugin-0.5.4.1-7.el5.noarch.rpm rhnlib-2.5.22.1-6.el5.noarch.rpm Let’s install some packages as well as some of the already installed ones…\n[root@localhost Server]# rpm -Uvh libpcap-0.9.4-15.el5.x86_64.rpm ppp-2.4.4-2.el5.x86_64.rpm kernel-2.6.18-398.el5.x86_64.rpm mkinitrd-5.1.19.6-82.el5.x86_64.rpm procps-3.2.7-26.el5.x86_64.rpm nash-5.1.19.6-82.el5.x86_64.rpm kpartx-0.4.7-63.el5.x86_64.rpm e2fsprogs-1.39-37.el5.x86_64.rpm device-mapper-multipath-0.4.7-63.el5.x86_64.rpm selinux-policy-targeted-2.4.6-351.el5.noarch.rpm hmaccalc-0.9.6-4.el5.x86_64.rpm iscsi-initiator-utils-6.2.0.872-16.el5.x86_64.rpm lksctp-tools-1.0.6-3.el5.x86_64.rpm selinux-policy-targeted-2.4.6-351.el5.noarch.rpm quota-3.13-8.el5.x86_64.rpm krb5-workstation-1.6.1-78.el5.x86_64.rpm NetworkManager-0.7.0-13.el5.x86_64.rpm parted-1.8.1-30.el5.x86_64.rpm util-linux-2.13-0.59.el5_8.x86_64.rpm cryptsetup-luks-1.0.3-8.el5.x86_64.rpm openssh-server-4.3p2-82.el5.x86_64.rpm gtk2-2.10.4-30.el5.x86_64.rpm gnupg-1.4.5-18.el5_10.1.x86_64.rpm e2fsprogs-libs-1.39-37.el5.x86_64.rpm isdn4k-utils-3.2-56.el5.x86_64.rpm libsysfs-2.1.0-1.el5.x86_64.rpm policycoreutils-1.33.12-14.13.el5.x86_64.rpm selinux-policy-2.4.6-351.el5.noarch.rpm audit-libs-python-1.8-2.el5.x86_64.rpm libselinux-python-1.33.4-5.7.el5.x86_64.rpm libsemanage-1.9.1-4.4.el5.x86_64.rpm --force Let’s get remove some other conflict packages…\n[root@localhost Server]# rpm -Uvh gettext-0.17-1.el5.x86_64.rpm libgomp-4.4.7-1.el5.x86_64.rpm For Updating the filesystem package we need to make a trick… find the file on the /mnt folder… copy it over to /root and umount the CD-ROM\nThen install it from the root folder:\nrpm -Uvh filesystem.rpm Once finished, remount the CD-ROM and let’s continue with some other dependencies:\nrpm -Uvh openib-1.5.4.1-4.el5.noarch.rpm pycairo-1.2.0-1.1.x86_64.rpm rpm -Uvh gnome-python2-canvas-2.16.0-1.fc6.x86_64.rpm yelp-2.16.0-30.el5_9.x86_64.rpm firstboot-1.4.27.9-1.el5.x86_64.rpm rhpxl-0.41.1-12.el5.x86_64.rpm metacity-2.16.0-16.el5.x86_64.rpm gnome-python2-2.16.0-1.fc6.x86_64.rpm gnome-doc-utils-0.8.0-2.fc6.noarch.rpm scrollkeeper-0.3.14-9.el5.x86_64.rpm firstboot-tui-1.4.27.9-1.el5.x86_64.rpm system-config-display-1.0.48-4.el5.noarch.rpm system-config-network-1.3.99.23-1.el5.noarch.rpm redhat-artwork-5.0.9-2.el5.x86_64.rpm docbook-dtds-1.0-30.1.noarch.rpm xorg-x11-fonts-Type1-7.1-2.1.el5.noarch.rpm pkgconfig-0.21-2.el5.x86_64.rpm system-config-soundcard-2.0.6-1.el5.noarch.rpm alsa-utils-1.0.17-7.el5.x86_64.rpm xml-common-0.6.3-18.noarch.rpm openjade-1.3.2-27.x86_64.rpm redhat-menus-6.7.8-3.el5.noarch.rpm redhat-logos-4.9.16-1.noarch.rpm sgml-common-0.6.3-18.noarch.rpm xorg-x11-server-Xorg-1.1.1-48.101.el5_10.3.x86_64.rpm system-config-securitylevel-tui-1.6.29.1-6.el5.x86_64.rpm xorg-x11-utils-7.1-2.fc6.x86_64.rpm xorg-x11-server-utils-7.1-5.el5_6.2.x86_64.rpm xorg-x11-drv-vesa-1.3.0-8.3.el5.x86_64.rpm xorg-x11-drv-void-1.1.0-3.1.x86_64.rpm xorg-x11-drv-evdev-1.0.0.5-5.el5.x86_64.rpm xorg-x11-drv-mouse-1.1.1-1.1.x86_64.rpm cpp-4.1.2-55.el5.x86_64.rpm gtk2-engines-2.8.0-3.el5.x86_64.rpm gnome-python2-2.16.0-1.fc6.x86_64.rpm gnome-python2-bonobo-2.16.0-1.fc6.x86_64.rpm pyxf86config-0.3.31-3.el5.x86_64.rpm system-config-securitylevel-1.6.29.1-6.el5.x86_64.rpm xorg-x11-drv-keyboard-1.1.0-3.x86_64.rpm xorg-x11-fonts-base-7.1-2.1.el5.noarch.rpm gnome-python2-gnomevfs-2.16.0-1.fc6.x86_64.rpm --nodeps Let’s install some more missing dependencies with rpm:\nrpm -Uvh python-numeric-23.7-2.2.2.el5_6.1.x86_64.rpm pygobject2-2.12.1-5.el5.x86_64.rpm And let’s attempt freshen of all the remaining packages:\nrpm -Fvh *.rpm # Let's also install createrepo... we'll need it later rpm -ivh createrepo*.rpm After this… only a few packages are missing to upgrade, yum is still not working as it complains with some problems with the rpm database, so we need to continue with rpm:\nrpm -Uvh kexec-tools-1.102pre-165.el5.x86_64.rpm busybox-1.2.0-14.el5.x86_64.rpm mesa-libGL-6.5.1-7.11.el5_9.x86_64.rpm libdrm-2.0.2-1.1.x86_64.rpm rpm -Uvh mlocate-0.15-1.el5.2.x86_64.rpm redhat-release-notes-5Server-52.x86_64.rpm tzdata-2014e-1.el5.x86_64.rpm Here, yum now reports that no packages are missing to update… so let’s attempt to reboot the system and cross fingers..\nIf the system rebooted, make sure it shows the right kernel for EL5… 2.6.9 is a bad value… it should read 2.6.18… if you’re in that case, once the system boots, mount the CD-ROM again, and force kernel reinstallation via:\nrpm -ivh --force /mnt/Server/kernel-2.6.18-398.el5.x86_64.rpm And reboot again.\nRHEL5 to RHEL6 upgrade Wow, now we’re on RHEL5, yum is already native in this version, so that we can update the cdrom.repo file to point to the root of the mount point instead of the Server folder, then run yum update and… BAM!, incompatible hash for the repository…\nAs we installed createrepo before we can cd into our home folder and run:\n[root@localhost ~]# cd [root@localhost ~]# mkdir el6 [root@localhost ~]# for file in /mnt/Packages/*.rpm; do ln -s $file . ;done [root@localhost ~]# createrepo -o el6 -u file:///mnt/Packages/ /mnt/Packages/ 3861/3861 - zsh-4.3.11-8.el6.x86_64.rpm Saving Primary metadata Saving file lists metadata Saving other metadata Once this is done, we need to update our cdrom.repo file to point to the location file:///root/el6 ;-)\nLet’s start again… removing some packages:\nyum remove system-config-* kudzu rhnlib python-numeric rhpl avahi ipsec-tools OpenIPMI authconfig yum remove xorg-x11-server-utils xorg-x11-server-Xorg xorg-x11-utils xorg-x11-fonts-base xorg-x11-fonts-Type1 openjade rpm -e sudo-1.6.7p5-30.1.5.x86_64 --justdb # (as package-cleanup --dupes was showing it) yum remove OpenIPMI-libs-2.0.16-16.el5.x86_64 bluez-hcidump-1.32-1.x86_64 rpm -e libnotify-0.4.2-6.el5.x86_64 net-snmp-libs-5.3.2.2-22.el5_10.1.x86_64 libbonobo-2.16.0-1.1.el5_5.1.x86_64 libibcommon-1.2.0-1.el5.x86_64 libsdp-1.1.108-1.el5.x86_64 bluez-libs-3.7-1.1.x86_64 glib-1.2.10-20.el5.x86_64 libmthca-1.0.6-1.el5.x86_64 compat-libstdc++-33-3.2.3-61.x86_64 libgnomecanvas-2.14.0-4.1.x86_64 libart_lgpl-2.3.17-4.x86_64 # Remove packages that are not from x86_64 (it used to be required in older ones, but not any longer.) uname -a |grep x86_64 \u0026\u0026 yum remove *.i{3,4,5,6}86 Ok, so we’re back on having issues with rpm features that we don’t have at EL5… so we need to update rpm and required components so that we can continue installing newer packages.\nThis approach brings us to the egg-chicken issue… we can’t install the packages because our installed version is old, and until we update them, we can’t install the other updates… and even cpio is older than the version used, so we might need to use an intermediate machine to uncompress the rpm related packages copy them over, and use them to install the updates on the system itself.\nWe need to prepare and uncompress the following files from the install media on a newer machine\nPACKAGES=\"db4-4.7.25-16.el6.x86_64.rpm glibc-2.12-1.7.el6.x86_64.rpm glibc-common-2.12-1.7.el6.x86_64.rpm glibc-utils-2.12-1.7.el6.x86_64.rpm libcap-2.16-5.2.el6.x86_64.rpm lua-5.1.4-4.1.el6.x86_64.rpm popt-1.13-7.el6.x86_64.rpm rpm-4.8.0-12.el6.x86_64.rpm rpm-build-4.8.0-12.el6.x86_64.rpm rpm-libs-4.8.0-12.el6.x86_64.rpm rpm-python-4.8.0-12.el6.x86_64.rpm xz-libs-4.999.9-0.3.beta.20091007git.el6.x86_64.rpm\" for package in $PACKAGES;do echo \"Uncompressing $package\" rpm2cpio /mnt/Packages/$package | cpio -idmv done Once the process has finished, you’ll get a list of folders that need to be copied back to the host… note, this will overwrite libraries, binaries and can render your system unusable.\nOnce that step is done… your system should have RPM version 4.8.0 and you can use it to install and force install several set of packages… until you can get yum working again…\nIn this case, yum provided in EL6, features the distro-sync command, which is a simple way to update the system to the latest available packages in our local repository.\nYum might complain of some missing packages.. ensure to get yum packages installed, as well as expat, SSL and some other dependencies that will complain.\nOnce YUM is working and distro-sync has finished, we need to edit the cdrom.repo to act against the folder with the packages (so that it has the group information), perform a yum clean and then yum groupinstall base so that all the missing packages from a base system are installed.. resolving conflicts like the redhat-release-notes etc by manually removing and then adding the new versions of the files.\nEnsure also to remove all packages named .el5. from our system… we should be on el6 now…\nAnd our system is ready for next step!\nRHEL6 to RHEL7 upgrade Well, we got until this point, so we’re back into the versions that are ‘supported’ under the ELS.\nLet’s follow the standard approach to register our system and attach to a pool:\nyum -y install subscription-manager subscription-manager register subscription-manager attach pool=XXXXXXX Then, let’s add extra repositories we might require:\nsubscription-manager repos --enable rhel-6-server-extras-rpms subscription-manager repos --enable rhel-6-server-optional-rpms # And then, let's install preupgrade tools yum install preupgrade-assistant preupgrade-assistant-el6toel7 redhat-upgrade-tool Check for the next steps in the official documentation:\nhttps://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/7/html-single/upgrading_from_rhel_6_to_rhel_7/index\nEnjoy! (and if you do, you can Buy Me a Coffee ) tmux or screen allows to disconnect, re-attach or even open new terminals without having to open a new ssh connection, this makes it a lot easier to spawn a new shell and operate without risking a disconnection from our system. ↩︎\n","wordCount":"3170","inLanguage":"en","image":"https://iranzo.io/mugshot.png","datePublished":"2022-04-23T21:23:48.013Z","dateModified":"2023-08-25T09:45:44.541Z","author":{"@type":"Person","name":"Pablo Iranzo Gómez"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://iranzo.io/blog/2022/04/23/unsupported-upgrade-for-rhel-based-distributions-without-reinstallation/"},"publisher":{"@type":"Organization","name":"Pablo Iranzo Gómez blog","logo":{"@type":"ImageObject","url":"https://iranzo.io/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://iranzo.io/ accesskey=h title="Home (Alt + H)"><img src=https://iranzo.io/apple-icon-152x152.png alt aria-label=logo height=35>Home</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)" aria-label="Toggle theme"><svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button><ul class=lang-switch><li>|</li><li><a href=https://iranzo.io/es/ title=Spanish aria-label=Spanish>Es</a></li></ul></div></div><ul id=menu><li><a href=https://iranzo.io/ title=🏠Home><span>🏠Home</span></a></li><li><a href=https://iranzo.io/about/ title=🗒️About><span>🗒️About</span></a></li><li><a href=https://iranzo.io/redken_bot/ title=🐘redken_bot><span>🐘redken_bot</span></a></li><li><a href=https://iranzo.io/projects/ title=📐Projects><span>📐Projects</span></a></li><li><a href=https://iranzo.io/archives/ title="🗄️ Archives"><span>🗄️ Archives</span></a></li><li><a href=https://iranzo.io/categories/ title=🗺️Categories><span>🗺️Categories</span></a></li><li><a href=https://iranzo.io/tags/ title=🏷️Tags><span>🏷️Tags</span></a></li><li><a href=https://iranzo.io/search title="🔎Search (Alt + /)" accesskey=/><span>🔎Search</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://iranzo.io/>Home</a>&nbsp;»&nbsp;<a href=https://iranzo.io/blog/>Blogs</a></div><h1 class="post-title entry-hint-parent">Unsupported upgrade for RHEL-based distributions without reinstallation</h1><div class=post-meta><span title='2022-04-23 21:23:48.013 +0000 UTC'>April 23, 2022</span>&nbsp;·&nbsp;15 min&nbsp;·&nbsp;Pablo Iranzo Gómez</div></header><div class=toc><details open><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><ul><li><a href=#preparation-steps aria-label="Preparation steps">Preparation steps</a><ul><li><a href=#upgrade-the-system aria-label="Upgrade the system">Upgrade the system</a></li><li><a href=#download-the-install-media-to-the-system aria-label="Download the install media to the system">Download the install media to the system</a></li></ul></li><li><a href=#attempting-the-update aria-label="Attempting the update">Attempting the update</a></li><li><a href=#rhel-48-installation aria-label="RHEL 4.8 installation">RHEL 4.8 installation</a></li><li><a href=#rhel-48-to-rhel-5x-upgrade aria-label="RHEL 4.8 to RHEL 5.x upgrade">RHEL 4.8 to RHEL 5.x upgrade</a></li><li><a href=#rhel5-to-rhel6-upgrade aria-label="RHEL5 to RHEL6 upgrade">RHEL5 to RHEL6 upgrade</a></li><li><a href=#rhel6-to-rhel7-upgrade aria-label="RHEL6 to RHEL7 upgrade">RHEL6 to RHEL7 upgrade</a></li></ul></div></details></div><div class=post-content><p>Most systems, based on RHEL, were not able to upgrade without
reinstallation, or best said, not supported. The new version, that was
released at around 18 months later contained so many changes that it was
hard to test the upgrades themselves until <code>leapp</code> was introduced.</p><p>Check the lifecycle here: <a href=https://access.redhat.com/support/policy/updates/errata>https://access.redhat.com/support/policy/updates/errata</a></p><p>However, the biggest problem could be the incompatibility of packages or
package formats&mldr; but as usually there were some middle layers it was
possible to upgrade without reinstallation by performing some manual steps.</p><div class="admonition warning"><p class=admonition-title>Warning</p><p class=admonition>This procedure is completely unsupported, it should not be
used on production systems and doesn&rsquo;t ensure service availability during
the upgrade. Or even system availability once finished&mldr;</p></div><p>In the past, the method that could be used, was to provide the <code>upgradeany</code>
parameter to anaconda installer via the command line options, but this still
required to boot from an <code>ISO</code> (or physical media) to perform the upgrade,
and have little chance of recovery in case of any failure during the
installation as anaconda environment was very limited in recovery options.</p><p>In brief:</p><ul><li>We&rsquo;ll move in unsupported ways from one release to another</li><li>Package dependencies will require removing some packages or forcing installations ignoring dependencies that might cause issues</li><li>At some point, if a power cut happens, the system might not be recoverable as it will be missing important parts.</li><li>There could be leftovers in the system</li><li>This will be a lengthy, process and prone to failure</li><li>Upgrade the systems always before you reach to this situation, this is not something you want to do on regular basis because product has reached End-Of-Life (EOL)</li><li>It should be easier to work on automating deployments and configurations so in the future you can redeploy on newer releases or newer hardware and get a track of all the performed configurations, etc, ideally on a control version system for traceability.</li><li>Downloading files from older servers might be difficult, or even connecting to them, because of now obsoleted SSL or other crypto libraries.</li><li>Don&rsquo;t do this unless you want to fully risk the system you had</li><li>For each release, try to download <code>.0</code> and <code>.latest</code> versions, we will use <code>.0</code> when upgrading from prior major, and before moving to next major version, we&rsquo;ll update to the latest minor&mldr; in this way we might catch some errors of packages not upgraded or procedures&mldr; like kernel scripts that might install on the <code>.0</code> but end up in an unbootable system, moving from <code>.0</code> to <code>.latest</code> will allows us to reduce the chances of hitting this kind of issues.</li></ul><h2 id=preparation-steps>Preparation steps<a hidden class=anchor aria-hidden=true href=#preparation-steps>#</a></h2><p>In order to start, it is safe to perform some steps:</p><ul><li>Perform a backup and prepare for reinstallation</li><li>Ensure there&rsquo;s enough free disk</li><li>Get a copy of the install media on the system we&rsquo;re going to update and have it at hand in case we need to recover</li><li>Use <code>tmux</code><sup id=fnref:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup> or <code>screen</code> as screen multiplexers so that we can recover in case of network connectivity issues</li><li>Ensure that tools like <code>wget</code> are installed</li><li>Have access to remote console, either via <code>BMC</code> or the virtualization platform if that&rsquo;s the case.</li><li>Check the documentation for the next release to see what are the breaking changes included in the release notes for each version, this will give us some hints about packages that we were using and are no longer available in our system.</li></ul><h3 id=upgrade-the-system>Upgrade the system<a hidden class=anchor aria-hidden=true href=#upgrade-the-system>#</a></h3><p>To have a smoother experience, first step is to fully update the system to the latest version of the packages</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span><span style=color:#75715e># EL5 onwards</span>
</span></span><span style=display:flex><span>yum update --skip-broken
</span></span></code></pre></div><p>Once we made sure that no further updates are available we&rsquo;re ready for the next steps.</p><h3 id=download-the-install-media-to-the-system>Download the install media to the system<a hidden class=anchor aria-hidden=true href=#download-the-install-media-to-the-system>#</a></h3><p>As indicated in the previous section, we need to download the install media
to the system, this will make sure that we&rsquo;ll have available a copy we can
use without requiring network access to install whatever is needed in our
host.</p><p>We&rsquo;ll mount it to <code>/mnt</code> and create a repository file for using it in each release step. For mounting, we&rsquo;ll execute:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>mount -o loop /root/rhel<span style=color:#e6db74>${</span>VERSION<span style=color:#e6db74>}</span>.iso /mnt
</span></span></code></pre></div><h2 id=attempting-the-update>Attempting the update<a hidden class=anchor aria-hidden=true href=#attempting-the-update>#</a></h2><p>The package managers <code>yum</code> and <code>dnf</code> include a flag that might be really
useful as long as we&rsquo;ve compatible repositories or we&rsquo;ve made available our
<code>ISO</code> install media on our system and created a custom repo definition for
it.</p><p>We&rsquo;ll follow this procedure on a RHEL base system, starting with RHEL 4.8 until RHEL 9 Beta.</p><p>Let&rsquo;s get ready on the environment&mldr;</p><h2 id=rhel-48-installation>RHEL 4.8 installation<a hidden class=anchor aria-hidden=true href=#rhel-48-installation>#</a></h2><p>Proceed to install RHEL 4.8 via the ISO on the system so that we&rsquo;ve the test-bed ready for our procedure.
<img loading=lazy src=../../../../../blog/2022/04/23/unsupported-upgrade-for-rhel-based-distributions-without-reinstallation/rhel4boot.png></p><p><img loading=lazy src=../../../../../blog/2022/04/23/unsupported-upgrade-for-rhel-based-distributions-without-reinstallation/rhel4welcome.png></p><div class="admonition note"><p class=admonition-title>Note</p><p class=admonition><p>As you might have experienced&mldr; using a recent system to connect to a legacy one could be complicated as some insecure protocols have been disabled.</p><p>Create an entry like this in your <code>.ssh/config</code> file, so that insecure methods can be used to connect:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-console data-lang=console><span style=display:flex><span>Host 192.168.2.82
</span></span><span style=display:flex><span>	HostKeyAlgorithms=+ssh-rsa
</span></span><span style=display:flex><span>	KexAlgorithms=+diffie-hellman-group1-sha1
</span></span><span style=display:flex><span>  PubkeyAcceptedKeyTypes=+ssh-rsa
</span></span><span style=display:flex><span>	User root
</span></span></code></pre></div><p>or alternatively on the command line:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>ssh -oHostKeyAlgorithms<span style=color:#f92672>=</span>+ssh-rsa -oPubkeyAcceptedKeyTypes<span style=color:#f92672>=</span>+ssh-rsa root@192.168.2.8
</span></span></code></pre></div></p></div><p>RHEL 4.8 used <code>up2date</code> as method for connecting to <code>RHN</code>, however, as it is out of the support cycle I wouldn&rsquo;t expect to get RHN working for it.</p><p>At that time, CentOS had the chance to create repositories and copy over the
<code>yum</code> command so that it could be used on it, but let&rsquo;s try to use what
we&rsquo;ve in the system&mldr; first of all, we need to load the <code>RHEL</code> ISO image
into our system.</p><p>As we don&rsquo;t have access to RHN, let&rsquo;s loopback mount the <code>ISO</code> image and let&rsquo;s install <code>screen</code>:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span><span style=color:#f92672>[</span>root@rhel-instance mnt<span style=color:#f92672>]</span><span style=color:#75715e># mount /root/rhel4.8.iso /mnt</span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>root@rhel-instance mnt<span style=color:#f92672>]</span><span style=color:#75715e># cd /mnt</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>root@rhel-instance mnt<span style=color:#f92672>]</span><span style=color:#75715e># rpm -Uvh RedHat/RPMS/screen-4.0.2-5.x86_64.rpm</span>
</span></span><span style=display:flex><span>Preparing...                <span style=color:#75715e>########################################### [100%]</span>
</span></span><span style=display:flex><span>   1:screen                 <span style=color:#75715e>########################################### [100%]</span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>root@rhel-instance mnt<span style=color:#f92672>]</span><span style=color:#75715e>#</span>
</span></span></code></pre></div><p>From this point, we should execute <code>screen</code> and continue working from within that shell</p><p>We can now <code>cd</code> into our user home folder and <code>umount /mnt</code> to start the process.</p><h2 id=rhel-48-to-rhel-5x-upgrade>RHEL 4.8 to RHEL 5.x upgrade<a hidden class=anchor aria-hidden=true href=#rhel-48-to-rhel-5x-upgrade>#</a></h2><p>First, let&rsquo;s mount RHEL 5.x CD-ROM on <code>/mnt</code> and let&rsquo;s start over&mldr;</p><p>In RHEL5, we used to have the main OS packages in the <code>Server/</code> folder so let&rsquo;s <code>cd</code> into it via <code>cd /mnt/Server</code>.</p><p>If you&rsquo;re familiar with <code>rpm</code> the first attempt would be to use <code>rpm -Fvh *.rpm</code> to freshen all the packages, that is, install the updated versions and carry on&mldr; but we&rsquo;ll get into a dependency hell, and if you attempt it, lot of the installed packages might have been already removed, and not be possible to upgrade&mldr;</p><p>To make our life easier, we need to do whatever we can to get <code>yum</code> and <code>rpm</code> packages updated to RHEL 5 versions, so that we can later use <code>yum</code> for the dependency resolution.</p><p>Now, we begin a loop of package additions and removals to get to some state we can move forward&mldr;</p><p>When we first attempt to update <code>rpm</code>, <code>yum</code>, etc. we begging requiring <code>python</code> and upgrading it will complain about some of the <code>system-config-lvm</code> or <code>system-config-network</code>&mldr; so the procedure is a try-and-error approach:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>rpm -e system-config-lvm
</span></span><span style=display:flex><span>rpm -e system-config-network
</span></span><span style=display:flex><span>rpm -e system-config-packages
</span></span><span style=display:flex><span>rpm -e gnome-python2-bonobo gnome-python2 gnome-python2-canvas
</span></span></code></pre></div><p>And then start attempting to upgrade <code>yum</code> and <code>rpm</code> while you get into dependency hell like this:</p><p><img loading=lazy src=../../../../../blog/2022/04/23/unsupported-upgrade-for-rhel-based-distributions-without-reinstallation/rpmdependency.png></p><p>So&mldr; we realized it is a pain, so let&rsquo;s grab some &lsquo;CentOS&rsquo; packages from the <a href=https://vault.centos.org/4.9/os/x86_64/CentOS/RPMS/>CentOS 4.9 VAULT</a> that we can use to get yum working:</p><p>$$ python-elementtree-1.2.6-5.el4.centos.x86_64.rpm
python-sqlite-1.1.7-1.2.1.x86_64.rpm
python-urlgrabber-2.9.8-2.noarch.rpm
sqlite-3.3.6-2.x86_64.rpm
yum-2.4.3-4.el4.centos.noarch.rpm
yum-metadata-parser-1.0-8.el4.centos.x86_64.rpm$$</p><p>Let&rsquo;s copy them to our system (in case we haven&rsquo;t downloaded them there) and let&rsquo;s install them&mldr; using <code>--nodeps</code> as the packages require <code>yumconf</code> that we will not find as a built package:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span><span style=color:#75715e># Disable SELinux Enforcing</span>
</span></span><span style=display:flex><span>setenforce <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Preferably, configure SElinux to be in permissive mode via editing the /etc/selinux/config file and setting it to &#39;SELINUX=permissive&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Install the packages for  yum</span>
</span></span><span style=display:flex><span>rpm -Uvh --nodeps python-elementtree-1.2.6-5.el4.centos.x86_64.rpm  python-sqlite-1.1.7-1.2.1.x86_64.rpm   python-urlgrabber-2.9.8-2.noarch.rpm  sqlite-3.3.6-2.x86_64.rpm  yum-2.4.3-4.el4.centos.noarch.rpm  yum-metadata-parser-1.0-8.el4.centos.x86_64.rpm
</span></span></code></pre></div><p>Now, let&rsquo;s create a repo file at <code>/etc/yum.repos.d/cdrom.repo</code> with the following contents:</p><pre tabindex=0><code class=language-inifile data-lang=inifile>[cdrom]
name=CDROM
baseurl=file:///mnt/Server/
enabled=1
gpgcheck=0
</code></pre><p>From this point, we could use <code>yum</code> to install packages&mldr;</p><p>First packages to upgrade should be&mldr; again&mldr; <code>yum</code> and <code>rpm</code> and it will start several dependency loop checks that we&rsquo;ll need to resolve&mldr; but in a lot easier way than having to manually specify the packages to upgrade.</p><p><img loading=lazy src=../../../../../blog/2022/04/23/unsupported-upgrade-for-rhel-based-distributions-without-reinstallation/yumdependency.png></p><p>As we&rsquo;re on a server, let&rsquo;s remove some more packages to get this progressing:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>rpm -e pcmcia-cs pm-utils bluez-utils
</span></span><span style=display:flex><span>rpm -e xorg-x11-xfs chkfontpath urw-fonts
</span></span><span style=display:flex><span>rpm -e kudzu system-config-mouse system-config-network-tui system-config-soundcard --nodeps
</span></span><span style=display:flex><span>rpm -e autofs libgnomeui up2date
</span></span></code></pre></div><p>Now, let&rsquo;s update some packages:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-console data-lang=console><span style=display:flex><span>yum update hwdata
</span></span><span style=display:flex><span>--&gt; Restarting Dependency Resolution with new changes.
</span></span><span style=display:flex><span>--&gt; Populating transaction set with selected packages. Please wait.
</span></span><span style=display:flex><span>---&gt; Package glibc-common.x86_64 0:2.5-123 set to be updated
</span></span><span style=display:flex><span>--&gt; Running transaction check
</span></span><span style=display:flex><span>--&gt; Processing Conflict: glibc-common conflicts glibc &lt; 2.5
</span></span><span style=display:flex><span>--&gt; Processing Dependency: glibc-common = 2.3.4-2.43 for package: glibc
</span></span><span style=display:flex><span>--&gt; Restarting Dependency Resolution with new changes.
</span></span><span style=display:flex><span>--&gt; Populating transaction set with selected packages. Please wait.
</span></span><span style=display:flex><span>---&gt; Package glibc.i686 0:2.5-123 set to be updated
</span></span><span style=display:flex><span>--&gt; Running transaction check
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span>Dependencies Resolved
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span>=============================================================================
</span></span><span style=display:flex><span> Package                 Arch       Version          Repository        Size
</span></span><span style=display:flex><span>=============================================================================
</span></span><span style=display:flex><span>Updating:
</span></span><span style=display:flex><span> hwdata                  noarch     0.213.30-1.el5   cdrom             477 k
</span></span><span style=display:flex><span>Updating for dependencies:
</span></span><span style=display:flex><span> glibc                   x86_64     2.5-123          cdrom             4.8 M
</span></span><span style=display:flex><span> glibc                   i686       2.5-123          cdrom             5.4 M
</span></span><span style=display:flex><span> glibc-common            x86_64     2.5-123          cdrom              16 M
</span></span><span style=display:flex><span> module-init-tools       x86_64     3.3-0.pre3.1.63.el5  cdrom             446 k
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span>Transaction Summary
</span></span><span style=display:flex><span>=============================================================================
</span></span><span style=display:flex><span>Install      0 Package(s)
</span></span><span style=display:flex><span>Update       5 Package(s)
</span></span><span style=display:flex><span>Remove       0 Package(s)
</span></span><span style=display:flex><span>Total download size: 28 M
</span></span><span style=display:flex><span>Is this ok [y/N]: y
</span></span><span style=display:flex><span>Downloading Packages:
</span></span><span style=display:flex><span>Running Transaction Test
</span></span><span style=display:flex><span>Finished Transaction Test
</span></span><span style=display:flex><span>Transaction Test Succeeded
</span></span><span style=display:flex><span>Running Transaction
</span></span><span style=display:flex><span>  Updating  : glibc-common                 ####################### [ 1/10]
</span></span><span style=display:flex><span>  Updating  : glibc                        ####################### [ 2/10]
</span></span><span style=display:flex><span>  Updating  : glibc                                                [ 3/10]warning: /etc/localtime created as /etc/localtime.rpmnew
</span></span><span style=display:flex><span>  Updating  : glibc                                                [ 3/10]warning: /etc/nsswitch.conf created as /etc/nsswitch.conf.rpmnew
</span></span><span style=display:flex><span>  Updating  : glibc                        ####################### [ 3/10]
</span></span><span style=display:flex><span>  Updating  : module-init-tools            ####################### [ 4/10]
</span></span><span style=display:flex><span>  Updating  : hwdata                       ####################### [ 5/10]
</span></span><span style=display:flex><span>  Cleanup   : glibc                        ####################### [ 6/10]
</span></span><span style=display:flex><span>  Cleanup   : module-init-tools            ####################### [ 7/10]
</span></span><span style=display:flex><span>  Cleanup   : glibc-common                 ####################### [ 8/10]
</span></span><span style=display:flex><span>  Cleanup   : glibc                        ####################### [ 9/10]
</span></span><span style=display:flex><span>  Cleanup   : hwdata                       ####################### [10/10]
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span>Updated: hwdata.noarch 0:0.213.30-1.el5
</span></span><span style=display:flex><span>Dependency Updated: glibc.x86_64 0:2.5-123 glibc.i686 0:2.5-123 glibc-common.x86_64 0:2.5-123 module-init-tools.x86_64 0:3.3-0.pre3.1.63.el5
</span></span><span style=display:flex><span>Complete!
</span></span></code></pre></div><p>First packages updated using <code>yum</code>!!</p><p>Now, we&rsquo;re hitting several issues with kernel being incompatible&mldr; so let&rsquo;s remove it but just from the database (as well as other packages):</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>rpm -e kernel --nodeps --justdb --noscripts
</span></span><span style=display:flex><span>rpm -e python-elementtree util-linux yum initscripts glib2  procps --justdb  --noscripts
</span></span><span style=display:flex><span>rpm -e system-config-securitylevel
</span></span></code></pre></div><p>After those steps&mldr; that again&mldr; are critical we can start updating some more packages:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>yum -y install yum hal initscripts
</span></span></code></pre></div><p>After it finishes, we can try again to update yum:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-console data-lang=console><span style=display:flex><span>[root@rhel-instance ~]# yum install yum
</span></span><span style=display:flex><span>There was a problem importing one of the Python modules
</span></span><span style=display:flex><span>required to run yum. The error leading to this problem was:
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span>   No module named urlgrabber
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span>Please install a package which provides this module, or
</span></span><span style=display:flex><span>verify that the module is installed correctly.
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span>It&#39;s possible that the above module doesn&#39;t match the
</span></span><span style=display:flex><span>current version of Python, which is:
</span></span><span style=display:flex><span>2.4.3 (#1, Oct 23 2012, 22:02:41)
</span></span><span style=display:flex><span>[GCC 4.1.2 20080704 (Red Hat 4.1.2-54)]
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span>If you cannot solve this problem yourself, please go to
</span></span><span style=display:flex><span>the yum faq at:
</span></span><span style=display:flex><span>  http://wiki.linux.duke.edu/YumFaq
</span></span></code></pre></div><p>And BAM!, it fails&mldr; let&rsquo;s check RPM for yum:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-console data-lang=console><span style=display:flex><span>[root@rhel-instance ~]# rpm -q yum
</span></span><span style=display:flex><span>rpmdb: Program version 4.3 doesn&#39;t match environment version
</span></span><span style=display:flex><span>error: db4 error(-30974) from dbenv-&gt;open: DB_VERSION_MISMATCH: Database environment version mismatch
</span></span><span style=display:flex><span>error: cannot open Packages index using db3 -  (-30974)
</span></span><span style=display:flex><span>error: cannot open Packages database in /var/lib/rpm
</span></span><span style=display:flex><span>package yum is not installed
</span></span></code></pre></div><p>BAM!, rpm can&rsquo;t find the packages&mldr;</p><p>Let&rsquo;s remove the old database of <code>rpm</code>:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>rm -fv /var/lib/rpm/__db*
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-console data-lang=console><span style=display:flex><span>[root@rhel-instance ~]# cd /var/lib/rpm/
</span></span><span style=display:flex><span>[root@rhel-instance rpm]# ls
</span></span><span style=display:flex><span>Basenames     __db.000  __db.002  Dirnames  Group       Name      Providename     Pubkeys      Requireversion  Sigmd5
</span></span><span style=display:flex><span>Conflictname  __db.001  __db.003  Filemd5s  Installtid  Packages  Provideversion  Requirename  Sha1header      Triggername
</span></span><span style=display:flex><span>[root@rhel-instance rpm]# ls -l
</span></span><span style=display:flex><span>total 19800
</span></span><span style=display:flex><span>-rw-r--r--  1 root root  1445888 Mar 25 21:58 Basenames
</span></span><span style=display:flex><span>-rw-r--r--  1 root root    12288 Mar 25 21:58 Conflictname
</span></span><span style=display:flex><span>-rw-r--r--  1 root root        0 Mar 25 22:00 __db.000
</span></span><span style=display:flex><span>-rw-r--r--  1 root root    16384 Mar 25 20:02 __db.001
</span></span><span style=display:flex><span>-rw-r--r--  1 root root  1318912 Mar 25 20:02 __db.002
</span></span><span style=display:flex><span>-rw-r--r--  1 root root   663552 Mar 25 20:02 __db.003
</span></span><span style=display:flex><span>-rw-r--r--  1 root root   352256 Mar 25 21:58 Dirnames
</span></span><span style=display:flex><span>-rw-r--r--  1 root root  2613248 Mar 25 21:58 Filemd5s
</span></span><span style=display:flex><span>-rw-r--r--  1 root root    12288 Mar 25 21:58 Group
</span></span><span style=display:flex><span>-rw-r--r--  1 root root    16384 Mar 25 21:58 Installtid
</span></span><span style=display:flex><span>-rw-r--r--  1 root root    24576 Mar 25 21:58 Name
</span></span><span style=display:flex><span>-rw-r--r--  1 root root 14315520 Mar 25 21:58 Packages
</span></span><span style=display:flex><span>-rw-r--r--  1 root root   180224 Mar 25 21:58 Providename
</span></span><span style=display:flex><span>-rw-r--r--  1 root root    65536 Mar 25 21:58 Provideversion
</span></span><span style=display:flex><span>-rw-r--r--  1 root root    12288 Mar 25 21:57 Pubkeys
</span></span><span style=display:flex><span>-rw-r--r--  1 root root   188416 Mar 25 21:58 Requirename
</span></span><span style=display:flex><span>-rw-r--r--  1 root root   102400 Mar 25 21:58 Requireversion
</span></span><span style=display:flex><span>-rw-r--r--  1 root root    45056 Mar 25 21:58 Sha1header
</span></span><span style=display:flex><span>-rw-r--r--  1 root root    45056 Mar 25 21:58 Sigmd5
</span></span><span style=display:flex><span>-rw-r--r--  1 root root    12288 Mar 25 21:58 Triggername
</span></span><span style=display:flex><span>[root@rhel-instance rpm]# rm -fv __db.00*
</span></span><span style=display:flex><span>removed `__db.000&#39;
</span></span><span style=display:flex><span>removed `__db.001&#39;
</span></span><span style=display:flex><span>removed `__db.002&#39;
</span></span><span style=display:flex><span>removed `__db.003&#39;
</span></span><span style=display:flex><span>[root@rhel-instance rpm]# rpm -q yum
</span></span><span style=display:flex><span>yum-3.2.22-40.el5
</span></span></code></pre></div><p>Now, as you can see, we&rsquo;ve yum again :-) (but it still doesn&rsquo;t work)&mldr;</p><p>Let&rsquo;s manually install the missing libraries:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>rpm -Uvh python-urlgrabber-3.1.0-6.el5.noarch.rpm m2crypto-0.16-9.el5.x86_64.rpm
</span></span></code></pre></div><p>Next one failing after this&mldr; is <code>sqlite</code>&mldr;</p><p>Let&rsquo;s reinstall it:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>rpm -Uvh --force python-sqlite-1.1.7-1.2.1.x86_64.rpm
</span></span></code></pre></div><p>After this step, <code>yum</code> works again, so let&rsquo;s find next target for installation&mldr; but first let&rsquo;s install some more packages with <code>rpm</code>:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>rpm -Uvh rhn-client-tools-0.4.20.1-9.el5.noarch.rpm python-dmidecode-3.10.13-1.el5_5.1.x86_64.rpm rhn-check-0.4.20.1-9.el5.noarch.rpm rhn-setup-0.4.20.1-9.el5.noarch.rpm rhnsd-4.7.0-14.el5.x86_64.rpm yum-rhn-plugin-0.5.4.1-7.el5.noarch.rpm rhnlib-2.5.22.1-6.el5.noarch.rpm
</span></span></code></pre></div><p>Let&rsquo;s install some packages as well as some of the already installed ones&mldr;</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span><span style=color:#f92672>[</span>root@localhost Server<span style=color:#f92672>]</span><span style=color:#75715e># rpm -Uvh libpcap-0.9.4-15.el5.x86_64.rpm ppp-2.4.4-2.el5.x86_64.rpm   kernel-2.6.18-398.el5.x86_64.rpm  mkinitrd-5.1.19.6-82.el5.x86_64.rpm  procps-3.2.7-26.el5.x86_64.rpm  nash-5.1.19.6-82.el5.x86_64.rpm kpartx-0.4.7-63.el5.x86_64.rpm e2fsprogs-1.39-37.el5.x86_64.rpm device-mapper-multipath-0.4.7-63.el5.x86_64.rpm  selinux-policy-targeted-2.4.6-351.el5.noarch.rpm  hmaccalc-0.9.6-4.el5.x86_64.rpm   iscsi-initiator-utils-6.2.0.872-16.el5.x86_64.rpm  lksctp-tools-1.0.6-3.el5.x86_64.rpm  selinux-policy-targeted-2.4.6-351.el5.noarch.rpm  quota-3.13-8.el5.x86_64.rpm krb5-workstation-1.6.1-78.el5.x86_64.rpm  NetworkManager-0.7.0-13.el5.x86_64.rpm  parted-1.8.1-30.el5.x86_64.rpm util-linux-2.13-0.59.el5_8.x86_64.rpm cryptsetup-luks-1.0.3-8.el5.x86_64.rpm openssh-server-4.3p2-82.el5.x86_64.rpm gtk2-2.10.4-30.el5.x86_64.rpm  gnupg-1.4.5-18.el5_10.1.x86_64.rpm  e2fsprogs-libs-1.39-37.el5.x86_64.rpm  isdn4k-utils-3.2-56.el5.x86_64.rpm  libsysfs-2.1.0-1.el5.x86_64.rpm  policycoreutils-1.33.12-14.13.el5.x86_64.rpm selinux-policy-2.4.6-351.el5.noarch.rpm  audit-libs-python-1.8-2.el5.x86_64.rpm libselinux-python-1.33.4-5.7.el5.x86_64.rpm libsemanage-1.9.1-4.4.el5.x86_64.rpm  --force</span>
</span></span></code></pre></div><p>Let&rsquo;s get remove some other conflict packages&mldr;</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span><span style=color:#f92672>[</span>root@localhost Server<span style=color:#f92672>]</span><span style=color:#75715e># rpm -Uvh gettext-0.17-1.el5.x86_64.rpm libgomp-4.4.7-1.el5.x86_64.rpm</span>
</span></span></code></pre></div><p>For Updating the <code>filesystem</code> package we need to make a trick&mldr; find the file on the <code>/mnt</code> folder&mldr; copy it over to <code>/root</code> and umount the CD-ROM</p><p>Then install it from the root folder:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>rpm -Uvh filesystem.rpm
</span></span></code></pre></div><p>Once finished, remount the CD-ROM and let&rsquo;s continue with some other dependencies:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>rpm -Uvh openib-1.5.4.1-4.el5.noarch.rpm pycairo-1.2.0-1.1.x86_64.rpm
</span></span><span style=display:flex><span>rpm -Uvh gnome-python2-canvas-2.16.0-1.fc6.x86_64.rpm yelp-2.16.0-30.el5_9.x86_64.rpm firstboot-1.4.27.9-1.el5.x86_64.rpm rhpxl-0.41.1-12.el5.x86_64.rpm metacity-2.16.0-16.el5.x86_64.rpm gnome-python2-2.16.0-1.fc6.x86_64.rpm gnome-doc-utils-0.8.0-2.fc6.noarch.rpm scrollkeeper-0.3.14-9.el5.x86_64.rpm firstboot-tui-1.4.27.9-1.el5.x86_64.rpm system-config-display-1.0.48-4.el5.noarch.rpm system-config-network-1.3.99.23-1.el5.noarch.rpm redhat-artwork-5.0.9-2.el5.x86_64.rpm docbook-dtds-1.0-30.1.noarch.rpm xorg-x11-fonts-Type1-7.1-2.1.el5.noarch.rpm pkgconfig-0.21-2.el5.x86_64.rpm system-config-soundcard-2.0.6-1.el5.noarch.rpm alsa-utils-1.0.17-7.el5.x86_64.rpm xml-common-0.6.3-18.noarch.rpm openjade-1.3.2-27.x86_64.rpm redhat-menus-6.7.8-3.el5.noarch.rpm redhat-logos-4.9.16-1.noarch.rpm sgml-common-0.6.3-18.noarch.rpm xorg-x11-server-Xorg-1.1.1-48.101.el5_10.3.x86_64.rpm system-config-securitylevel-tui-1.6.29.1-6.el5.x86_64.rpm xorg-x11-utils-7.1-2.fc6.x86_64.rpm xorg-x11-server-utils-7.1-5.el5_6.2.x86_64.rpm xorg-x11-drv-vesa-1.3.0-8.3.el5.x86_64.rpm xorg-x11-drv-void-1.1.0-3.1.x86_64.rpm xorg-x11-drv-evdev-1.0.0.5-5.el5.x86_64.rpm xorg-x11-drv-mouse-1.1.1-1.1.x86_64.rpm cpp-4.1.2-55.el5.x86_64.rpm gtk2-engines-2.8.0-3.el5.x86_64.rpm gnome-python2-2.16.0-1.fc6.x86_64.rpm gnome-python2-bonobo-2.16.0-1.fc6.x86_64.rpm pyxf86config-0.3.31-3.el5.x86_64.rpm system-config-securitylevel-1.6.29.1-6.el5.x86_64.rpm xorg-x11-drv-keyboard-1.1.0-3.x86_64.rpm xorg-x11-fonts-base-7.1-2.1.el5.noarch.rpm gnome-python2-gnomevfs-2.16.0-1.fc6.x86_64.rpm --nodeps
</span></span></code></pre></div><p>Let&rsquo;s install some more missing dependencies with <code>rpm</code>:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>rpm -Uvh python-numeric-23.7-2.2.2.el5_6.1.x86_64.rpm pygobject2-2.12.1-5.el5.x86_64.rpm
</span></span></code></pre></div><p>And let&rsquo;s attempt freshen of all the remaining packages:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>rpm -Fvh *.rpm
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Let&#39;s also install createrepo... we&#39;ll need it later</span>
</span></span><span style=display:flex><span>rpm -ivh createrepo*.rpm
</span></span></code></pre></div><p>After this&mldr; only a few packages are missing to upgrade, yum is still not working as it complains with some problems with the rpm database, so we need to continue with <code>rpm</code>:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>rpm -Uvh kexec-tools-1.102pre-165.el5.x86_64.rpm  busybox-1.2.0-14.el5.x86_64.rpm mesa-libGL-6.5.1-7.11.el5_9.x86_64.rpm  libdrm-2.0.2-1.1.x86_64.rpm
</span></span><span style=display:flex><span>rpm -Uvh mlocate-0.15-1.el5.2.x86_64.rpm redhat-release-notes-5Server-52.x86_64.rpm tzdata-2014e-1.el5.x86_64.rpm
</span></span></code></pre></div><p>Here, <code>yum</code> now reports that no packages are missing to update&mldr; so let&rsquo;s attempt to reboot the system and cross fingers..</p><p>If the system rebooted, make sure it shows the right kernel for EL5&mldr; <code>2.6.9</code> is a bad value&mldr; it should read <code>2.6.18</code>&mldr; if you&rsquo;re in that case, once the system boots, mount the CD-ROM again, and force kernel reinstallation via:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>rpm -ivh --force /mnt/Server/kernel-2.6.18-398.el5.x86_64.rpm
</span></span></code></pre></div><p>And reboot again.</p><p><img loading=lazy src=../../../../../blog/2022/04/23/unsupported-upgrade-for-rhel-based-distributions-without-reinstallation/rhel5login.png></p><h2 id=rhel5-to-rhel6-upgrade>RHEL5 to RHEL6 upgrade<a hidden class=anchor aria-hidden=true href=#rhel5-to-rhel6-upgrade>#</a></h2><p>Wow, now we&rsquo;re on RHEL5, yum is already native in this version, so that we can update the <code>cdrom.repo</code> file to point to the root of the mount point instead of the <code>Server</code> folder, then run <code>yum update</code> and&mldr; BAM!, incompatible hash for the repository&mldr;</p><p>As we installed <code>createrepo</code> before we can <code>cd</code> into our home folder and run:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span><span style=color:#f92672>[</span>root@localhost ~<span style=color:#f92672>]</span><span style=color:#75715e># cd</span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>root@localhost ~<span style=color:#f92672>]</span><span style=color:#75715e># mkdir el6</span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>root@localhost ~<span style=color:#f92672>]</span><span style=color:#75715e># for file in /mnt/Packages/*.rpm; do ln -s $file . ;done</span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>root@localhost ~<span style=color:#f92672>]</span><span style=color:#75715e># createrepo  -o el6 -u file:///mnt/Packages/  /mnt/Packages/</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>3861/3861 - zsh-4.3.11-8.el6.x86_64.rpm
</span></span><span style=display:flex><span>Saving Primary metadata
</span></span><span style=display:flex><span>Saving file lists metadata
</span></span><span style=display:flex><span>Saving other metadata
</span></span></code></pre></div><p>Once this is done, we need to update our <code>cdrom.repo</code> file to point to the location <code>file:///root/el6</code> ;-)</p><p>Let&rsquo;s start again&mldr; removing some packages:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>yum remove system-config-* kudzu rhnlib python-numeric rhpl avahi ipsec-tools OpenIPMI authconfig
</span></span><span style=display:flex><span>yum remove xorg-x11-server-utils  xorg-x11-server-Xorg  xorg-x11-utils  xorg-x11-fonts-base  xorg-x11-fonts-Type1  openjade
</span></span><span style=display:flex><span>rpm -e sudo-1.6.7p5-30.1.5.x86_64 --justdb
</span></span><span style=display:flex><span><span style=color:#75715e># (as package-cleanup --dupes was showing it)</span>
</span></span><span style=display:flex><span>yum remove OpenIPMI-libs-2.0.16-16.el5.x86_64 bluez-hcidump-1.32-1.x86_64
</span></span><span style=display:flex><span>rpm -e libnotify-0.4.2-6.el5.x86_64 net-snmp-libs-5.3.2.2-22.el5_10.1.x86_64 libbonobo-2.16.0-1.1.el5_5.1.x86_64 libibcommon-1.2.0-1.el5.x86_64 libsdp-1.1.108-1.el5.x86_64 bluez-libs-3.7-1.1.x86_64 glib-1.2.10-20.el5.x86_64 libmthca-1.0.6-1.el5.x86_64 compat-libstdc++-33-3.2.3-61.x86_64 libgnomecanvas-2.14.0-4.1.x86_64 libart_lgpl-2.3.17-4.x86_64
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span><span style=color:#75715e># Remove packages that are not from x86_64 (it used to be required in older ones, but not any longer.)</span>
</span></span><span style=display:flex><span>uname -a |grep x86_64 <span style=color:#f92672>&amp;&amp;</span> yum remove *.i<span style=color:#f92672>{</span>3,4,5,6<span style=color:#f92672>}</span><span style=color:#ae81ff>86</span>
</span></span></code></pre></div><p>Ok, so we&rsquo;re back on having issues with rpm features that we don&rsquo;t have at EL5&mldr; so we need to update rpm and required components so that we can continue installing newer packages.</p><p>This approach brings us to the egg-chicken issue&mldr; we can&rsquo;t install the packages because our installed version is old, and until we update them, we can&rsquo;t install the other updates&mldr; and even <code>cpio</code> is older than the version used, so we might need to use an intermediate machine to uncompress the rpm related packages copy them over, and use them to install the updates on the system itself.</p><p>We need to prepare and uncompress the following files from the install media on a newer machine</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>PACKAGES<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;db4-4.7.25-16.el6.x86_64.rpm glibc-2.12-1.7.el6.x86_64.rpm glibc-common-2.12-1.7.el6.x86_64.rpm glibc-utils-2.12-1.7.el6.x86_64.rpm libcap-2.16-5.2.el6.x86_64.rpm lua-5.1.4-4.1.el6.x86_64.rpm popt-1.13-7.el6.x86_64.rpm rpm-4.8.0-12.el6.x86_64.rpm rpm-build-4.8.0-12.el6.x86_64.rpm rpm-libs-4.8.0-12.el6.x86_64.rpm rpm-python-4.8.0-12.el6.x86_64.rpm xz-libs-4.999.9-0.3.beta.20091007git.el6.x86_64.rpm&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> package in $PACKAGES;<span style=color:#66d9ef>do</span>
</span></span><span style=display:flex><span>  echo <span style=color:#e6db74>&#34;Uncompressing </span>$package<span style=color:#e6db74>&#34;</span>
</span></span><span style=display:flex><span>  rpm2cpio /mnt/Packages/$package | cpio -idmv
</span></span><span style=display:flex><span><span style=color:#66d9ef>done</span>
</span></span></code></pre></div><p>Once the process has finished, you&rsquo;ll get a list of folders that need to be
copied back to the host&mldr; note, this will overwrite libraries, binaries
and can render your system unusable.</p><p>Once that step is done&mldr; your system should have RPM version 4.8.0 and you
can use it to install and force install several set of packages&mldr; until
you can get yum working again&mldr;</p><p>In this case, yum provided in EL6, features the <code>distro-sync</code> command, which
is a simple way to update the system to the latest available packages in our
local repository.</p><p>Yum might complain of some missing packages.. ensure to get yum packages
installed, as well as expat, SSL and some other dependencies that will
complain.</p><p>Once YUM is working and distro-sync has finished, we need to edit the
<code>cdrom.repo</code> to act against the folder with the packages (so that it has the
group information), perform a <code>yum clean</code> and then <code>yum groupinstall base</code>
so that all the missing packages from a base system are installed..
resolving conflicts like the <code>redhat-release-notes</code> etc by manually removing
and then adding the new versions of the files.</p><p>Ensure also to remove all packages named <code>.el5.</code> from our system&mldr; we
should be on <code>el6</code> now&mldr;</p><p><img loading=lazy src=../../../../../blog/2022/04/23/unsupported-upgrade-for-rhel-based-distributions-without-reinstallation/rhel6login.png></p><p>And our system is ready for next step!</p><h2 id=rhel6-to-rhel7-upgrade>RHEL6 to RHEL7 upgrade<a hidden class=anchor aria-hidden=true href=#rhel6-to-rhel7-upgrade>#</a></h2><p>Well, we got until this point, so we&rsquo;re back into the versions that are
&lsquo;supported&rsquo; under the ELS.</p><p>Let&rsquo;s follow the standard approach to register our system and attach to a pool:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>yum -y install subscription-manager
</span></span><span style=display:flex><span>subscription-manager  register
</span></span><span style=display:flex><span>subscription-manager attach pool<span style=color:#f92672>=</span>XXXXXXX
</span></span></code></pre></div><p>Then, let&rsquo;s add extra repositories we might require:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>subscription-manager repos --enable rhel-6-server-extras-rpms
</span></span><span style=display:flex><span>subscription-manager repos --enable rhel-6-server-optional-rpms
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># And then, let&#39;s install preupgrade tools</span>
</span></span><span style=display:flex><span>yum install preupgrade-assistant preupgrade-assistant-el6toel7 redhat-upgrade-tool
</span></span></code></pre></div><p>Check for the next steps in the official documentation:</p><p><a href=https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/7/html-single/upgrading_from_rhel_6_to_rhel_7/index>https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/7/html-single/upgrading_from_rhel_6_to_rhel_7/index</a></p><p>Enjoy! (and if you do, you can
<a href=https://ko-fi.com/I2I4KDA0V target=_blank><img src=https://storage.ko-fi.com/cdn/brandasset/kofi_s_logo_nolabel.png height=36 style=border:0;height:36px;vertical-align:middle;display:inline-block border=0>
</img>
Buy Me a Coffee
</a>)</p><div class=footnotes role=doc-endnotes><hr><ol><li id=fn:1><p><code>tmux</code> or <code>screen</code> allows to disconnect, re-attach or even open new terminals without having to open a new ssh connection, this makes it a lot easier to spawn a new shell and operate without risking a disconnection from our system.&#160;<a href=#fnref:1 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li></ol></div></div><footer class=post-footer><ul class=post-tags><li><a href=https://iranzo.io/tags/linux/>Linux</a></li><li><a href=https://iranzo.io/tags/foss/>FOSS</a></li><li><a href=https://iranzo.io/tags/centos/>CentOS</a></li><li><a href=https://iranzo.io/tags/rhel/>RHEL</a></li><li><a href=https://iranzo.io/tags/red-hat-enterprise-linux/>Red Hat Enterprise Linux</a></li><li><a href=https://iranzo.io/tags/almalinux/>AlmaLinux</a></li><li><a href=https://iranzo.io/tags/oracle-linux/>Oracle Linux</a></li><li><a href=https://iranzo.io/tags/rocky-linux/>Rocky Linux</a></li></ul><nav class=paginav><a class=prev href=https://iranzo.io/blog/2022/05/26/lego-volkswagen-t2/><span class=title>« Prev</span><br><span>Lego Volkswagen T2</span>
</a><a class=next href=https://iranzo.io/blog/2022/04/10/lego-the-skywalker-saga-codes/><span class=title>Next »</span><br><span>Lego The SkyWalker Saga Codes</span></a></nav><ul class=share-buttons><li><a target=_blank rel="noopener noreferrer" aria-label="share Unsupported upgrade for RHEL-based distributions without reinstallation on x" href="https://x.com/intent/tweet/?text=Unsupported%20upgrade%20for%20RHEL-based%20distributions%20without%20reinstallation&amp;url=https%3a%2f%2firanzo.io%2fblog%2f2022%2f04%2f23%2funsupported-upgrade-for-rhel-based-distributions-without-reinstallation%2f&amp;hashtags=Linux%2cFOSS%2cCentOS%2cRHEL%2cRedHatEnterpriseLinux%2cAlmaLinux%2cOracleLinux%2cRockyLinux"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M512 62.554V449.446C512 483.97 483.97 512 449.446 512H62.554C28.03 512 0 483.97.0 449.446V62.554C0 28.03 28.029.0 62.554.0H449.446C483.971.0 512 28.03 512 62.554zM269.951 190.75 182.567 75.216H56L207.216 272.95 63.9 436.783h61.366L235.9 310.383l96.667 126.4H456L298.367 228.367l134-153.151H371.033zM127.633 110h36.468l219.38 290.065H349.5z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Unsupported upgrade for RHEL-based distributions without reinstallation on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2firanzo.io%2fblog%2f2022%2f04%2f23%2funsupported-upgrade-for-rhel-based-distributions-without-reinstallation%2f&amp;title=Unsupported%20upgrade%20for%20RHEL-based%20distributions%20without%20reinstallation&amp;summary=Unsupported%20upgrade%20for%20RHEL-based%20distributions%20without%20reinstallation&amp;source=https%3a%2f%2firanzo.io%2fblog%2f2022%2f04%2f23%2funsupported-upgrade-for-rhel-based-distributions-without-reinstallation%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Unsupported upgrade for RHEL-based distributions without reinstallation on reddit" href="https://reddit.com/submit?url=https%3a%2f%2firanzo.io%2fblog%2f2022%2f04%2f23%2funsupported-upgrade-for-rhel-based-distributions-without-reinstallation%2f&title=Unsupported%20upgrade%20for%20RHEL-based%20distributions%20without%20reinstallation"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Unsupported upgrade for RHEL-based distributions without reinstallation on facebook" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2firanzo.io%2fblog%2f2022%2f04%2f23%2funsupported-upgrade-for-rhel-based-distributions-without-reinstallation%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Unsupported upgrade for RHEL-based distributions without reinstallation on whatsapp" href="https://api.whatsapp.com/send?text=Unsupported%20upgrade%20for%20RHEL-based%20distributions%20without%20reinstallation%20-%20https%3a%2f%2firanzo.io%2fblog%2f2022%2f04%2f23%2funsupported-upgrade-for-rhel-based-distributions-without-reinstallation%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Unsupported upgrade for RHEL-based distributions without reinstallation on telegram" href="https://telegram.me/share/url?text=Unsupported%20upgrade%20for%20RHEL-based%20distributions%20without%20reinstallation&amp;url=https%3a%2f%2firanzo.io%2fblog%2f2022%2f04%2f23%2funsupported-upgrade-for-rhel-based-distributions-without-reinstallation%2f"><svg viewBox="2 2 28 28" height="30" width="30" fill="currentcolor"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Unsupported upgrade for RHEL-based distributions without reinstallation on ycombinator" href="https://news.ycombinator.com/submitlink?t=Unsupported%20upgrade%20for%20RHEL-based%20distributions%20without%20reinstallation&u=https%3a%2f%2firanzo.io%2fblog%2f2022%2f04%2f23%2funsupported-upgrade-for-rhel-based-distributions-without-reinstallation%2f"><svg width="30" height="30" viewBox="0 0 512 512" fill="currentcolor" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape"><path d="M449.446.0C483.971.0 512 28.03 512 62.554V449.446C512 483.97 483.97 512 449.446 512H62.554C28.03 512 0 483.97.0 449.446V62.554C0 28.03 28.029.0 62.554.0H449.446zM183.8767 87.9921h-62.034L230.6673 292.4508V424.0079h50.6655V292.4508L390.1575 87.9921H328.1233L256 238.2489z"/></svg></a></li></ul></footer></article></main><footer class=footer><span>&copy; 2025 <a href=https://iranzo.io/>Pablo Iranzo Gómez blog</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><center><small>This blog is a participant in the Amazon Associate Program, an affiliate advertising program designed to provide a means for sites to earn advertising fees by advertising and linking to Amazon.</small></center><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>