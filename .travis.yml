# Copyright (C) 2017, 2018 Pablo Iranzo GÃ³mez <Pablo.Iranzo@gmail.com>

language: python
dist: trusty
sudo: required

python:
- '3.5'

before_install:
- sudo apt-get -y install pandoc
- wget -O /tmp/pandoc.deb https://github.com/jgm/pandoc/releases/download/2.5/pandoc-2.5-1-amd64.deb
- sudo dpkg -i /tmp/pandoc.deb
- pip install -U pip
- pip install -U setuptools
- pip install -r requirements.txt
- peru sync

script:
- make html
- make publish

after_success:
- cp README.md output/
- mv *.png output/
- sed -i "s#https://github.com#https://${GHTOKEN}@github.com#g" .git/config
- sed -i "s#git@github.com:#https://${GHTOKEN}@github.com/#g" .git/config
- make github
