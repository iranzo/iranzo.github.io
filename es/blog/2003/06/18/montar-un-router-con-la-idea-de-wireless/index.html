<!doctype html><html lang=es dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Montar un router con la idea de wireless | Pablo Iranzo Gómez blog</title>
<meta name=keywords content="linux,wireless,router,firewall,foss"><meta name=description content="Introducción
Un nodo nos permitirá unir a personas conectadas desde sus tarjetas inalámbricas. Un nodo tiene que ser el punto de unión entre distintos clientes y a su vez enlazar con otros nodos para así crear una red.
En el caso de las redes inalámbricas, existen varias aproximaciones.
Un nodo puede ser un aparato denominado Punto de Acceso o por sus siglas en inglés AP (Access Point) que contiene en su interior un interfaz wireless y una conexión Ethernet RJ45 para enlazarlo o bien con un equipo o con una red."><meta name=author content="Pablo Iranzo Gómez"><link rel=canonical href=https://iranzo.io/es/blog/2003/06/18/montar-un-router-con-la-idea-de-wireless/><meta name=google-site-verification content="Bk4Z5ucHLyPXqlZlj5LzANpYBBSvxqBW4E8i-Kwf-bQ"><meta name=yandex-verification content="993ede96cdfbee95"><link crossorigin=anonymous href=../../../../../../assets/css/stylesheet.css rel="preload stylesheet" as=style><link rel=icon href=https://iranzo.io/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://iranzo.io/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://iranzo.io/favicon-32x32.png><link rel=apple-touch-icon href=https://iranzo.io/apple-touch-icon.png><link rel=mask-icon href=https://iranzo.io/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=es href=https://iranzo.io/es/blog/2003/06/18/montar-un-router-con-la-idea-de-wireless/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script async src="https://www.googletagmanager.com/gtag/js?id=G-ZL9P943TP1"></script><script>var dnt,doNotTrack=!1;if(!1&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-ZL9P943TP1")}</script><meta property="og:url" content="https://iranzo.io/es/blog/2003/06/18/montar-un-router-con-la-idea-de-wireless/"><meta property="og:site_name" content="Pablo Iranzo Gómez blog"><meta property="og:title" content="Montar un router con la idea de wireless"><meta property="og:description" content="Introducción Un nodo nos permitirá unir a personas conectadas desde sus tarjetas inalámbricas. Un nodo tiene que ser el punto de unión entre distintos clientes y a su vez enlazar con otros nodos para así crear una red.
En el caso de las redes inalámbricas, existen varias aproximaciones.
Un nodo puede ser un aparato denominado Punto de Acceso o por sus siglas en inglés AP (Access Point) que contiene en su interior un interfaz wireless y una conexión Ethernet RJ45 para enlazarlo o bien con un equipo o con una red."><meta property="og:locale" content="es"><meta property="og:type" content="article"><meta property="article:section" content="blog"><meta property="article:published_time" content="2003-06-18T21:39:00+00:00"><meta property="article:modified_time" content="2023-08-25T09:45:44+00:00"><meta property="article:tag" content="Linux"><meta property="article:tag" content="Wireless"><meta property="article:tag" content="Router"><meta property="article:tag" content="Firewall"><meta property="article:tag" content="Foss"><meta property="og:image" content="https://iranzo.io/mugshot.png"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://iranzo.io/mugshot.png"><meta name=twitter:title content="Montar un router con la idea de wireless"><meta name=twitter:description content="Introducción
Un nodo nos permitirá unir a personas conectadas desde sus tarjetas inalámbricas. Un nodo tiene que ser el punto de unión entre distintos clientes y a su vez enlazar con otros nodos para así crear una red.
En el caso de las redes inalámbricas, existen varias aproximaciones.
Un nodo puede ser un aparato denominado Punto de Acceso o por sus siglas en inglés AP (Access Point) que contiene en su interior un interfaz wireless y una conexión Ethernet RJ45 para enlazarlo o bien con un equipo o con una red."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Blogs","item":"https://iranzo.io/es/blog/"},{"@type":"ListItem","position":2,"name":"Montar un router con la idea de wireless","item":"https://iranzo.io/es/blog/2003/06/18/montar-un-router-con-la-idea-de-wireless/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Montar un router con la idea de wireless","name":"Montar un router con la idea de wireless","description":"Introducción Un nodo nos permitirá unir a personas conectadas desde sus tarjetas inalámbricas. Un nodo tiene que ser el punto de unión entre distintos clientes y a su vez enlazar con otros nodos para así crear una red.\nEn el caso de las redes inalámbricas, existen varias aproximaciones.\nUn nodo puede ser un aparato denominado Punto de Acceso o por sus siglas en inglés AP (Access Point) que contiene en su interior un interfaz wireless y una conexión Ethernet RJ45 para enlazarlo o bien con un equipo o con una red.\n","keywords":["linux","wireless","router","firewall","foss"],"articleBody":"Introducción Un nodo nos permitirá unir a personas conectadas desde sus tarjetas inalámbricas. Un nodo tiene que ser el punto de unión entre distintos clientes y a su vez enlazar con otros nodos para así crear una red.\nEn el caso de las redes inalámbricas, existen varias aproximaciones.\nUn nodo puede ser un aparato denominado Punto de Acceso o por sus siglas en inglés AP (Access Point) que contiene en su interior un interfaz wireless y una conexión Ethernet RJ45 para enlazarlo o bien con un equipo o con una red.\nUn aparato que realice dichas funciones no es especialmente asequible además de que está bastante limitado…\nLa solución más aceptada es utilizar un PC para que haga de nodo, teniendo así muchísima más flexibilidad a la hora de configurarlo (más problemático también, no es “enchufar y listo” como con un AP de hardware).\nLas tarjetas a la venta en el mercado tienen tres modos de operación:\nAd-hoc: Es el modo estándar, en este tipo de modo de operación, es el equivalente a las redes con Windows en las que se trabaja de igual a igual, todos son clientes y servidores. Managed: un servidor independiente (un AP) es el lugar al que se conectan todas las demás tarjetas inalámbricas, el AP gestiona todas las conexiones, enrutados, etc. Master: Es el modo en el que trabaja el AP del punto anterior para que las tarjetas puedan trabajar como “Managed”. En redes con Windows sólo es posible trabajar en los dos primeros modos, el Ad-Hoc y el Managed, para ello, como se ve, es necesario un AP por hardware que trabaje como Master al que las tarjetas que trabajan en Managed se puedan conectar. Y este es el punto en el que Linux marca la diferencia… con Linux, existe un controlador (hostap) para las tarjetas basadas en Prism2 (p.ej. las Conceptronic). Con Linux y con esos controladores, es posible poner en modo Master las tarjetas de red (generalmente PCMCIA con un adaptador PCI para equipos de sobremesa) y de ese modo, hacer un AP por software.\nQuisiera expresar mi agradecimiento a Ghfjdksl de #wireless, a Jorti de #guadawireless y a Hilario y a Hawkmoon de #valenciawireless por la ayuda prestada para montar este nodo. Saludos también al resto de gente de #valenciawireless por sus larguísimas tertulias ;P\nHardware\nPara la creación del nodo, necesitaremos unos componentes de hardware tanto de software.\nEn la creación del nodo de La Creu Wireless, el hardware es el siguiente:\nPlaca AT Pentium 120 500 Mb HD 420 Mb HD (porque lo tenía a mano, pero posiblemente lo quite… lo que menos quiero es que el ordenador haga más ruido…) 64 mb Ram (iba a tener 16, pero a última hora conseguí más…) Tarjeta gráfica ATI Mach 64 Pro Turbo PCI Ethernet ISA P’n’P Intel PRO 10/10+ Ethernet PCI basada en Realtek 8029 (10 mbps) Ethernet PCI basada en Realtek 8139 (10/100) Ethernet ISA P’n’P Compatible con NE 2000 Tarjeta wireless todavía no la tengo, utilizo la ISA P’n’P compatible con NE2000 como si fuese la wireless (A la que en la actualidad tengo conectado un USR2450 en modo bridge con LinuxAP) Tarjeta de sonido SB 16 P’n’P (no se para qué porque no la tengo conectada ni nada, pero el caso es que como la tenía….) CD-ROM (instalé desde disco duro porque no tenía cd-rom en ese momento… pero bueno.. ahora sí ;)) RJ45 (latiguillos), uno directo para conectar al módem y a la eth0 y luego tres cruzados para conectar a cada uno de los pc’s sin necesidad de hub… si tienes hub, pues todos directos y listo… Se aceptan regalos ;) (Portátiles incluidos… ;) )\nVolviendo a la realidad… memoria le sobra por un tubo, pero bueno, puestos a ponerle, pues se le pone más :)\nDisco duro me gustaría ponerle más, ya que como lo tengo que tener encendido todo el día para que sea un nodo “fijo”, pues aprovechar y dejar las largas descargas bajándose en ese ordenador.\nLo de las tarjetas de red puede asustar al principio… pero bueno, tiene una clara explicación… en casa tengo dos ordenadores y ahora con el nodo tres, la conexión a Internet requiere otra tarjeta de red y no me permite compartirla directamente conectándola a un HUB, así que me parecía algo tonto el tener que gastarme dinero en un HUB cuando las tarjetas de red ya las tenía…\nAsí que el montaje de la falla es el siguiente:\nIntel Pro ISA 10/10+: eth0 conectada a mi conexión a Internet Realtek 8139 (10/100): eth1 conectada a mi equipo principal (también con otra tarjeta 10/100, así que red local a 100 MBps ;) ) Realtek 8029: eth2 conectada al otro pc que tengo en casa (también con una ethernet a 10 MBps) Isa P’n’P NE2000: eth3 hace las labores de wireless hasta que tenga una de verdad (la utilizo para conectar otro equipo y hacer las pruebas como si estuviese conectado por wireless), en su momento será utilizada para conexiones “temporales” por cable, siendo entonces eth4 la wireless “real”. Realmente con un HUB podría quitar dos tarjetas de red del ordenador (ya que el ordenador principal y el secundario irían conectados al hub y no serían necesarias las tarjetas correspondientes y sólo utilizaría la otra que quedase para Internet y la otra para conectar al HUB (si mi conexión me permitiese hacerlo, hasta podría conectar mi módem al HUB y ahorrarme otra tarjeta.. pero bueno, el caso es que no se puede…)\nComo se puede ver, no digo nada de ratón ni de monitor… el caso es que realmente no es necesario porque para hacer la instalación inicial se hará conectándolo a otro monitor, pero una vez puesto en marcha no hará falta para nada, de hecho hasta el teclado sobraría, pero como he dicho que es un P120 con AT, en los casos en los que tengo que apagar o reiniciar la máquina necesito algo que no implique un reset total (o sea, necesito tres teclas: CTRL-ALT-SUPR).\nEl teclado que tengo es uno de 84 teclas que será como un teclado normal pero sin el bloque numérico y sin el bloque de av-pag, etc de tamaño, tiene sólo dos leds, Bloq may y bloq despl, pero lo dicho… sobra ;)\nAhora el ordenador es un P200 MMX con 128 Mb de RAM, las tarjetas son una Intel Pro ISA 10/10+, una SMC 100, 3Com 3c509 y NE2000, discos tiene uno de 10 Gb, y otro de 20, configurados como:\n128 Mb Swap 10 Mb boot 3 Gb sistema, usuarios Resto = 26 Gb para descargas diversas… (pero con ánimo educativo, no os vayais a pensar…) Ahora vamos a la configuración del software…\nSistema Operativo y Paquetes El primer paso previo a todos, es que una vez configurado el hardware para que no se queje (IRQ’s, puertos IO, etc) (si la placa es realmente P’n’P no habrá problemas pero la mía aunque es P’n’P dio algunos problemas así que… ajo y agua…) Si has de comprar tarjetas y puedes, cómpralas PCI y mejor todavía si compras un HUB porque así no tienes que tener el ordenador rellenito en todas sus ranuras con ethernets ;).\nLo primero a configurar entonces es la BIOS.\nComo cada BIOS es de un papá y de una mamá distintos (aunque a veces la mamá sea siempre Award o Ami), daré la explicación general y que cada uno se las apañe con el manual de su placa base para hacer lo que digo…\nPD: Si no sabes lo que es la BIOS, olvídate de seguir… esto no está hecho para tí… Mucho mejor que veas esto.\nConfigura las tarjetas en el orden que quieras, pero ten bien claro cuál será cada una (si son todas iguales pues será más problemático, pero no por ello imposible).\nPrimero pon el ordenador en fecha y hora, y en la opción que pone “Halt on” ponle que nada, es decir, que bajo ningún concepto el ordenador no arranque (por ejemplo por falta de teclado, falta de monitor, etc porque al fin y al cabo luego no lo tendrá…)\nEn la BIOS dile que de PNP su tía… le dices que el sistema operativo no es P’N’P y que no se maree (puedes probar diciendo que sí, no debería ser muy tortuoso y si lo es, siempre lo puedes cambiar otra vez ;))\nComo dispositivo de arranque se le pondrá primero la disquetera, pero en el momento en que todo esté configurado, se pondrá fijo siempre el disco duro.\nSi la placa es ATX, dile que tras un corte de luz, que se encienda sola… así evitarás los tiempos de apagón del nodo al mínimo.\nSalva todos los cambios y reiniciará el ordenador… En mi caso, como no tenía en un primer momento ni disquetera ni cd-rom, aproveché que el disco duro contenía un Windows 95 y bajé la imagen de CD-ROM de instalación de Internet de Debian Potato, la convertí del .ISO a carpetas y directorios normales y la guardé por la red en el segundo HD del ordenador.\nLa imagen iso son unos 30 Mb y la descargué de la página de Debian. (woody_netinst-20020626-i386.iso)\nLa decisión de tomar “Debian” como sistema a instalar fue sencilla (lo de que tenía que ser Linux estaba cantado por lo explicado en la introducción):\nRed Hat Linux: Está muy bien, de hecho es con la que más experiencia tengo, la tengo funcionando desde el año 96 en un servidor y me va genial, poquitos problemas excepto actualizaciones, etc (aunque con las nuevas herramientas es muy fácil). Las actualizaciones, en el momento de lanzarlas, si hay muchos clientes de pago, pues a los que no pagamos, pues ajo y agua y a esperarse a que no esté tan saturado… el formato de Red Hat, el RPM es el estándar más extendido. (Se puede bajar de internet en versión libre, llamada Fedora Core, o bien en clónicas basadas en RHEL). SuSE Linux: Está muy bien, si compras la distribución, tienes muchos cd’s con programas, manuales, etc Bastante bien adaptada al Español (je, je), etc… Pero no se puede bajar la versión completa de internet porque tiene programas con licencias de distribución que no lo permiten, sólo si se compra. Utiliza el RPM que es un punto a favor, pero en contra es que no es compatible al 100% con las estructuras de directorios y funcionamientos de Red Hat, así que no hay forma de distinguir si ese RPM funcionará bien o no con SuSE. El peor inconveniente es la gran cantidad de recursos que necesita, tanto de RAM para la instalación como para el almacenamiento en disco (la mínima son unos 500 mb (pero mínima mínima mínima…)). La ventaja es que la configuración es toda en modo gráfico, con una autodetección genial, etc. Tenía experiencia con ella tanto de gastarla en casa como distribución Linux, en la uni en un servidor como de haber colaborado en su traducción de manuales y de software de configuración. Debian: No tenia ni puta idea de ella, una vez que la intenté instalar casi me da algo con el programa de selección de paquetes a instalar (dselect de la Potato). La instalación es en modo texto. Tiene un sistema de actualización/instalación bastante bueno en modo texto. la decisión fue usar Debian… de paso que aprendía a gastarla, al ser en modo texto, tenía el aliciente de que facilita su administración remota (recordemos que el ordenador una vez instalado mínimamente no iba a tener ni teclado ni ratón ni monitor ni naa de na… excepto el cable de la luz y cuatro cables RJ45 para las tarjetas de red :)) Vale, como ya he comentado, en el nodo, en el momento de su creación no tenía ni disquetera ni CD-ROM, así que se copiaron los archivos a una instalación de Windows 95, se reinicia en modo-MS-DOS y una vez en el, se cambia al directorio donde se extrajo la imagen de cd y se ejecuta el programa de instalación…\nSi tienes grabadora y cd-rom en el nodo pues lo más sencillo es bajar la iso, grabarla a un CD y arrancar desde el CD-ROM (en la bios se puede configurar esa opción).\nComo ya he dicho, la imagen de instalación es una NETINST, es decir, 30 mb mínimos que se utilizan para una vez respondidas unas preguntas copiar un sistema básico que se puede conectar a Internet y seguir bajando el resto de Internet… (Tengo una conexión a 128 kbps, así que que nadie me diga que es una locura porque es viable…)\nCuando yo hice la instalación, la netinst más habitual era la potato, pero hace nada que pasaron a Woody (3.0), el caso es que más o menos son parecidas y de hecho una vez instalé lo mínimo hice el cambio a Woody usando el programa que lleva para hacerlo…\nNo voy a explicar la instalación de Debian porque esto habla de configurar un nodo, no de instalar Linux, pero bueno, básicamente consistió en particionar el HD, crear una partición swap de 40 Mb (ya dije que mi disco duro era pequeñito..) y una de datos de 472 Mb como ext3 Es conveniente pensar un nombre para el nodo…la norma habitual, al menos en universidades, etc es ponerle nombres de estrellas o de científicos, pero bueno… Cada uno que le ponga el que le de la gana…\nSe configura el teclado, la tarjeta de red (como tengo Internet por tarjeta de cable fue tan sencillo como decirle que cargase los módulos de las tarjetas de red (en el caso de las ISA indicando también la IO) y luego en la que estaba conectada a Internet, decirle que hiciese configuración automática por DHCP y ya estaba la conexión funcionando…\nEn la selección de paquetes puse lo mínimo mínimo, así que al ratito y tras un rearranque, me pidió asignar contraseñas y crear un usuario (no es recomendable estar siempre como administrador para trabajar con Linux…)\nVale, llegados a este punto, tenemos ya el Linux instalado y tenemos delante la consola para iniciar sesión en el sistema. Vamos a necesitar varios programas además de los básicos para trabajar con el nodo… si nos gusta Linux, pues nos gustará instalar alguno más, pero bueno… por un lado están los básicos y los recomendados…\nComo lo que estoy haciendo es explicar la configuración de lo que yo hice con mi ordenador, pues allá vamos:\nPara la wireless hace falta el wavemon que es un monitor de estado de la tarjeta y el zebra para enrutar dinámicamente.\nEn mi caso, ya que ese ordenador iba a hacer de medio “servidor” en mi casa, pues me interesó ponerle:\nsamba: para compartir archivos e impresoras en un formato compatible con Windows y así poder luego bajar archivos de un ordenador a otro (del principal al nodo) mediante el entorno de red pptpd: para permitir conexiones VPN, permite que desde internet (o en este caso, desde la wireless), se pueda conectar con el nodo, y se asigne otra dirección IP que permita hacer otras cosas que de normal no se podría… En mi caso, tengo limite de descarga en Internet y aunque por el momento no lo apliquen no quita que pudieran hacerlo… causa pues de que no comparta mi acceso a Internet a no ser que conozca directamente al equipo que se conecta… es decir, una vez conectado mediante la wireless, hará una conexión VPN desde su Windows o su Linux al nodo y mediante un login y un pass tendrá acceso a Internet a través del nodo, que de otra forma no tendría…) (un nodo no tiene que necesariamente tener acceso a Internet, pero es recomendable para unir los nodos y facilitar la integración en la red, etc) webmin: es un programa hecho por caldera y que funciona en multitud de plataformas y distribuciones, permite muy fácilmente configurar desde un navegador muchísimas cosas del sistema. No digo que vaya a reemplazar a la configuración en modo consola, pero para muchas cosas es muchísimo más fácil hacerlo desde navegador que tener que entrar, etc… Otros paquetes instalados (muchos de ellos se instalan solitos como dependencias a los ya instalados…): A ver, en resumen, interesa instalar el ssh porque con el podremos entrar desde fuera al servidor, el webmin y los módulos listados arriba, etc\nLo dicho, esto es lo que yo tengo puesto… los paquetes se instalan poniendo:\napt-get install por ejemplo: apt-get install wavemon zebra webmin-stunnel webmin-status wget vtun\nAutomáticamente el programa se conectará a Internet y comenzará a bajar esos paquetes y todos los necesarios para que esos funcionen, es decir, si instalas webmin-status, para eso te hará falta primero el webmin y el programa lo instalará también solito tras pedir confirmación e indicar los megas a descargar y lo que ocupará una vez descomprimido.\nRed Vale, se supone que ahora ya tenemos el sistema funcionando y bueno… algo es algo :) ahora viene lo serio… configurarlo para que se adapte a nuestras necesidades…\nLo primero es tener un Kernel modernito (a mi con el estándar no me iba, pero como veréis en la lista de paquetes con el 2.4 funciona bastante bien el P’N’P)\nTenemos que por un lado configurar las tarjetas de red: Para eso, entramos en /etc/modutils como root y tendremos varios archivos de configuración, para ser representativo pondré el de una tarjeta ISA que son los más difíciles:\nContenido de : /etc/modutils/eepro\noptions eepro io=0x210 Como veréis es altamente jodidísimo configurar una tarjeta de red… sólo indicando el puerto de entrada salida Linux ya le busca la IRQ apropiada (en casos chungos, se le puede indicar también) Con el resto de tarjetas editaremos los ficheros para ver que está todo bien y los llamaremos con el nombre del módulo necesario (sale durante la instalación o en páginas de ayuda) Luego, editaremos el fichero /etc/modules y pondremos las tarjetas en el orden en el que queremos que se llamen:\n# /etc/modules: kernel modules to load at boot time. # # This file should contain the names of kernel modules that are # to be loaded at boot time, one per line. Comments begin with # a \"#\", and everything on the line after them are ignored. unix af_packet eepro tulip 3c59x ne sb Es decir, primero se cargará la EtherExpress Pro 10/10+ de Intel, que se llamará eth0 (tal como se explicó en el apartado de hardware), luego la 8139 (10/100) como eth2, luego la ne2000 PCI (RTL 8029), luego la Novel 2000 ISA y por último la SoundBlaster…\nEn el caso de haber dos tarjetas con el mismo controlador, se irán creando consecutivamente… es decir, si hay dos RTL8029, pues serán eth1 y eth2 y así el resto… en mi caso como cada una es distinta no tuve ese “problema”.\nTras editar ese fichero, tendremos que hacer que al siguiente arranque se tome esta configuración, así que ejecutaremos update-modules, para que el ordenador cree el /etc/modules.conf adecuado conforme a nuestros deseos., al siguiente arranque tendremos algo como:\nReal Time Clock Driver v1.10e id: 0xb4 \u003c7\u003e io: 0x210 \u003c6\u003eeth0: Intel EtherExpress Pro/10+ ISA at 0x210,\u003c6\u003e 00\u003c6\u003e:aa\u003c6\u003e:00\u003c6\u003e:c9\u003c6\u003e:9d\u003c6\u003e:1a\u003c6\u003e, IRQ 11, 10BaseT. eepro.c: v0.13 11/08/2001 aris@cathedrallabs.org 8139too Fast Ethernet driver 0.9.24 eth1: RealTek RTL8139 Fast Ethernet at 0xc486b000, 00:50:fc:4d:c7:d9, IRQ 9 eth1: Identified 8139 chip type ’RTL-8139C’ ne2k-pci.c:v1.02 10/19/2000 D. Becker/P. Gortmaker http://www.scyld.com/network/ne2k-pci.html eth2: RealTek RTL-8029 found at 0x6100, IRQ 9, 00:C0:DF:E3:46:F9. isapnp: Scanning for PnP cards... isapnp: Calling quirk for 01:00 isapnp: SB audio device quirk - increasing port range isapnp: Card ’Creative SB16 PnP’ isapnp: 1 Plug \u0026 Play card detected total ne.c:v1.10 9/23/94 Donald Becker (becker@scyld.com) Last modified Nov 1, 2000 by Paul Gortmaker NE*000 ethercard probe at 0x340: 00 40 33 94 ad 7d eth3: NE2000 found at 0x340, using IRQ 10. Soundblaster audio driver Copyright (C) by Hannu Savolainen 1993-1996 sb: Creative SB16 PnP detected sb: ISAPnP reports ’Creative SB16 PnP’ at i/o 0x220, irq 5, dma 1, 5 SB 4.13 detected OK (220) sb: 1 Soundblaster PnP card(s) found. Como vemos, ya ha ido asignando tarjetas.. eth0 la Intel, eth1 la 8139, eth2 la 8029 y eth3 la Ne2000, lo de la SoundBlaster es accesorio, pero mola que la pille el solito ;) (con un kernel de la 2.4 aviso…)\nAhora falta configurar las direcciones para cada tarjeta… editamos el fichero /etc/network/interfaces:\n# The first network card - this entry was created during the Debian installation auto eth0 iface eth0 inet dhcp auto eth1 iface eth1 inet static address 1.1.1.1 netmask 255.255.255.0 auto eth2 iface eth2 inet static address 1.1.2.1 netmask 255.255.255.0 auto eth3 iface eth3 inet static address 10.34.12.129 netmask 255.255.255.224 #auto eth3 #iface eth3 inet static # address 1.1.3.1 # netmask 255.255.255.0 Esto en cristiano viene a decir que cargue las tarjetas en el arranque (auto eth?), y lo de abajo, pues cómo configurarlas… la eth0 es la que estaba conectada a internet, por lo tanto como mi proveedor configura por DHCP, pues eso pone… la eth1 es la de mi red local con el primero ordenador, le asigna una ip 1.1.1.1 y una máscara de subred de tipo C.\nEn realidad la dirección 1.1.1.1 está asignada en internet y sería una cabronada el conectarme con eso configurado así, pero como hemos dicho, es una red local y no tiene porqué afectar a nadie, así que así se queda…\nCon la segunda para la red local, pues lo mismo, pero con otra dirección 1.1.2.1 y con subred de tipo C y la ethernet 3 es lo que sería la wireless y le asigno una dirección real y válida, en mi caso, esta ip pertenece a Valencia Wireless y está asignada a mi nodo, cada uno que consulte en http://www.redlibre.net el direccionamiento y que se ponga encargado con el responsable de su zona si lo hay y si no, directamente con Redlibre…\nAhora, al arrancar el ordenador que hace de nodo, ya debería coger automáticamente esos datos para cada tarjeta y funcionar así bien…\nMe podéis preguntar que porqué asigno la 1.1.1.1 a una y la 1.1.2.1 a dos tarjetas que pertenecen a la misma red local… lo ideal sería 1.1.1.2, pero luego tenía problemas con el DHCP (con un hub nunca hubiera pasado… pero como nadie me ha dado ninguno…) (luego se verá el motivo)\nEl siguiente paso, es que ya puestos, que el ordenador asigne direcciones a los ordenadores que se conecten de forma automática, es decir.. montar un servidor DHCP… para ello instalaremos el paquete DHCP y el servidor de nombres BIND, para que los equipos remotos que se conecten puedan pedir configuración automáticamente y que puedan resolver nombres…\nEl fichero de configuración del DHCP es el siguiente: (/etc/dhcp3/dhcp.conf):\n# # Sample configuration file for ISC dhcpd # ddns-updates on; use-host-decl-names on; allow unknown-clients; default-lease-time 3600; max-lease-time 7200; authoritative; subnet 10.34.12.128 netmask 255.255.255.224 option domain-name-servers 10.34.12.129; range 10.34.12.131 10.34.12.158; option broadcast-address 10.34.12.159; option routers 10.34.12.129; subnet 192.168.1.0 netmask 255.255.255.0 option domain-name-servers 192.168.1.1; range 192.168.1.2 192.168.1.254; option broadcast-address 192.168.1.255; option routers 192.168.1.1; subnet 1.1.1.0 netmask 255.255.255.0 option domain-name-servers 1.1.1.1; option domain-name alufis; range 1.1.1.3 1.1.1.254; option broadcast-address 1.1.1.255; option routers 1.1.1.1; option netbios-name-servers 1.1.1.1; option netbios-node-type 8; subnet 1.1.2.0 netmask 255.255.255.0 option domain-name alufis; option netbios-name-servers 1.1.2.1; option netbios-node-type 8; option domain-name-servers 1.1.2.1; range 1.1.2.3 1.1.2.254; option broadcast-address 1.1.2.255; option routers 1.1.2.1; subnet 1.1.3.0 netmask 255.255.255.0 option domain-name-servers 1.1.3.1; option domain-name alufis; range 1.1.3.3 1.1.3.254; option broadcast-address 1.1.3.255; option routers 1.1.3.1; option netbios-name-servers 1.1.3.1; option netbios-node-type 8; host deneb option host-name \"deneb\"; hardware ethernet 00:04:e2:33:4e:8d; fixed-address 1.1.1.2; server-name \"deneb\"; host darkstar option host-name \"darkstar\"; hardware ethernet 00:80:c8:16:de:59; server-name \"darkstar\"; fixed-address 1.1.2.2; host Alnilam option host-name \"alnilam\"; hardware ethernet 00:90:d1:06:57:dc; fixed-address 10.34.12.130; server-name \"alnilam\"; A ver… por partes…\nPrimero defino lo que será la wireless, con la ip asignada, la subred, el rango de ip’s, etc…\nsubnet 10.34.12.128 netmask 255.255.255.224 option domain-name-servers 10.34.12.129; range 10.34.12.130 10.34.12.158; option broadcast-address 10.34.12.159; option routers 10.34.12.129; Esto viene a significar que la red 10.34.12.128 (valencia wireless, mi nodo), con máscara de subred (255.255.255.224), tiene un servidor de nombres situado en 10.34.12.129 (la asignada a eth3), una dirección de broadcast en .158 y un router en .129 (el mismo que el DNS, es decir, el nodo…).\nEl rango de ip’s asignado van desde la siguiente al nodo (.33) hasta el .62 de esa forma los clientes que pidan configuración por DHCP por el interfaz con esa subred (eth3) obtendrán una IP dentro de ese rango…\n192.168.. son direcciones para redes privadas y en este caso la utilizaré para los equipos que se conecten mediante la VPN, es decir, equipos que primero se conectan por la wireless y luego se conectan mediante VPN, realmente no creo que fuese necesario indicarlo, pero lo prefiero así :)\nLuego vienen definidas las redes para las tarjetas locales 1.1.1.1 y 1.1.2.1, si ambas tarjetas estuviesen en la misma red, con una sola definición bastaría, pero el problema sería que si a la 1.1.1.3 que se conecta por la segunda tarjeta de red con IP 1.1.1.2 le digo que el router es 1.1.1.1 que es la primera tarjeta de red, pues habrían problemas… no iría ni a tiros… esto con un HUB no pasa y no hace falta poner estas dos definiciones, pero en mi caso sí… así cada una es una red distinta que va bien y asigna ip’s automáticamente y resuelve nombres.\nLuego vienen dos declaraciones de equipo, en mi caso, a mis dos equipos de casa, les asigno ip’s fijas, porque no me van a hacer falta más (de hecho no haría falta ni el dhcp para ellas, pero bueno, puestos a hacerlo a lo grande… pues ya lo tengo listo para un día meter dos hubs y poder conectar tropocientos ordenadores en cada tarjeta de red ;))\nPara asignar IP fija, se hace en base a la dirección MAC de la tarjeta de red, que son esos códigos en hexadecimal.\nEn el último caso defino otro ordenador pero sin ip fija (en su momento irá por la wireless y por eso no tiene nada puesto)\nRespecto al servidor de nombres… no hice nada, sólo instalé el paquete y ya iba, así que no toqué nada :)\nHasta este punto los equipos cliente que se configuren para que pidan la configuración automáticamente, recibirán una configuración válida desde nuestro nodo, ahora sólo falta hacer alguna cosilla más ;)\nMasquerading Tenemos un servidor DHCP, las tarjetas configuradas y un servidor de nombres… ahora sólo falta que enrute!!! de esa forma tendremos acceso a Internet desde cualquiera de nuestros ordenadores…\nPara ello, si leemos el IP-MASQUERADING-HOWTO, sacaremos este interesante script:\n#!bash #!/bin/sh # # rc.firewall-2.4 FWVER=0.63 # # Initial SIMPLE IP Masquerade test for 2.4.x kernels using IPTABLES. # # Once IP Masquerading has been tested, with this simple ruleset, it is highly recommended to use a stronger IPTABLES ruleset either given later in this HOWTO or from another reputable resource. # Log: # 0.63 - Added support for the IRC IPTABLES module # 0.62 - Fixed a typo on the MASQ enable line that used eth0 instead of $EXTIF # 0.61 - Changed the firewall to use variables for the internal and external interfaces. # 0.60 - 0.50 had a mistake where the ruleset had a rule to DROP all forwarded packets but it didn’t have a rule to ACCEPT any packets to be forwarded either - Load the ip_nat_ftp and ip_conntrack_ftp modules by default # 0.50 - Initial draft # echo -e \"\\n\\nLoading simple rc.firewall version $FWVER..\\n\" # The location of the ’iptables’ program IPTABLES=/sbin/iptables EXTIF=\"eth0\" EXTIF2=\"eth3\" EXTIF3=\"sl+\" INTIF=\"eth1\" INTIF2=\"eth2\" INTIF3=\"ppp+\" LAN1=\"1.1.1.0/16\" echo \" External Interface : $EXTIF\" echo \" External Interface 2 : $EXTIF2\" echo \" External Interface 3 : $EXTIF3\" echo \" -----------------------------\" echo \" Internal Interface : $INTIF\" echo \" Internal Interface 2 : $INTIF2\" echo \" Internal Interface 3 : $INTIF3\" echo \" -----------------------------\" echo \" Internal Network : $LAN1\" echo \" enabling forwarding..\" echo \"1\" \u003e /proc/sys/net/ipv4/ip_forward echo \" enabling DynamicAddr..\" echo \"1\" \u003e /proc/sys/net/ipv4/ip_dynaddr # Borrar reglas anteriores tanto en normal como en nat y por defecto no enrutar $IPTABLES -t nat -F $IPTABLES -F $IPTABLES -P FORWARD DROP #Conectar la red local para transferencia de datos $IPTABLES -A FORWARD -s $LAN1 -d $LAN1 -j ACCEPT #Pasar datos desde las locales a inet $IPTABLES -A FORWARD -s $LAN1 -o $EXTIF -j ACCEPT # Aceptar paquetes de entrada a la local $IPTABLES -A FORWARD -i $EXTIF -d $LAN1 -m state —state ESTABLISHED,RELATED -j ACCEPT # Enmascarar a internet $IPTABLES -t nat -A POSTROUTING -o $EXTIF -j MASQUERADE #Pasar datos desde las locales a la wireless $IPTABLES -A FORWARD -s $LAN1 -o $EXTIF2 -j ACCEPT $IPTABLES -A FORWARD -i $EXTIF2 -d $LAN1 -m state —state ESTABLISHED,RELATED -j ACCEPT # Enmascarar a la wireless $IPTABLES -t nat -A POSTROUTING -s $LAN1 -o $EXTIF2 -j MASQUERADE #Entrada de la red local a los túneles wireless (sl+) $IPTABLES -A FORWARD -s $LAN1 -o $EXTIF3 -j ACCEPT $IPTABLES -A FORWARD -i $EXTIF3 -d $LAN1 -m state —state ESTABLISHED,RELATED -j ACCEPT # Enmascarar a los túneles $IPTABLES -t nat -A POSTROUTING -s $LAN1 -o $EXTIF3 -j MASQUERADE #Paquetes de entrada entre las wireless y los túneles Wireless (sl+) $IPTABLES -A FORWARD -i $EXTIF2 -o $EXTIF3 -j ACCEPT $IPTABLES -A FORWARD -i $EXTIF3 -o $EXTIF2 -j ACCEPT # Paquetes de entrada de la VPN a internet y a la wireless $IPTABLES -A FORWARD -i $INTIF3 -o $EXTIF -j ACCEPT $IPTABLES -A FORWARD -i $EXTIF -o $INTIF3 -m state —state ESTABLISHED,RELATED -j ACCEPT $IPTABLES -A FORWARD -i $INTIF3 -o $EXTIF2 -j ACCEPT $IPTABLES -A FORWARD -i $EXTIF2 -o $INTIF3 -m state —state ESTABLISHED,RELATED -j ACCEPT # Programas #------------------------------------------ # Proxy Transparente echo \"Transparent Proxy for SQUID\" $IPTABLES -t nat -A PREROUTING -p TCP —dport 80 -j REDIRECT —to-port 3128 -d ! $LAN1 $IPTABLES -t nat -A PREROUTING -p TCP —dport 25 -j REDIRECT —to-port 25 -d ! $LAN1 $IPTABLES -t nat -A PREROUTING -p TCP —dport 110 -j REDIRECT —to-port 110 -d ! $LAN1 # Gnome Meeting echo \"Gnome Meeting\" $IPTABLES -t nat -A PREROUTING -i $EXTIF -p TCP —dport 0000:30010 -j DNAT —to-dest 1.1.1.2 $IPTABLES -t nat -A PREROUTING -i $EXTIF -p TCP —dport 1720 -j DNAT —to-dest 1.1.1.2 $IPTABLES -A FORWARD -p tcp -i $EXTIF —dport 30000:30010 -d 1.1.1.2 -j ACCEPT $IPTABLES -A FORWARD -p udp -i $EXTIF —dport 5000:5003 -d 1.1.1.2 -j ACCEPT $IPTABLES -t nat -A PREROUTING -i $EXTIF -p UDP —dport 5000:5003 -j DNAT —to-dest 1.1.1.2 $IPTABLES -A FORWARD -p tcp -i $EXTIF —dport 1720 -d 1.1.1.2 -j ACCEPT #Aim, MSN echo \"AIM, MSN\" $IPTABLES -t nat -A PREROUTING -i $EXTIF -p tcp —dport 5190 -j REDIRECT —to-ports 5190 $IPTABLES -t nat -A PREROUTING -i $EXTIF -p tcp —dport 1863 -j REDIRECT —to-ports 1863 $IPTABLES -A INPUT -i $EXTIF -p tcp —dport 5190 -j ACCEPT $IPTABLES -A INPUT -i $EXTIF -p tcp —dport 1863 -j ACCEPT $IPTABLES -A INPUT -i $EXTIF -p tcp —dport 4443 -j ACCEPT $IPTABLES -A INPUT -i $EXTIF -p tcp —dport 5566 -j ACCEPT $IPTABLES -A INPUT -i $EXTIF -p tcp —dport 1864 -j ACCEPT #VNC Deneb :0 echo \"VNC\" $IPTABLES -A FORWARD -i $EXTIF -p TCP —dport 5800 -j ACCEPT $IPTABLES -A FORWARD -i $EXTIF -p TCP —dport 5900 -j ACCEPT $IPTABLES -t nat -A PREROUTING -i $EXTIF -p TCP —dport 5800 -j DNAT —to 1.1.1.2:5800 $IPTABLES -t nat -A PREROUTING -i $EXTIF -p TCP —dport 5900 -j DNAT —to 1.1.1.2:5900 $IPTABLES -A FORWARD -i $EXTIF -p TCP —dport 5500 -j ACCEPT $IPTABLES -t nat -A PREROUTING -i $EXTIF -p TCP —dport 5500 -j DNAT —to 1.1.1.2:5500 #Firewall echo \"Firewall\" $IPTABLES -A INPUT -p TCP —dport 3306 -i $EXTIF -j DROP $IPTABLES -A INPUT -p TCP —dport 3306 -i $EXTIF2 -j DROP $IPTABLES -A INPUT -p TCP —dport 3128 -i $EXTIF -j DROP $IPTABLES -A INPUT -p TCP —dport 53 -i $EXTIF -j DROP $IPTABLES -A INPUT -p TCP —dport 25 -i $EXTIF -j DROP $IPTABLES -A INPUT -p TCP —dport 25 -i $EXTIF2 -j DROP $IPTABLES -A INPUT -p TCP —dport 137 -i $EXTIF -j DROP $IPTABLES -A INPUT -p TCP —dport 137 -i $EXTIF2 -j DROP $IPTABLES -A INPUT -p TCP —dport 139 -i $EXTIF -j DROP $IPTABLES -A INPUT -p TCP —dport 139 -i $EXTIF2 -j DROP $IPTABLES -A INPUT -p TCP —dport 179 -i $EXTIF -j DROP $IPTABLES -A INPUT -p TCP —dport 2600:2605 -i $EXTIF -j DROP $IPTABLES -A INPUT -p TCP —dport 179 -i $EXTIF2 -j DROP $IPTABLES -A INPUT -p TCP —dport 2600:2605 -i $EXTIF2 -j DROP Si nos olvidamos hasta donde pone algo con IPTABLES, lo que tenemos es un script que habilita la funcionalidad de enrutado del kernel de linux, a partir de ese momento ya tendremos acceso “teórico” a internet…\nEl problema es que como sólo tendremos una dirección IP válida, lo que tendremos que hacer es hacer NAT (Network Address Translation), existen dos tipos de NAT, el de destino y el de origen, en nuestro caso es el de origen, es decir, al final, los datos que salgan tendrán que aparentar ser todos desde la misma IP…\nPara eso utilizamos esas sentencias de iptables que es el firewall, etc incorporado en Linux:\nLo de hacerlo con variables (las definidas al principio), es por facilidad a la hora de modificarlo, como veréis las redes están definidas como IP/bits para hacer las conversiones acudid a: http://www.linux-es.com/ipcalc.php\nLas reglas definidas en este fichero, permiten que todo lo que salga por la eth0 (Internet) sea con NAT y que a su vez, lo que salga por eth3 (la wireless) sea también con NAT (para tener acceso a la wireless desde la red local), luego permite el tráfico de paquetes entre las ip’s de las redes locales.\nEl script original fue modificado para cumplir con los requisitos de mi red, así que cada uno que lo adapte a la suya para que le sea útil.\nVale, un punto importante, es que al tener un trasto conectado todo el día a Internet, lo mejor es tenerlo bien asegurado, por eso, contar con una buena configuración de firewall así como el portscanner vendrá bien. Port scanner analiza y registra todos los intentos de escaneo de puertos contra nuestro equipo y posteriormente impide todo acceso desde las ip’s originantes, tanto creando rutas nulas como vuelta a esas ip’s como añadiéndola a los filtros de los TCP-wrappers En /etc/portsentry.ignore.static, pondremos:\n127.0.0.1/32 0.0.0.0 1.1.0.0/16 Para que no bloquee los locales (como indica en la ayuda) y añadimos los de nuestra red local… equipos con IP 1.1.. (esto permite bloquear a los graciositos que se conecten por la wireless…)\nLuego, en el /etc/porsentry/portsentry.conf cambiaremos:\nBLOCK_UDP=\"1\" BLOCK_TCP=\"1\" y entre las otras opciones escogeremos las aptas para nuestro sistema, el tipo de bloqueo a realizar, etc\nAhora si alguien intenta hacer el tonto haciendo escaneos de puertos, pues automáticamente le será impedido posterior acceso desde esa Ip…\nPara arrancar el script del firewall crearemos un script con el formato estándar tal como sigue:\n/etc/init.d/fire\n#!bash #!/bin/sh IPTABLES=/sbin/iptables # See how we were called. case \"$1\" in start) /etc/init.d/rc.firewall ;; stop) echo -e \"\\nFlushing firewall and setting default policies to DROP\\n\" $IPTABLES -P INPUT DROP $IPTABLES -F INPUT $IPTABLES -P OUTPUT DROP $IPTABLES -F OUTPUT $IPTABLES -P FORWARD DROP $IPTABLES -F FORWARD $IPTABLES -F -t nat # Delete all User-specified chains $IPTABLES -X # Reset all IPTABLES counters $IPTABLES -Z ;; restart) $0 stop $0 start ;; status) $IPTABLES -L ;; mlist) cat /proc/net/ip_conntrack ;; *) echo \"Usage: fire start|stop|status|mlist\" exit 1 ;; esac Si ahora creamos los enlaces simbólicos apropiados a este script en /etc/rc?.d pondremos especificar cuando queremos que se arranque el enrutamiento…\nEn mi caso:\nrc0.d/K20fire rc1.d/K20fire rc2.d/S20fire rc3.d/S20fire rc4.d/S20fire rc5.d/S20fire rc6.d/K20fire En esas carpetas dentro de /etc\nUn problema que tendremos al apagar el ordenador, es que como no tendremos monitor, no podremos saber cuando está listo para apagar y no vamos a conectar un monitor cada vez para hacerlo…\nTúneles\nAhora que parece que está más o menos esto en marcha, habría que hacer túneles entre los distintos nodos de otras personas, para eso os recomiendo el paquete VPND junto a los scripts de VPNS: VPN’s http://freshmeat.net/projects/vpns/\nHay un bonito README en el VPNS.\nConsejos Finales Vale, nuestro servidor tiene las tarjetas configuradas, enruta, hace de servidor DHCP, DNS, bloquea los escaneos de puertos… ahora sólo queda algún detalle interesante:\nLo primero: activar el soporte para el sistema de ficheros ext3, su compatibilidad con el ext2 es total, el cambio se hace simplemente poniendo:\ntune2fs -j /dev/hda1 (para la partición 1 del hd) y luego editando el /etc/fstab y donde ponga /dev/hda1 cambiar ext2 por ext3…\nDe ese modo, el sistema arrancará igual, pero con una ventaja… en caso de apagón, bloqueo, reseteo, etc, el sistema de ficheros ext3 crea un log de los cambios realizados y en esas situaciones, al siguiente rearranque, los puede corregir en la mayoría de las situaciones el solito, provocando que si se va la luz, en cuanto vuelva, automáticamente intente arrancar el solito (y en la mayoría de los casos lo conseguirá ;))\nOtras cosas útiles…. configurar el SMB para poder acceder desde la red local con Windows… así el servidor que hace de nodo, puede quedarse bajando cosas por la noche (si es nodo tiene que estar todo el día en marcha) y luego simplemente te las transfieres a tu equipo mediante el entorno de red… (Existen hotwtos que lo explican muy bien así que…. a usar el Google que para eso está…)\nSería también recomendable que instalases el DNS2GO que permite asignar un nombre de dominio a una IP dinámica, de ese modo podrías aprovechar para poner una página web en tu nodo con el apache e instalar el webalizer para analizar sus visitas, etc Como DNS2GO es ahora de pago, yo utilizo NO-IP. En Debian tenéis un paquete llamado no-ip que incorpora un cliente listo para configurar y así actualizar automáticamente vuestra ip dinámica en el servidor DNS.\nPara configurar el zebra, lo único que tengo hecho por el momento es editar el /etc/zebra/daemons y activar zebra, ospfd y el bgpd… cuando tenga tarjetas lo probaré y diré… (de esto se está encargando Hilario de ValenciaWireless\nPor el momento es todo… con esto tienes un nodo… puedes acceder por SSH a el para configurarlo remotamente (el putty es un buen cliente para Windows, WinSCP para transferencias seguras de archivos ;)), configurarlo por web (Webmin) y ya con eso para empezar está bien…\nRespecto a la VPN (pptpd)… Pues antes no… pero ahora ya va a la perfección ;)\nSi no te conectas mediante VPN mediante la tarjeta de la wireless (eth3 en mi caso) no hay Internet (excepto por página web al puerto 80), y si te validas sí… así que si tienes poco ancho de banda, puedes controlar si accedes o no desde fuera de tu red casera… es decir.. gastas la red inalámbrica para acceder al de tu casita y una vez ahí accedes a través de ese a Internet ;)\nSería interesante activar también un Proxy tipo Squid para acelerar la navegación por Internet… tanto por la red local, como para los nodos (puedes restringir por ip’s, etc ) (yo lo tengo puesto además con el adzapper, que me permite eliminar muchísimos anuncios de las webs por las que navego)\n¡¡Un saludo y suerte!!\nFicheros de configuración Squid acl local src 1.1.0.0/16 http_access allow local maximum_object_size 32768 KB cache_dir ufs /var/spool/squid 512 16 256 httpd_accel_uses_host_header on redirect_program /usr/lib/squid/squid_redirect redirect_children 30 # PPTPD (para las VPN entrantes) /etc/ppp/pptpd-options debug name in chap-secrets name Merak auth +chap ms-dns 192.168.0.1 netmask 255.255.0.0 lock /etc/ppp/chap-secrets # Secrets for authentication using CHAP # client server secret IP addresses prueba * probando * Disfruta! (y si lo haces, puedes Invitarme a un café ) ","wordCount":"6619","inLanguage":"es","image":"https://iranzo.io/mugshot.png","datePublished":"2003-06-18T21:39:00Z","dateModified":"2023-08-25T09:45:44.576Z","author":{"@type":"Person","name":"Pablo Iranzo Gómez"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://iranzo.io/es/blog/2003/06/18/montar-un-router-con-la-idea-de-wireless/"},"publisher":{"@type":"Organization","name":"Pablo Iranzo Gómez blog","logo":{"@type":"ImageObject","url":"https://iranzo.io/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://iranzo.io/es/ accesskey=h title="Home (Alt + H)"><img src=https://iranzo.io/apple-icon-152x152.png alt aria-label=logo height=35>Home</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)" aria-label="Toggle theme"><svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button><ul class=lang-switch><li>|</li><li><a href=https://iranzo.io/ title=English aria-label=English>En</a></li></ul></div></div><ul id=menu><li><a href=https://iranzo.io/es/ title=🏠Home><span>🏠Home</span></a></li><li><a href=https://iranzo.io/es/about/ title=🗒️About><span>🗒️About</span></a></li><li><a href=https://iranzo.io/es/redken_bot/ title=🐘redken_bot><span>🐘redken_bot</span></a></li><li><a href=https://iranzo.io/es/projects/ title=📐Projects><span>📐Projects</span></a></li><li><a href=https://iranzo.io/es/archives/ title="🗄️ Archives"><span>🗄️ Archives</span></a></li><li><a href=https://iranzo.io/es/categories/ title=🗺️Categories><span>🗺️Categories</span></a></li><li><a href=https://iranzo.io/es/tags/ title=🏷️Tags><span>🏷️Tags</span></a></li><li><a href=https://iranzo.io/es/search title="🔎Search (Alt + /)" accesskey=/><span>🔎Search</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://iranzo.io/es/>Inicio</a>&nbsp;»&nbsp;<a href=https://iranzo.io/es/blog/>Blogs</a></div><h1 class="post-title entry-hint-parent">Montar un router con la idea de wireless</h1><div class=post-meta><span title='2003-06-18 21:39:00 +0000 UTC'>junio 18, 2003</span>&nbsp;·&nbsp;32 min&nbsp;·&nbsp;Pablo Iranzo Gómez</div></header><div class=toc><details open><summary accesskey=c title="(Alt + C)"><span class=details>Tabla de Contenidos</span></summary><div class=inner><ul><li><a href=#introducci%c3%b3n aria-label=Introducción>Introducción</a></li><li><a href=#sistema-operativo-y-paquetes aria-label="Sistema Operativo y Paquetes">Sistema Operativo y Paquetes</a></li><li><a href=#red aria-label=Red>Red</a></li><li><a href=#masquerading aria-label=Masquerading>Masquerading</a></li><li><a href=#consejos-finales aria-label="Consejos Finales">Consejos Finales</a></li><li><a href=#ficheros-de-configuraci%c3%b3n aria-label="Ficheros de configuración">Ficheros de configuración</a><ul><li><a href=#squid aria-label=Squid>Squid</a></li><li><a href=#etcppppptpd-options aria-label=/etc/ppp/pptpd-options>/etc/ppp/pptpd-options</a></li><li><a href=#etcpppchap-secrets aria-label=/etc/ppp/chap-secrets>/etc/ppp/chap-secrets</a></li></ul></li></ul></div></details></div><div class=post-content><h3 id=introducción>Introducción<a hidden class=anchor aria-hidden=true href=#introducción>#</a></h3><p>Un nodo nos permitirá unir a personas conectadas desde sus tarjetas inalámbricas. Un nodo tiene que ser el punto de unión entre distintos clientes y a su vez enlazar con otros nodos para así crear una red.</p><p>En el caso de las redes inalámbricas, existen varias aproximaciones.</p><p>Un nodo puede ser un aparato denominado Punto de Acceso o por sus siglas en inglés AP (Access Point) que contiene en su interior un interfaz wireless y una conexión Ethernet RJ45 para enlazarlo o bien con un equipo o con una red.</p><p>Un aparato que realice dichas funciones no es especialmente asequible además de que está bastante limitado&mldr;</p><p>La solución más aceptada es utilizar un PC para que haga de nodo, teniendo así muchísima más flexibilidad a la hora de configurarlo (más problemático también, no es &ldquo;enchufar y listo&rdquo; como con un AP de hardware).</p><p>Las tarjetas a la venta en el mercado tienen tres modos de operación:</p><ol><li>Ad-hoc: Es el modo estándar, en este tipo de modo de operación, es el equivalente a las redes con Windows en las que se trabaja de igual a igual, todos son clientes y servidores.</li><li>Managed: un servidor independiente (un AP) es el lugar al que se conectan todas las demás tarjetas inalámbricas, el AP gestiona todas las conexiones, enrutados, etc.</li><li>Master: Es el modo en el que trabaja el AP del punto anterior para que las tarjetas puedan trabajar como &ldquo;Managed&rdquo;.</li></ol><p>En redes con Windows sólo es posible trabajar en los dos primeros modos, el Ad-Hoc y el Managed, para ello, como se ve, es necesario un AP por hardware que trabaje como Master al que las tarjetas que trabajan en Managed se puedan conectar. Y este es el punto en el que Linux marca la diferencia&mldr; con Linux, existe un controlador (hostap) para las tarjetas basadas en Prism2 (p.ej. las Conceptronic). Con Linux y con esos controladores, es posible poner en modo Master las tarjetas de red
(generalmente PCMCIA con un adaptador PCI para equipos de sobremesa) y de ese modo, hacer un AP por software.</p><p>Quisiera expresar mi agradecimiento a <code>Ghfjdksl</code> de #wireless, a Jorti de <code>#guadawireless</code> y a Hilario y a Hawkmoon de <code>#valenciawireless</code> por la ayuda prestada para montar este nodo. Saludos también al resto de gente de <code>#valenciawireless</code> por sus larguísimas tertulias ;P</p><p>Hardware</p><p>Para la creación del nodo, necesitaremos unos componentes de hardware tanto de software.</p><p>En la creación del nodo de La Creu Wireless, el hardware es el siguiente:</p><ul><li>Placa AT Pentium 120</li><li>500 Mb HD</li><li>420 Mb HD (porque lo tenía a mano, pero posiblemente lo quite&mldr; lo que menos quiero es que el ordenador haga más ruido&mldr;)</li><li>64 mb Ram (iba a tener 16, pero a última hora conseguí más&mldr;)</li><li>Tarjeta gráfica ATI Mach 64 Pro Turbo PCI</li><li>Ethernet ISA P&rsquo;n&rsquo;P Intel PRO 10/10+</li><li>Ethernet PCI basada en Realtek 8029 (10 mbps)</li><li>Ethernet PCI basada en Realtek 8139 (10/100)</li><li>Ethernet ISA P&rsquo;n&rsquo;P Compatible con NE 2000</li><li>Tarjeta wireless todavía no la tengo, utilizo la ISA P&rsquo;n&rsquo;P compatible con NE2000 como si fuese la wireless (A la que en la actualidad tengo conectado un USR2450 en modo bridge con LinuxAP)</li><li>Tarjeta de sonido SB 16 P&rsquo;n&rsquo;P (no se para qué porque no la tengo conectada ni nada, pero el caso es que como la tenía&mldr;.)</li><li>CD-ROM (instalé desde disco duro porque no tenía cd-rom en ese momento&mldr; pero bueno.. ahora sí ;))</li><li>RJ45 (latiguillos), uno directo para conectar al módem y a la eth0 y luego tres cruzados para conectar a cada uno de los pc&rsquo;s sin necesidad de hub&mldr; si tienes hub, pues todos directos y listo&mldr;</li></ul><p>Se aceptan regalos ;) (Portátiles incluidos&mldr; ;) )</p><p>Volviendo a la realidad&mldr; memoria le sobra por un tubo, pero bueno, puestos a ponerle, pues se le pone más :)</p><p>Disco duro me gustaría ponerle más, ya que como lo tengo que tener encendido todo el día para que sea un nodo &ldquo;fijo&rdquo;, pues aprovechar y dejar las largas descargas bajándose en ese ordenador.</p><p>Lo de las tarjetas de red puede asustar al principio&mldr; pero bueno, tiene una clara explicación&mldr; en casa tengo dos ordenadores y ahora con el nodo tres, la conexión a Internet requiere otra tarjeta de red y no me permite compartirla directamente conectándola a un HUB, así que me parecía algo tonto el tener que gastarme dinero en un HUB cuando las tarjetas de red ya las tenía&mldr;</p><p>Así que el montaje de la falla es el siguiente:</p><ul><li>Intel Pro ISA 10/10+: eth0 conectada a mi conexión a Internet</li><li>Realtek 8139 (10/100): eth1 conectada a mi equipo principal (también con otra tarjeta 10/100, así que red local a 100 MBps ;) )</li><li>Realtek 8029: eth2 conectada al otro pc que tengo en casa (también con una ethernet a 10 MBps)</li><li>Isa P&rsquo;n&rsquo;P NE2000: eth3 hace las labores de wireless hasta que tenga una de verdad (la utilizo para conectar otro equipo y hacer las pruebas como si estuviese conectado por wireless), en su momento será utilizada para conexiones &ldquo;temporales&rdquo; por cable, siendo entonces eth4 la wireless &ldquo;real&rdquo;.</li></ul><p>Realmente con un HUB podría quitar dos tarjetas de red del ordenador (ya que el ordenador principal y el secundario irían conectados al hub y no serían necesarias las tarjetas correspondientes y sólo utilizaría la otra que quedase para Internet y la otra para conectar al HUB (si mi conexión me permitiese hacerlo, hasta podría conectar mi módem al HUB y ahorrarme otra tarjeta.. pero bueno, el caso es que no se puede&mldr;)</p><p>Como se puede ver, no digo nada de ratón ni de monitor&mldr; el caso es que realmente no es necesario porque para hacer la instalación inicial se hará conectándolo a otro monitor, pero una vez puesto en marcha no hará falta para nada, de hecho hasta el teclado sobraría, pero como he dicho que es un P120 con AT, en los casos en los que tengo que apagar o reiniciar la máquina necesito algo que no implique un reset total (o sea, necesito tres teclas: CTRL-ALT-SUPR).</p><p>El teclado que tengo es uno de 84 teclas que será como un teclado normal pero sin el bloque numérico y sin el bloque de av-pag, etc de tamaño, tiene sólo dos leds, Bloq may y bloq despl, pero lo dicho&mldr; sobra ;)</p><p>Ahora el ordenador es un P200 MMX con 128 Mb de RAM, las tarjetas son una Intel Pro ISA 10/10+, una SMC 100, 3Com 3c509 y NE2000, discos tiene uno de 10 Gb, y otro de 20, configurados como:</p><ul><li>128 Mb Swap</li><li>10 Mb boot</li><li>3 Gb sistema, usuarios</li><li>Resto = 26 Gb para descargas diversas&mldr; (pero con ánimo educativo, no os vayais a pensar&mldr;)</li></ul><p>Ahora vamos a la configuración del software&mldr;</p><h3 id=sistema-operativo-y-paquetes>Sistema Operativo y Paquetes<a hidden class=anchor aria-hidden=true href=#sistema-operativo-y-paquetes>#</a></h3><p>El primer paso previo a todos, es que una vez configurado el hardware para que no se queje (IRQ&rsquo;s, puertos IO, etc) (si la placa es realmente P&rsquo;n&rsquo;P no habrá problemas pero la mía aunque es P&rsquo;n&rsquo;P dio algunos problemas así que&mldr; ajo y agua&mldr;) Si has de comprar tarjetas y puedes, cómpralas PCI y mejor todavía si compras un HUB porque así no tienes que tener el ordenador rellenito en todas sus ranuras con ethernets ;).</p><p>Lo primero a configurar entonces es la BIOS.</p><p>Como cada BIOS es de un papá y de una mamá distintos (aunque a veces la mamá sea siempre Award o Ami), daré la explicación general y que cada uno se las apañe con el manual de su placa base para hacer lo que digo&mldr;</p><p>PD: Si no sabes lo que es la BIOS, olvídate de seguir&mldr; esto no está hecho para tí&mldr; Mucho mejor que veas esto.</p><p>Configura las tarjetas en el orden que quieras, pero ten bien claro cuál será cada una (si son todas iguales pues será más problemático, pero no por ello imposible).</p><p>Primero pon el ordenador en fecha y hora, y en la opción que pone &ldquo;Halt on&rdquo; ponle que nada, es decir, que bajo ningún concepto el ordenador no arranque (por ejemplo por falta de teclado, falta de monitor, etc porque al fin y al cabo luego no lo tendrá&mldr;)</p><p>En la BIOS dile que de PNP su tía&mldr; le dices que el sistema operativo no es P&rsquo;N&rsquo;P y que no se maree (puedes probar diciendo que sí, no debería ser muy tortuoso y si lo es, siempre lo puedes cambiar otra vez ;))</p><p>Como dispositivo de arranque se le pondrá primero la disquetera, pero en el momento en que todo esté configurado, se pondrá fijo siempre el disco duro.</p><p>Si la placa es ATX, dile que tras un corte de luz, que se encienda sola&mldr; así evitarás los tiempos de apagón del nodo al mínimo.</p><p>Salva todos los cambios y reiniciará el ordenador&mldr; En mi caso, como no tenía en un primer momento ni disquetera ni cd-rom, aproveché que el disco duro contenía un Windows 95 y bajé la imagen de CD-ROM de instalación de Internet de Debian Potato, la convertí del .ISO a carpetas y directorios normales y la guardé por la red en el segundo HD del ordenador.</p><p>La imagen iso son unos 30 Mb y la descargué de la página de Debian. (<code>woody_netinst-20020626-i386.iso</code>)</p><p>La decisión de tomar &ldquo;Debian&rdquo; como sistema a instalar fue sencilla (lo de que tenía que ser Linux estaba cantado por lo explicado en la introducción):</p><ul><li><strong>Red Hat Linux</strong>: Está muy bien, de hecho es con la que más experiencia tengo, la tengo funcionando desde el año 96 en un servidor y me va genial, poquitos problemas excepto actualizaciones, etc (aunque con las nuevas herramientas es muy fácil). Las actualizaciones, en el momento de lanzarlas, si hay muchos clientes de pago, pues a los que no pagamos, pues ajo y agua y a esperarse a que no esté tan saturado&mldr; el formato de Red Hat, el RPM es el estándar más extendido. (Se puede bajar de internet en versión libre, llamada Fedora Core, o bien en clónicas basadas en RHEL).</li><li><strong>SuSE Linux</strong>: Está muy bien, si compras la distribución, tienes muchos cd&rsquo;s con programas, manuales, etc Bastante bien adaptada al Español (je, je), etc&mldr; Pero no se puede bajar la versión completa de internet porque tiene programas con licencias de distribución que no lo permiten, sólo si se compra. Utiliza el RPM que es un punto a favor, pero en contra es que no es compatible al 100% con las estructuras de directorios y funcionamientos de Red Hat, así que no hay forma de distinguir si ese RPM funcionará bien o no con SuSE. El peor inconveniente es la gran cantidad de recursos que necesita, tanto de RAM para la instalación como para el almacenamiento en disco (la mínima son unos 500 mb (pero mínima mínima mínima&mldr;)). La ventaja es que la configuración es toda en modo gráfico, con una autodetección genial, etc. Tenía experiencia con ella tanto de gastarla en casa como distribución Linux, en la uni en un servidor como de haber colaborado en su traducción de manuales y de software de configuración.</li><li><strong>Debian</strong>: No tenia ni puta idea de ella, una vez que la intenté instalar casi me da algo con el programa de selección de paquetes a instalar (dselect de la Potato). La instalación es en modo texto. Tiene un sistema de actualización/instalación bastante bueno en modo texto. la decisión fue usar Debian&mldr; de paso que aprendía a gastarla, al ser en modo texto, tenía el aliciente de que facilita su administración remota (recordemos que el ordenador una vez instalado mínimamente no iba a tener ni teclado ni ratón ni monitor ni naa de na&mldr; excepto el cable de la luz y cuatro cables RJ45 para las tarjetas de red :))</li></ul><p>Vale, como ya he comentado, en el nodo, en el momento de su creación no tenía ni disquetera ni CD-ROM, así que se copiaron los archivos a una instalación de Windows 95, se reinicia en modo-MS-DOS y una vez en el, se cambia al directorio donde se extrajo la imagen de cd y se ejecuta el programa de instalación&mldr;</p><p>Si tienes grabadora y cd-rom en el nodo pues lo más sencillo es bajar la iso, grabarla a un CD y arrancar desde el CD-ROM (en la bios se puede configurar esa opción).</p><p>Como ya he dicho, la imagen de instalación es una NETINST, es decir, 30 mb mínimos que se utilizan para una vez respondidas unas preguntas copiar un sistema básico que se puede conectar a Internet y seguir bajando el resto de Internet&mldr; (Tengo una conexión a 128 kbps, así que que nadie me diga que es una locura porque es viable&mldr;)</p><p>Cuando yo hice la instalación, la netinst más habitual era la potato, pero hace nada que pasaron a Woody (3.0), el caso es que más o menos son parecidas y de hecho una vez instalé lo mínimo hice el cambio a Woody usando el programa que lleva para hacerlo&mldr;</p><p>No voy a explicar la instalación de Debian porque esto habla de configurar un nodo, no de instalar Linux, pero bueno, básicamente consistió en particionar el HD, crear una partición swap de 40 Mb (ya dije que mi disco duro era pequeñito..) y una de datos de 472 Mb como ext3 Es conveniente pensar un nombre para el nodo&mldr;la norma habitual, al menos en universidades, etc es ponerle nombres de estrellas o de científicos, pero bueno&mldr; Cada uno que le ponga el que le de la gana&mldr;</p><p>Se configura el teclado, la tarjeta de red (como tengo Internet por tarjeta de cable fue tan sencillo como decirle que cargase los módulos de las tarjetas de red (en el caso de las ISA indicando también la IO) y luego en la que estaba conectada a Internet, decirle que hiciese configuración automática por DHCP y ya estaba la conexión funcionando&mldr;</p><p>En la selección de paquetes puse lo mínimo mínimo, así que al ratito y tras un rearranque, me pidió asignar contraseñas y crear un usuario (no es recomendable estar siempre como administrador para trabajar con Linux&mldr;)</p><p>Vale, llegados a este punto, tenemos ya el Linux instalado y tenemos delante la consola para iniciar sesión en el sistema. Vamos a necesitar varios programas además de los básicos para trabajar con el nodo&mldr; si nos gusta Linux, pues nos gustará instalar alguno más, pero bueno&mldr; por un lado están los básicos y los recomendados&mldr;</p><p>Como lo que estoy haciendo es explicar la configuración de lo que yo hice con mi ordenador, pues allá vamos:</p><p>Para la wireless hace falta el <code>wavemon</code> que es un monitor de estado de la tarjeta y el zebra para enrutar dinámicamente.</p><p>En mi caso, ya que ese ordenador iba a hacer de medio &ldquo;servidor&rdquo; en mi casa, pues me interesó ponerle:</p><ul><li>samba: para compartir archivos e impresoras en un formato compatible con Windows y así poder luego bajar archivos de un ordenador a otro (del principal al nodo) mediante el entorno de red</li><li>pptpd: para permitir conexiones VPN, permite que desde internet (o en este caso, desde la wireless), se pueda conectar con el nodo, y se asigne otra dirección IP que permita hacer otras cosas que de normal no se podría&mldr; En mi caso, tengo limite de descarga en Internet y aunque por el momento no lo apliquen no quita que pudieran hacerlo&mldr; causa pues de que no comparta mi acceso a Internet a no ser que conozca directamente al equipo que se conecta&mldr; es decir, una vez conectado mediante la wireless, hará una conexión VPN desde su Windows o su Linux al nodo y mediante un login y un pass tendrá acceso a Internet a través del nodo, que de otra forma no tendría&mldr;) (un nodo no tiene que necesariamente tener acceso a Internet, pero es recomendable para unir los nodos y facilitar la integración en la red, etc)</li><li>webmin: es un programa hecho por caldera y que funciona en multitud de plataformas y distribuciones, permite muy fácilmente configurar desde un navegador muchísimas cosas del sistema. No digo que vaya a reemplazar a la configuración en modo consola, pero para muchas cosas es muchísimo más fácil hacerlo desde navegador que tener que entrar, etc&mldr;</li><li>Otros paquetes instalados (muchos de ellos se instalan solitos como dependencias a los ya instalados&mldr;):</li></ul><p>A ver, en resumen, interesa instalar el ssh porque con el podremos entrar desde fuera al servidor, el webmin y los módulos listados arriba, etc</p><p>Lo dicho, esto es lo que yo tengo puesto&mldr; los paquetes se instalan poniendo:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>apt-get install
</span></span></code></pre></div><p>por ejemplo: <code>apt-get install wavemon zebra webmin-stunnel webmin-status wget vtun</code></p><p>Automáticamente el programa se conectará a Internet y comenzará a bajar esos paquetes y todos los necesarios para que esos funcionen, es decir, si instalas webmin-status, para eso te hará falta primero el webmin y el programa lo instalará también solito tras pedir confirmación e indicar los megas a descargar y lo que ocupará una vez descomprimido.</p><h3 id=red>Red<a hidden class=anchor aria-hidden=true href=#red>#</a></h3><p>Vale, se supone que ahora ya tenemos el sistema funcionando y bueno&mldr; algo es algo :) ahora viene lo serio&mldr; configurarlo para que se adapte a nuestras necesidades&mldr;</p><p>Lo primero es tener un Kernel modernito (a mi con el estándar no me iba, pero como veréis en la lista de paquetes con el 2.4 funciona bastante bien el P&rsquo;N&rsquo;P)</p><p>Tenemos que por un lado configurar las tarjetas de red: Para eso, entramos en <code>/etc/modutils</code> como root y tendremos varios archivos de configuración, para ser representativo pondré el de una tarjeta ISA que son los más difíciles:</p><p>Contenido de : <code>/etc/modutils/eepro</code></p><pre tabindex=0><code class=language-config data-lang=config>options eepro io=0x210
</code></pre><ul><li>Como veréis es altamente jodidísimo configurar una tarjeta de red&mldr; sólo indicando el puerto de entrada salida Linux ya le busca la IRQ apropiada (en casos chungos, se le puede indicar también)</li></ul><p>Con el resto de tarjetas editaremos los ficheros para ver que está todo bien y los llamaremos con el nombre del módulo necesario (sale durante la instalación o en páginas de ayuda) Luego, editaremos el fichero /etc/modules y pondremos las tarjetas en el orden en el que queremos que se llamen:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style=display:flex><span># /etc/modules: kernel modules to load at boot time.
</span></span><span style=display:flex><span>#
</span></span><span style=display:flex><span># This file should contain the names of kernel modules that are
</span></span><span style=display:flex><span># to be loaded at boot time, one per line. Comments begin with
</span></span><span style=display:flex><span># a &#34;#&#34;, and everything on the line after them are ignored.
</span></span><span style=display:flex><span>unix
</span></span><span style=display:flex><span>af_packet
</span></span><span style=display:flex><span>eepro
</span></span><span style=display:flex><span>tulip
</span></span><span style=display:flex><span>3c59x
</span></span><span style=display:flex><span>ne
</span></span><span style=display:flex><span>sb
</span></span></code></pre></div><p>Es decir, primero se cargará la EtherExpress Pro 10/10+ de Intel, que se llamará eth0 (tal como se explicó en el apartado de hardware), luego la 8139 (10/100) como eth2, luego la ne2000 PCI (RTL 8029), luego la Novel 2000 ISA y por último la SoundBlaster&mldr;</p><p>En el caso de haber dos tarjetas con el mismo controlador, se irán creando consecutivamente&mldr; es decir, si hay dos RTL8029, pues serán eth1 y eth2 y así el resto&mldr; en mi caso como cada una es distinta no tuve ese &ldquo;problema&rdquo;.</p><p>Tras editar ese fichero, tendremos que hacer que al siguiente arranque se tome esta configuración, así que ejecutaremos update-modules, para que el ordenador cree el /etc/modules.conf adecuado conforme a nuestros deseos., al siguiente arranque tendremos algo como:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style=display:flex><span>Real Time Clock Driver v1.10e
</span></span><span style=display:flex><span>id: 0xb4 &lt;7&gt; io: 0x210 &lt;6&gt;eth0: Intel EtherExpress Pro/10+ ISA at 0x210,&lt;6&gt; 00&lt;6&gt;:aa&lt;6&gt;:00&lt;6&gt;:c9&lt;6&gt;:9d&lt;6&gt;:1a&lt;6&gt;, IRQ 11, 10BaseT.
</span></span><span style=display:flex><span>eepro.c: v0.13 11/08/2001 aris@cathedrallabs.org
</span></span><span style=display:flex><span>8139too Fast Ethernet driver 0.9.24
</span></span><span style=display:flex><span>eth1: RealTek RTL8139 Fast Ethernet at 0xc486b000, 00:50:fc:4d:c7:d9, IRQ 9
</span></span><span style=display:flex><span>eth1: Identified 8139 chip type ’RTL-8139C’
</span></span><span style=display:flex><span>ne2k-pci.c:v1.02 10/19/2000 D. Becker/P. Gortmaker http://www.scyld.com/network/ne2k-pci.html
</span></span><span style=display:flex><span>eth2: RealTek RTL-8029 found at 0x6100, IRQ 9, 00:C0:DF:E3:46:F9.
</span></span><span style=display:flex><span>isapnp: Scanning for PnP cards...
</span></span><span style=display:flex><span>isapnp: Calling quirk for 01:00
</span></span><span style=display:flex><span>isapnp: SB audio device quirk - increasing port range
</span></span><span style=display:flex><span>isapnp: Card ’Creative SB16 PnP’
</span></span><span style=display:flex><span>isapnp: 1 Plug &amp; Play card detected total
</span></span><span style=display:flex><span>ne.c:v1.10 9/23/94 Donald Becker (becker@scyld.com)
</span></span><span style=display:flex><span>Last modified Nov 1, 2000 by Paul Gortmaker
</span></span><span style=display:flex><span>NE*000 ethercard probe at 0x340: 00 40 33 94 ad 7d
</span></span><span style=display:flex><span>eth3: NE2000 found at 0x340, using IRQ 10.
</span></span><span style=display:flex><span>Soundblaster audio driver Copyright (C) by Hannu Savolainen 1993-1996
</span></span><span style=display:flex><span>sb: Creative SB16 PnP detected
</span></span><span style=display:flex><span>sb: ISAPnP reports ’Creative SB16 PnP’ at i/o 0x220, irq 5, dma 1, 5
</span></span><span style=display:flex><span>SB 4.13 detected OK (220)
</span></span><span style=display:flex><span>sb: 1 Soundblaster PnP card(s) found.
</span></span></code></pre></div><p>Como vemos, ya ha ido asignando tarjetas.. eth0 la Intel, eth1 la 8139, eth2 la 8029 y eth3 la Ne2000, lo de la SoundBlaster es accesorio, pero mola que la pille el solito ;) (con un kernel de la 2.4 aviso&mldr;)</p><p>Ahora falta configurar las direcciones para cada tarjeta&mldr; editamos el fichero /etc/network/interfaces:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style=display:flex><span># The first network card - this entry was created during the Debian installation
</span></span><span style=display:flex><span>auto eth0
</span></span><span style=display:flex><span>iface eth0 inet dhcp
</span></span><span style=display:flex><span>auto eth1
</span></span><span style=display:flex><span>iface eth1 inet static
</span></span><span style=display:flex><span>address 1.1.1.1
</span></span><span style=display:flex><span>netmask 255.255.255.0
</span></span><span style=display:flex><span>auto eth2
</span></span><span style=display:flex><span>iface eth2 inet static
</span></span><span style=display:flex><span>address 1.1.2.1
</span></span><span style=display:flex><span>netmask 255.255.255.0
</span></span><span style=display:flex><span>auto eth3
</span></span><span style=display:flex><span>iface eth3 inet static
</span></span><span style=display:flex><span>address 10.34.12.129
</span></span><span style=display:flex><span>netmask 255.255.255.224
</span></span><span style=display:flex><span>#auto eth3
</span></span><span style=display:flex><span>#iface eth3 inet static
</span></span><span style=display:flex><span># address 1.1.3.1
</span></span><span style=display:flex><span># netmask 255.255.255.0
</span></span></code></pre></div><p>Esto en cristiano viene a decir que cargue las tarjetas en el arranque (auto eth?), y lo de abajo, pues cómo configurarlas&mldr; la eth0 es la que estaba conectada a internet, por lo tanto como mi proveedor configura por DHCP, pues eso pone&mldr; la eth1 es la de mi red local con el primero ordenador, le asigna una ip 1.1.1.1 y una máscara de subred de tipo C.</p><p>En realidad la dirección 1.1.1.1 está asignada en internet y sería una cabronada el conectarme con eso configurado así, pero como hemos dicho, es una red local y no tiene porqué afectar a nadie, así que así se queda&mldr;</p><p>Con la segunda para la red local, pues lo mismo, pero con otra dirección 1.1.2.1 y con subred de tipo C y la ethernet 3 es lo que sería la wireless y le asigno una dirección real y válida, en mi caso, esta ip pertenece a Valencia Wireless y está asignada a mi nodo, cada uno que consulte en <a href=http://www.redlibre.net/>http://www.redlibre.net</a> el direccionamiento y que se ponga encargado con el responsable de su zona si lo hay y si no, directamente con Redlibre&mldr;</p><p>Ahora, al arrancar el ordenador que hace de nodo, ya debería coger automáticamente esos datos para cada tarjeta y funcionar así bien&mldr;</p><p>Me podéis preguntar que porqué asigno la 1.1.1.1 a una y la 1.1.2.1 a dos tarjetas que pertenecen a la misma red local&mldr; lo ideal sería 1.1.1.2, pero luego tenía problemas con el DHCP (con un hub nunca hubiera pasado&mldr; pero como nadie me ha dado ninguno&mldr;) (luego se verá el motivo)</p><p>El siguiente paso, es que ya puestos, que el ordenador asigne direcciones a los ordenadores que se conecten de forma automática, es decir.. montar un servidor DHCP&mldr; para ello instalaremos el paquete DHCP y el servidor de nombres BIND, para que los equipos remotos que se conecten puedan pedir configuración automáticamente y que puedan
resolver nombres&mldr;</p><p>El fichero de configuración del DHCP es el siguiente: (/etc/dhcp3/dhcp.conf):</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style=display:flex><span>#
</span></span><span style=display:flex><span># Sample configuration file for ISC dhcpd
</span></span><span style=display:flex><span>#
</span></span><span style=display:flex><span>ddns-updates on;
</span></span><span style=display:flex><span>use-host-decl-names on;
</span></span><span style=display:flex><span>allow unknown-clients;
</span></span><span style=display:flex><span>default-lease-time 3600;
</span></span><span style=display:flex><span>max-lease-time 7200;
</span></span><span style=display:flex><span>authoritative;
</span></span><span style=display:flex><span>subnet 10.34.12.128 netmask 255.255.255.224
</span></span><span style=display:flex><span>option domain-name-servers 10.34.12.129;
</span></span><span style=display:flex><span>range 10.34.12.131 10.34.12.158;
</span></span><span style=display:flex><span>option broadcast-address 10.34.12.159;
</span></span><span style=display:flex><span>option routers 10.34.12.129;
</span></span><span style=display:flex><span>subnet 192.168.1.0 netmask 255.255.255.0
</span></span><span style=display:flex><span>option domain-name-servers 192.168.1.1;
</span></span><span style=display:flex><span>range 192.168.1.2 192.168.1.254;
</span></span><span style=display:flex><span>option broadcast-address 192.168.1.255;
</span></span><span style=display:flex><span>option routers 192.168.1.1;
</span></span><span style=display:flex><span>subnet 1.1.1.0 netmask 255.255.255.0
</span></span><span style=display:flex><span>option domain-name-servers 1.1.1.1;
</span></span><span style=display:flex><span>option domain-name alufis;
</span></span><span style=display:flex><span>range 1.1.1.3 1.1.1.254;
</span></span><span style=display:flex><span>option broadcast-address 1.1.1.255;
</span></span><span style=display:flex><span>option routers 1.1.1.1;
</span></span><span style=display:flex><span>option netbios-name-servers 1.1.1.1;
</span></span><span style=display:flex><span>option netbios-node-type 8;
</span></span><span style=display:flex><span>subnet 1.1.2.0 netmask 255.255.255.0
</span></span><span style=display:flex><span>option domain-name alufis;
</span></span><span style=display:flex><span>option netbios-name-servers 1.1.2.1;
</span></span><span style=display:flex><span>option netbios-node-type 8;
</span></span><span style=display:flex><span>option domain-name-servers 1.1.2.1;
</span></span><span style=display:flex><span>range 1.1.2.3 1.1.2.254;
</span></span><span style=display:flex><span>option broadcast-address 1.1.2.255;
</span></span><span style=display:flex><span>option routers 1.1.2.1;
</span></span><span style=display:flex><span>subnet 1.1.3.0 netmask 255.255.255.0
</span></span><span style=display:flex><span>option domain-name-servers 1.1.3.1;
</span></span><span style=display:flex><span>option domain-name alufis;
</span></span><span style=display:flex><span>range 1.1.3.3 1.1.3.254;
</span></span><span style=display:flex><span>option broadcast-address 1.1.3.255;
</span></span><span style=display:flex><span>option routers 1.1.3.1;
</span></span><span style=display:flex><span>option netbios-name-servers 1.1.3.1;
</span></span><span style=display:flex><span>option netbios-node-type 8;
</span></span><span style=display:flex><span>host deneb
</span></span><span style=display:flex><span>option host-name &#34;deneb&#34;;
</span></span><span style=display:flex><span>hardware ethernet 00:04:e2:33:4e:8d;
</span></span><span style=display:flex><span>fixed-address 1.1.1.2;
</span></span><span style=display:flex><span>server-name &#34;deneb&#34;;
</span></span><span style=display:flex><span>host darkstar
</span></span><span style=display:flex><span>option host-name &#34;darkstar&#34;;
</span></span><span style=display:flex><span>hardware ethernet 00:80:c8:16:de:59;
</span></span><span style=display:flex><span>server-name &#34;darkstar&#34;;
</span></span><span style=display:flex><span>fixed-address 1.1.2.2;
</span></span><span style=display:flex><span>host Alnilam
</span></span><span style=display:flex><span>option host-name &#34;alnilam&#34;;
</span></span><span style=display:flex><span>hardware ethernet 00:90:d1:06:57:dc;
</span></span><span style=display:flex><span>fixed-address 10.34.12.130;
</span></span><span style=display:flex><span>server-name &#34;alnilam&#34;;
</span></span></code></pre></div><p>A ver&mldr; por partes&mldr;</p><p>Primero defino lo que será la wireless, con la ip asignada, la subred, el rango de ip&rsquo;s, etc&mldr;</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style=display:flex><span>subnet 10.34.12.128 netmask 255.255.255.224 option domain-name-servers 10.34.12.129; range 10.34.12.130 10.34.12.158; option broadcast-address 10.34.12.159; option routers 10.34.12.129;
</span></span></code></pre></div><p>Esto viene a significar que la red 10.34.12.128 (valencia wireless, mi nodo), con máscara de subred (255.255.255.224), tiene un servidor de nombres situado en 10.34.12.129 (la asignada a eth3), una dirección de broadcast en .158 y un router en .129 (el mismo que el DNS, es decir, el nodo&mldr;).</p><p>El rango de ip&rsquo;s asignado van desde la siguiente al nodo (.33) hasta el .62 de esa forma los clientes que pidan configuración por DHCP por el interfaz con esa subred (eth3) obtendrán una IP dentro de ese rango&mldr;</p><p>192.168.<em>.</em> son direcciones para redes privadas y en este caso la utilizaré para los equipos que se conecten mediante la VPN, es decir, equipos que primero se conectan por la wireless y luego se conectan mediante VPN, realmente no creo que fuese necesario indicarlo, pero lo prefiero así :)</p><p>Luego vienen definidas las redes para las tarjetas locales 1.1.1.1 y 1.1.2.1, si ambas tarjetas estuviesen en la misma red, con una sola definición bastaría, pero el problema sería que si a la 1.1.1.3 que se conecta por la segunda tarjeta de red con IP 1.1.1.2 le digo que el router es 1.1.1.1 que es la primera tarjeta de red, pues habrían problemas&mldr; no iría ni a tiros&mldr; esto con un HUB no pasa y no hace falta poner estas dos definiciones, pero en mi caso sí&mldr; así cada una es una red distinta
que va bien y asigna ip&rsquo;s automáticamente y resuelve nombres.</p><p>Luego vienen dos declaraciones de equipo, en mi caso, a mis dos equipos de casa, les asigno ip&rsquo;s fijas, porque no me van a hacer falta más (de hecho no haría falta ni el dhcp para ellas, pero bueno, puestos a hacerlo a lo grande&mldr; pues ya lo tengo listo para un día meter dos hubs y poder conectar tropocientos ordenadores en cada tarjeta de red ;))</p><p>Para asignar IP fija, se hace en base a la dirección MAC de la tarjeta de red, que son esos códigos en hexadecimal.</p><p>En el último caso defino otro ordenador pero sin ip fija (en su momento irá por la wireless y por eso no tiene nada puesto)</p><p>Respecto al servidor de nombres&mldr; no hice nada, sólo instalé el paquete y ya iba, así que no toqué nada :)</p><p>Hasta este punto los equipos cliente que se configuren para que pidan la configuración automáticamente, recibirán una configuración válida desde nuestro nodo, ahora sólo falta hacer alguna cosilla más ;)</p><h3 id=masquerading>Masquerading<a hidden class=anchor aria-hidden=true href=#masquerading>#</a></h3><p>Tenemos un servidor DHCP, las tarjetas configuradas y un servidor de nombres&mldr; ahora sólo falta que enrute!!! de esa forma tendremos acceso a Internet desde cualquiera de nuestros ordenadores&mldr;</p><p>Para ello, si leemos el IP-MASQUERADING-HOWTO, sacaremos este interesante script:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e>#!bash
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#75715e>#!/bin/sh</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#</span>
</span></span><span style=display:flex><span><span style=color:#75715e># rc.firewall-2.4</span>
</span></span><span style=display:flex><span>FWVER<span style=color:#f92672>=</span>0.63
</span></span><span style=display:flex><span><span style=color:#75715e>#</span>
</span></span><span style=display:flex><span><span style=color:#75715e># Initial SIMPLE IP Masquerade test for 2.4.x kernels using IPTABLES.</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#</span>
</span></span><span style=display:flex><span><span style=color:#75715e># Once IP Masquerading has been tested, with this simple ruleset, it is highly recommended to use a stronger IPTABLES ruleset either given later in this HOWTO or from another reputable resource.</span>
</span></span><span style=display:flex><span><span style=color:#75715e># Log:</span>
</span></span><span style=display:flex><span><span style=color:#75715e># 0.63 - Added support for the IRC IPTABLES module</span>
</span></span><span style=display:flex><span><span style=color:#75715e># 0.62 - Fixed a typo on the MASQ enable line that used eth0 instead of $EXTIF</span>
</span></span><span style=display:flex><span><span style=color:#75715e># 0.61 - Changed the firewall to use variables for the internal and external interfaces.</span>
</span></span><span style=display:flex><span><span style=color:#75715e># 0.60 - 0.50 had a mistake where the ruleset had a rule to DROP all forwarded packets but it didn’t have a rule to ACCEPT any packets to be forwarded either - Load the ip_nat_ftp and ip_conntrack_ftp modules by default</span>
</span></span><span style=display:flex><span><span style=color:#75715e># 0.50 - Initial draft</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#</span>
</span></span><span style=display:flex><span>echo -e <span style=color:#e6db74>&#34;\n\nLoading simple rc.firewall version </span>$FWVER<span style=color:#e6db74>..\n&#34;</span>
</span></span><span style=display:flex><span><span style=color:#75715e># The location of the ’iptables’ program IPTABLES=/sbin/iptables</span>
</span></span><span style=display:flex><span>EXTIF<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;eth0&#34;</span>
</span></span><span style=display:flex><span>EXTIF2<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;eth3&#34;</span>
</span></span><span style=display:flex><span>EXTIF3<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;sl+&#34;</span>
</span></span><span style=display:flex><span>INTIF<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;eth1&#34;</span>
</span></span><span style=display:flex><span>INTIF2<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;eth2&#34;</span>
</span></span><span style=display:flex><span>INTIF3<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;ppp+&#34;</span>
</span></span><span style=display:flex><span>LAN1<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;1.1.1.0/16&#34;</span>
</span></span><span style=display:flex><span>echo <span style=color:#e6db74>&#34; External Interface : </span>$EXTIF<span style=color:#e6db74>&#34;</span>
</span></span><span style=display:flex><span>echo <span style=color:#e6db74>&#34; External Interface 2 : </span>$EXTIF2<span style=color:#e6db74>&#34;</span>
</span></span><span style=display:flex><span>echo <span style=color:#e6db74>&#34; External Interface 3 : </span>$EXTIF3<span style=color:#e6db74>&#34;</span>
</span></span><span style=display:flex><span>echo <span style=color:#e6db74>&#34; -----------------------------&#34;</span>
</span></span><span style=display:flex><span>echo <span style=color:#e6db74>&#34; Internal Interface : </span>$INTIF<span style=color:#e6db74>&#34;</span>
</span></span><span style=display:flex><span>echo <span style=color:#e6db74>&#34; Internal Interface 2 : </span>$INTIF2<span style=color:#e6db74>&#34;</span>
</span></span><span style=display:flex><span>echo <span style=color:#e6db74>&#34; Internal Interface 3 : </span>$INTIF3<span style=color:#e6db74>&#34;</span>
</span></span><span style=display:flex><span>echo <span style=color:#e6db74>&#34; -----------------------------&#34;</span>
</span></span><span style=display:flex><span>echo <span style=color:#e6db74>&#34; Internal Network : </span>$LAN1<span style=color:#e6db74>&#34;</span>
</span></span><span style=display:flex><span>echo <span style=color:#e6db74>&#34; enabling forwarding..&#34;</span>
</span></span><span style=display:flex><span>echo <span style=color:#e6db74>&#34;1&#34;</span> &gt; /proc/sys/net/ipv4/ip_forward
</span></span><span style=display:flex><span>echo <span style=color:#e6db74>&#34; enabling DynamicAddr..&#34;</span>
</span></span><span style=display:flex><span>echo <span style=color:#e6db74>&#34;1&#34;</span> &gt; /proc/sys/net/ipv4/ip_dynaddr
</span></span><span style=display:flex><span><span style=color:#75715e># Borrar reglas anteriores tanto en normal como en nat y por defecto no enrutar</span>
</span></span><span style=display:flex><span>$IPTABLES -t nat -F
</span></span><span style=display:flex><span>$IPTABLES -F
</span></span><span style=display:flex><span>$IPTABLES -P FORWARD DROP
</span></span><span style=display:flex><span><span style=color:#75715e>#Conectar la red local para transferencia de datos</span>
</span></span><span style=display:flex><span>$IPTABLES -A FORWARD -s $LAN1 -d $LAN1 -j ACCEPT
</span></span><span style=display:flex><span><span style=color:#75715e>#Pasar datos desde las locales a inet</span>
</span></span><span style=display:flex><span>$IPTABLES -A FORWARD -s $LAN1 -o $EXTIF -j ACCEPT
</span></span><span style=display:flex><span><span style=color:#75715e># Aceptar paquetes de entrada a la local</span>
</span></span><span style=display:flex><span>$IPTABLES -A FORWARD -i $EXTIF -d $LAN1 -m state —state ESTABLISHED,RELATED -j ACCEPT
</span></span><span style=display:flex><span><span style=color:#75715e># Enmascarar a internet</span>
</span></span><span style=display:flex><span>$IPTABLES -t nat -A POSTROUTING -o $EXTIF -j MASQUERADE
</span></span><span style=display:flex><span><span style=color:#75715e>#Pasar datos desde las locales a la wireless</span>
</span></span><span style=display:flex><span>$IPTABLES -A FORWARD -s $LAN1 -o $EXTIF2 -j ACCEPT
</span></span><span style=display:flex><span>$IPTABLES -A FORWARD -i $EXTIF2 -d $LAN1 -m state —state ESTABLISHED,RELATED -j ACCEPT
</span></span><span style=display:flex><span><span style=color:#75715e># Enmascarar a la wireless</span>
</span></span><span style=display:flex><span>$IPTABLES -t nat -A POSTROUTING -s $LAN1 -o $EXTIF2 -j MASQUERADE
</span></span><span style=display:flex><span><span style=color:#75715e>#Entrada de la red local a los túneles wireless (sl+)</span>
</span></span><span style=display:flex><span>$IPTABLES -A FORWARD -s $LAN1 -o $EXTIF3 -j ACCEPT
</span></span><span style=display:flex><span>$IPTABLES -A FORWARD -i $EXTIF3 -d $LAN1 -m state —state ESTABLISHED,RELATED -j ACCEPT
</span></span><span style=display:flex><span><span style=color:#75715e># Enmascarar a los túneles</span>
</span></span><span style=display:flex><span>$IPTABLES -t nat -A POSTROUTING -s $LAN1 -o $EXTIF3 -j MASQUERADE
</span></span><span style=display:flex><span><span style=color:#75715e>#Paquetes de entrada entre las wireless y los túneles Wireless (sl+)</span>
</span></span><span style=display:flex><span>$IPTABLES -A FORWARD -i $EXTIF2 -o $EXTIF3 -j ACCEPT
</span></span><span style=display:flex><span>$IPTABLES -A FORWARD -i $EXTIF3 -o $EXTIF2 -j ACCEPT
</span></span><span style=display:flex><span><span style=color:#75715e># Paquetes de entrada de la VPN a internet y a la wireless</span>
</span></span><span style=display:flex><span>$IPTABLES -A FORWARD -i $INTIF3 -o $EXTIF -j ACCEPT
</span></span><span style=display:flex><span>$IPTABLES -A FORWARD -i $EXTIF -o $INTIF3 -m state —state ESTABLISHED,RELATED -j ACCEPT
</span></span><span style=display:flex><span>$IPTABLES -A FORWARD -i $INTIF3 -o $EXTIF2 -j ACCEPT
</span></span><span style=display:flex><span>$IPTABLES -A FORWARD -i $EXTIF2 -o $INTIF3 -m state —state ESTABLISHED,RELATED -j ACCEPT
</span></span><span style=display:flex><span><span style=color:#75715e># Programas</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#------------------------------------------</span>
</span></span><span style=display:flex><span><span style=color:#75715e># Proxy Transparente</span>
</span></span><span style=display:flex><span>echo <span style=color:#e6db74>&#34;Transparent Proxy for SQUID&#34;</span>
</span></span><span style=display:flex><span>$IPTABLES -t nat -A PREROUTING -p TCP —dport <span style=color:#ae81ff>80</span> -j REDIRECT —to-port <span style=color:#ae81ff>3128</span> -d ! $LAN1
</span></span><span style=display:flex><span>$IPTABLES -t nat -A PREROUTING -p TCP —dport <span style=color:#ae81ff>25</span> -j REDIRECT —to-port <span style=color:#ae81ff>25</span> -d ! $LAN1
</span></span><span style=display:flex><span>$IPTABLES -t nat -A PREROUTING -p TCP —dport <span style=color:#ae81ff>110</span> -j REDIRECT —to-port <span style=color:#ae81ff>110</span> -d ! $LAN1
</span></span><span style=display:flex><span><span style=color:#75715e># Gnome Meeting</span>
</span></span><span style=display:flex><span>echo <span style=color:#e6db74>&#34;Gnome Meeting&#34;</span>
</span></span><span style=display:flex><span>$IPTABLES -t nat -A PREROUTING -i $EXTIF -p TCP —dport 0000:30010 -j DNAT —to-dest 1.1.1.2
</span></span><span style=display:flex><span>$IPTABLES -t nat -A PREROUTING -i $EXTIF -p TCP —dport <span style=color:#ae81ff>1720</span> -j DNAT —to-dest 1.1.1.2
</span></span><span style=display:flex><span>$IPTABLES -A FORWARD -p tcp -i $EXTIF —dport 30000:30010 -d 1.1.1.2 -j ACCEPT
</span></span><span style=display:flex><span>$IPTABLES -A FORWARD -p udp -i $EXTIF —dport 5000:5003 -d 1.1.1.2 -j ACCEPT
</span></span><span style=display:flex><span>$IPTABLES -t nat -A PREROUTING -i $EXTIF -p UDP —dport 5000:5003 -j DNAT —to-dest 1.1.1.2
</span></span><span style=display:flex><span>$IPTABLES -A FORWARD -p tcp -i $EXTIF —dport <span style=color:#ae81ff>1720</span> -d 1.1.1.2 -j ACCEPT
</span></span><span style=display:flex><span><span style=color:#75715e>#Aim, MSN</span>
</span></span><span style=display:flex><span>echo <span style=color:#e6db74>&#34;AIM, MSN&#34;</span>
</span></span><span style=display:flex><span>$IPTABLES -t nat -A PREROUTING -i $EXTIF -p tcp —dport <span style=color:#ae81ff>5190</span> -j REDIRECT —to-ports <span style=color:#ae81ff>5190</span>
</span></span><span style=display:flex><span>$IPTABLES -t nat -A PREROUTING -i $EXTIF -p tcp —dport <span style=color:#ae81ff>1863</span> -j REDIRECT —to-ports <span style=color:#ae81ff>1863</span>
</span></span><span style=display:flex><span>$IPTABLES -A INPUT -i $EXTIF -p tcp —dport <span style=color:#ae81ff>5190</span> -j ACCEPT
</span></span><span style=display:flex><span>$IPTABLES -A INPUT -i $EXTIF -p tcp —dport <span style=color:#ae81ff>1863</span> -j ACCEPT
</span></span><span style=display:flex><span>$IPTABLES -A INPUT -i $EXTIF -p tcp —dport <span style=color:#ae81ff>4443</span> -j ACCEPT
</span></span><span style=display:flex><span>$IPTABLES -A INPUT -i $EXTIF -p tcp —dport <span style=color:#ae81ff>5566</span> -j ACCEPT
</span></span><span style=display:flex><span>$IPTABLES -A INPUT -i $EXTIF -p tcp —dport <span style=color:#ae81ff>1864</span> -j ACCEPT
</span></span><span style=display:flex><span><span style=color:#75715e>#VNC Deneb :0</span>
</span></span><span style=display:flex><span>echo <span style=color:#e6db74>&#34;VNC&#34;</span>
</span></span><span style=display:flex><span>$IPTABLES -A FORWARD -i $EXTIF -p TCP —dport <span style=color:#ae81ff>5800</span> -j ACCEPT
</span></span><span style=display:flex><span>$IPTABLES -A FORWARD -i $EXTIF -p TCP —dport <span style=color:#ae81ff>5900</span> -j ACCEPT
</span></span><span style=display:flex><span>$IPTABLES -t nat -A PREROUTING -i $EXTIF -p TCP —dport <span style=color:#ae81ff>5800</span> -j DNAT —to 1.1.1.2:5800
</span></span><span style=display:flex><span>$IPTABLES -t nat -A PREROUTING -i $EXTIF -p TCP —dport <span style=color:#ae81ff>5900</span> -j DNAT —to 1.1.1.2:5900
</span></span><span style=display:flex><span>$IPTABLES -A FORWARD -i $EXTIF -p TCP —dport <span style=color:#ae81ff>5500</span> -j ACCEPT
</span></span><span style=display:flex><span>$IPTABLES -t nat -A PREROUTING -i $EXTIF -p TCP —dport <span style=color:#ae81ff>5500</span> -j DNAT —to 1.1.1.2:5500
</span></span><span style=display:flex><span><span style=color:#75715e>#Firewall</span>
</span></span><span style=display:flex><span>echo <span style=color:#e6db74>&#34;Firewall&#34;</span>
</span></span><span style=display:flex><span>$IPTABLES -A INPUT -p TCP —dport <span style=color:#ae81ff>3306</span> -i $EXTIF -j DROP
</span></span><span style=display:flex><span>$IPTABLES -A INPUT -p TCP —dport <span style=color:#ae81ff>3306</span> -i $EXTIF2 -j DROP
</span></span><span style=display:flex><span>$IPTABLES -A INPUT -p TCP —dport <span style=color:#ae81ff>3128</span> -i $EXTIF -j DROP
</span></span><span style=display:flex><span>$IPTABLES -A INPUT -p TCP —dport <span style=color:#ae81ff>53</span> -i $EXTIF -j DROP
</span></span><span style=display:flex><span>$IPTABLES -A INPUT -p TCP —dport <span style=color:#ae81ff>25</span> -i $EXTIF -j DROP
</span></span><span style=display:flex><span>$IPTABLES -A INPUT -p TCP —dport <span style=color:#ae81ff>25</span> -i $EXTIF2 -j DROP
</span></span><span style=display:flex><span>$IPTABLES -A INPUT -p TCP —dport <span style=color:#ae81ff>137</span> -i $EXTIF -j DROP
</span></span><span style=display:flex><span>$IPTABLES -A INPUT -p TCP —dport <span style=color:#ae81ff>137</span> -i $EXTIF2 -j DROP
</span></span><span style=display:flex><span>$IPTABLES -A INPUT -p TCP —dport <span style=color:#ae81ff>139</span> -i $EXTIF -j DROP
</span></span><span style=display:flex><span>$IPTABLES -A INPUT -p TCP —dport <span style=color:#ae81ff>139</span> -i $EXTIF2 -j DROP
</span></span><span style=display:flex><span>$IPTABLES -A INPUT -p TCP —dport <span style=color:#ae81ff>179</span> -i $EXTIF -j DROP
</span></span><span style=display:flex><span>$IPTABLES -A INPUT -p TCP —dport 2600:2605 -i $EXTIF -j DROP
</span></span><span style=display:flex><span>$IPTABLES -A INPUT -p TCP —dport <span style=color:#ae81ff>179</span> -i $EXTIF2 -j DROP
</span></span><span style=display:flex><span>$IPTABLES -A INPUT -p TCP —dport 2600:2605 -i $EXTIF2 -j DROP
</span></span></code></pre></div><p>Si nos olvidamos hasta donde pone algo con IPTABLES, lo que tenemos es un script que habilita la funcionalidad de enrutado del kernel de linux, a partir de ese momento ya tendremos acceso &ldquo;teórico&rdquo; a internet&mldr;</p><p>El problema es que como sólo tendremos una dirección IP válida, lo que tendremos que hacer es hacer NAT (Network Address Translation), existen dos tipos de NAT, el de destino y el de origen, en nuestro caso es el de origen, es decir, al final, los datos que salgan tendrán que aparentar ser todos desde la misma IP&mldr;</p><p>Para eso utilizamos esas sentencias de iptables que es el firewall, etc incorporado en Linux:</p><p>Lo de hacerlo con variables (las definidas al principio), es por facilidad a la hora de modificarlo, como veréis las redes están definidas como IP/bits para hacer las conversiones acudid a: <a href=http://www.linux-es.com/ipcalc.php>http://www.linux-es.com/ipcalc.php</a></p><p>Las reglas definidas en este fichero, permiten que todo lo que salga por la eth0 (Internet) sea con NAT y que a su vez, lo que salga por eth3 (la wireless) sea también con NAT (para tener acceso a la wireless desde la red local), luego permite el tráfico de paquetes entre las ip&rsquo;s de las redes locales.</p><p>El script original fue modificado para cumplir con los requisitos de mi red, así que cada uno que lo adapte a la suya para que le sea útil.</p><p>Vale, un punto importante, es que al tener un trasto conectado todo el día a Internet, lo mejor es tenerlo bien asegurado, por eso, contar con una buena configuración de firewall así como el portscanner vendrá bien. Port scanner analiza y registra todos los intentos de escaneo de puertos contra nuestro equipo y posteriormente impide todo acceso desde las ip&rsquo;s originantes, tanto creando rutas nulas como vuelta a esas ip&rsquo;s como añadiéndola a los filtros de los TCP-wrappers En
/etc/portsentry.ignore.static, pondremos:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style=display:flex><span>127.0.0.1/32 0.0.0.0 1.1.0.0/16
</span></span></code></pre></div><p>Para que no bloquee los locales (como indica en la ayuda) y añadimos los de nuestra red local&mldr; equipos con IP 1.1.<em>.</em> (esto permite bloquear a los graciositos que se conecten por la wireless&mldr;)</p><p>Luego, en el /etc/porsentry/portsentry.conf cambiaremos:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>BLOCK_UDP<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;1&#34;</span>
</span></span><span style=display:flex><span>BLOCK_TCP<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;1&#34;</span>
</span></span></code></pre></div><p>y entre las otras opciones escogeremos las aptas para nuestro sistema, el tipo de bloqueo a realizar, etc</p><p>Ahora si alguien intenta hacer el tonto haciendo escaneos de puertos, pues automáticamente le será impedido posterior acceso desde esa Ip&mldr;</p><p>Para arrancar el script del firewall crearemos un script con el formato estándar tal como sigue:</p><p>/etc/init.d/fire</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e>#!bash
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#75715e>#!/bin/sh</span>
</span></span><span style=display:flex><span>IPTABLES<span style=color:#f92672>=</span>/sbin/iptables
</span></span><span style=display:flex><span><span style=color:#75715e># See how we were called.</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>case</span> <span style=color:#e6db74>&#34;</span>$1<span style=color:#e6db74>&#34;</span> in
</span></span><span style=display:flex><span>    start<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>        /etc/init.d/rc.firewall
</span></span><span style=display:flex><span>       ;;
</span></span><span style=display:flex><span>    stop<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>        echo -e <span style=color:#e6db74>&#34;\nFlushing firewall and setting default policies to DROP\n&#34;</span>
</span></span><span style=display:flex><span>        $IPTABLES -P INPUT DROP
</span></span><span style=display:flex><span>        $IPTABLES -F INPUT
</span></span><span style=display:flex><span>        $IPTABLES -P OUTPUT DROP
</span></span><span style=display:flex><span>        $IPTABLES -F OUTPUT
</span></span><span style=display:flex><span>        $IPTABLES -P FORWARD DROP
</span></span><span style=display:flex><span>        $IPTABLES -F FORWARD
</span></span><span style=display:flex><span>        $IPTABLES -F -t nat
</span></span><span style=display:flex><span>        <span style=color:#75715e># Delete all User-specified chains</span>
</span></span><span style=display:flex><span>        $IPTABLES -X
</span></span><span style=display:flex><span>        <span style=color:#75715e># Reset all IPTABLES counters</span>
</span></span><span style=display:flex><span>        $IPTABLES -Z
</span></span><span style=display:flex><span>        ;;
</span></span><span style=display:flex><span>    restart<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>        $0 stop
</span></span><span style=display:flex><span>        $0 start
</span></span><span style=display:flex><span>        ;;
</span></span><span style=display:flex><span>    status<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>        $IPTABLES -L
</span></span><span style=display:flex><span>        ;;
</span></span><span style=display:flex><span>    mlist<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>        cat /proc/net/ip_conntrack
</span></span><span style=display:flex><span>        ;;
</span></span><span style=display:flex><span>    *<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>        echo <span style=color:#e6db74>&#34;Usage: fire start|stop|status|mlist&#34;</span>
</span></span><span style=display:flex><span>        exit <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>        ;;
</span></span><span style=display:flex><span><span style=color:#66d9ef>esac</span>
</span></span></code></pre></div><p>Si ahora creamos los enlaces simbólicos apropiados a este script en <code>/etc/rc?.d</code> pondremos especificar cuando queremos que se arranque el
enrutamiento&mldr;</p><p>En mi caso:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>rc0.d/K20fire
</span></span><span style=display:flex><span>rc1.d/K20fire
</span></span><span style=display:flex><span>rc2.d/S20fire
</span></span><span style=display:flex><span>rc3.d/S20fire
</span></span><span style=display:flex><span>rc4.d/S20fire
</span></span><span style=display:flex><span>rc5.d/S20fire
</span></span><span style=display:flex><span>rc6.d/K20fire
</span></span></code></pre></div><p>En esas carpetas dentro de /etc</p><p>Un problema que tendremos al apagar el ordenador, es que como no tendremos monitor, no podremos saber cuando está listo para apagar y no vamos a conectar un monitor cada vez para hacerlo&mldr;</p><p>Túneles</p><p>Ahora que parece que está más o menos esto en marcha, habría que hacer túneles entre los distintos nodos de otras personas, para eso os recomiendo el paquete VPND junto a los scripts de VPNS: VPN&rsquo;s <a href=http://freshmeat.net/projects/vpns/>http://freshmeat.net/projects/vpns/</a></p><p>Hay un bonito README en el VPNS.</p><h3 id=consejos-finales>Consejos Finales<a hidden class=anchor aria-hidden=true href=#consejos-finales>#</a></h3><p>Vale, nuestro servidor tiene las tarjetas configuradas, enruta, hace de servidor DHCP, DNS, bloquea los escaneos de puertos&mldr; ahora sólo queda algún detalle interesante:</p><p>Lo primero: activar el soporte para el sistema de ficheros ext3, su compatibilidad con el ext2 es total, el cambio se hace simplemente poniendo:</p><p><code>tune2fs -j /dev/hda1</code> (para la partición 1 del hd) y luego editando el /etc/fstab y donde ponga /dev/hda1 cambiar ext2 por ext3&mldr;</p><p>De ese modo, el sistema arrancará igual, pero con una ventaja&mldr; en caso de apagón, bloqueo, reseteo, etc, el sistema de ficheros ext3 crea un log de los cambios realizados y en esas situaciones, al siguiente rearranque, los puede corregir en la mayoría de las situaciones el solito, provocando que si se va la luz, en cuanto vuelva, automáticamente intente arrancar el solito (y en la mayoría de los casos lo conseguirá ;))</p><p>Otras cosas útiles&mldr;. configurar el SMB para poder acceder desde la red local con Windows&mldr; así el servidor que hace de nodo, puede quedarse bajando cosas por la noche (si es nodo tiene que estar todo el día en marcha) y luego simplemente te las transfieres a tu equipo mediante el entorno de red&mldr; (Existen hotwtos que lo explican muy bien así que&mldr;. a usar el Google que para eso está&mldr;)</p><p>Sería también recomendable que instalases el DNS2GO que permite asignar un nombre de dominio a una IP dinámica, de ese modo podrías aprovechar para poner una página web en tu nodo con el apache e instalar el webalizer para analizar sus visitas, etc Como DNS2GO es ahora de pago, yo utilizo NO-IP. En Debian tenéis un paquete llamado no-ip que incorpora un cliente listo para configurar y así actualizar automáticamente vuestra ip dinámica en el servidor DNS.</p><p>Para configurar el zebra, lo único que tengo hecho por el momento es editar el /etc/zebra/daemons y activar zebra, ospfd y el bgpd&mldr; cuando tenga tarjetas lo probaré y diré&mldr; (de esto se está encargando Hilario de ValenciaWireless</p><p>Por el momento es todo&mldr; con esto tienes un nodo&mldr; puedes acceder por SSH a el para configurarlo remotamente (el putty es un buen cliente para Windows, WinSCP para transferencias seguras de archivos ;)), configurarlo por web (Webmin) y ya con eso para empezar está bien&mldr;</p><p>Respecto a la VPN (pptpd)&mldr; Pues antes no&mldr; pero ahora ya va a la perfección ;)</p><p>Si no te conectas mediante VPN mediante la tarjeta de la wireless (eth3 en mi caso) no hay Internet (excepto por página web al puerto 80), y si te validas sí&mldr; así que si tienes poco ancho de banda, puedes controlar si accedes o no desde fuera de tu red casera&mldr; es decir.. gastas la red inalámbrica para acceder al de tu casita y una vez ahí accedes a través de ese a Internet ;)</p><p>Sería interesante activar también un Proxy tipo Squid para acelerar la navegación por Internet&mldr; tanto por la red local, como para los nodos (puedes restringir por ip&rsquo;s, etc ) (yo lo tengo puesto además con el adzapper, que me permite eliminar muchísimos anuncios de las webs por las que navego)</p><p>¡¡Un saludo y suerte!!</p><h3 id=ficheros-de-configuración>Ficheros de configuración<a hidden class=anchor aria-hidden=true href=#ficheros-de-configuración>#</a></h3><h4 id=squid>Squid<a hidden class=anchor aria-hidden=true href=#squid>#</a></h4><pre tabindex=0><code class=language-config data-lang=config>acl local src 1.1.0.0/16
http_access allow local
maximum_object_size 32768 KB
cache_dir ufs /var/spool/squid 512 16 256
httpd_accel_uses_host_header on
redirect_program /usr/lib/squid/squid_redirect
redirect_children 30 # PPTPD (para las VPN entrantes)
</code></pre><h4 id=etcppppptpd-options>/etc/ppp/pptpd-options<a hidden class=anchor aria-hidden=true href=#etcppppptpd-options>#</a></h4><pre tabindex=0><code class=language-config data-lang=config>debug
name in chap-secrets
name Merak
auth
+chap
ms-dns 192.168.0.1
netmask 255.255.0.0
lock
</code></pre><h4 id=etcpppchap-secrets>/etc/ppp/chap-secrets<a hidden class=anchor aria-hidden=true href=#etcpppchap-secrets>#</a></h4><pre tabindex=0><code class=language-config data-lang=config># Secrets for authentication using CHAP
# client server secret IP addresses
prueba * probando *
</code></pre><p>Disfruta! (y si lo haces, puedes
<a href=https://ko-fi.com/I2I4KDA0V target=_blank><img src=https://storage.ko-fi.com/cdn/brandasset/kofi_s_logo_nolabel.png height=36 style=border:0;height:36px;vertical-align:middle;display:inline-block border=0>
</img>
Invitarme a un café
</a>)</p></div><footer class=post-footer><ul class=post-tags><li><a href=https://iranzo.io/es/tags/linux/>Linux</a></li><li><a href=https://iranzo.io/es/tags/wireless/>Wireless</a></li><li><a href=https://iranzo.io/es/tags/router/>Router</a></li><li><a href=https://iranzo.io/es/tags/firewall/>Firewall</a></li><li><a href=https://iranzo.io/es/tags/foss/>Foss</a></li></ul><nav class=paginav><a class=prev href=https://iranzo.io/es/blog/2004/02/06/configurar-exim3-con-mailscanner-y-clamav/><span class=title>« Anterior</span><br><span>Configurar Exim3 con MailScanner y ClamAV</span>
</a><a class=next href=https://iranzo.io/es/blog/2003/06/03/bookcrossing-libera-tus-libros/><span class=title>Siguiente »</span><br><span>Bookcrossing - Libera tus libros</span></a></nav><ul class=share-buttons><li><a target=_blank rel="noopener noreferrer" aria-label="share Montar un router con la idea de wireless on x" href="https://x.com/intent/tweet/?text=Montar%20un%20router%20con%20la%20idea%20de%20wireless&amp;url=https%3a%2f%2firanzo.io%2fes%2fblog%2f2003%2f06%2f18%2fmontar-un-router-con-la-idea-de-wireless%2f&amp;hashtags=linux%2cwireless%2crouter%2cfirewall%2cfoss"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M512 62.554V449.446C512 483.97 483.97 512 449.446 512H62.554C28.03 512 0 483.97.0 449.446V62.554C0 28.03 28.029.0 62.554.0H449.446C483.971.0 512 28.03 512 62.554zM269.951 190.75 182.567 75.216H56L207.216 272.95 63.9 436.783h61.366L235.9 310.383l96.667 126.4H456L298.367 228.367l134-153.151H371.033zM127.633 110h36.468l219.38 290.065H349.5z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Montar un router con la idea de wireless on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2firanzo.io%2fes%2fblog%2f2003%2f06%2f18%2fmontar-un-router-con-la-idea-de-wireless%2f&amp;title=Montar%20un%20router%20con%20la%20idea%20de%20wireless&amp;summary=Montar%20un%20router%20con%20la%20idea%20de%20wireless&amp;source=https%3a%2f%2firanzo.io%2fes%2fblog%2f2003%2f06%2f18%2fmontar-un-router-con-la-idea-de-wireless%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Montar un router con la idea de wireless on reddit" href="https://reddit.com/submit?url=https%3a%2f%2firanzo.io%2fes%2fblog%2f2003%2f06%2f18%2fmontar-un-router-con-la-idea-de-wireless%2f&title=Montar%20un%20router%20con%20la%20idea%20de%20wireless"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Montar un router con la idea de wireless on facebook" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2firanzo.io%2fes%2fblog%2f2003%2f06%2f18%2fmontar-un-router-con-la-idea-de-wireless%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Montar un router con la idea de wireless on whatsapp" href="https://api.whatsapp.com/send?text=Montar%20un%20router%20con%20la%20idea%20de%20wireless%20-%20https%3a%2f%2firanzo.io%2fes%2fblog%2f2003%2f06%2f18%2fmontar-un-router-con-la-idea-de-wireless%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Montar un router con la idea de wireless on telegram" href="https://telegram.me/share/url?text=Montar%20un%20router%20con%20la%20idea%20de%20wireless&amp;url=https%3a%2f%2firanzo.io%2fes%2fblog%2f2003%2f06%2f18%2fmontar-un-router-con-la-idea-de-wireless%2f"><svg viewBox="2 2 28 28" height="30" width="30" fill="currentcolor"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Montar un router con la idea de wireless on ycombinator" href="https://news.ycombinator.com/submitlink?t=Montar%20un%20router%20con%20la%20idea%20de%20wireless&u=https%3a%2f%2firanzo.io%2fes%2fblog%2f2003%2f06%2f18%2fmontar-un-router-con-la-idea-de-wireless%2f"><svg width="30" height="30" viewBox="0 0 512 512" fill="currentcolor" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape"><path d="M449.446.0C483.971.0 512 28.03 512 62.554V449.446C512 483.97 483.97 512 449.446 512H62.554C28.03 512 0 483.97.0 449.446V62.554C0 28.03 28.029.0 62.554.0H449.446zM183.8767 87.9921h-62.034L230.6673 292.4508V424.0079h50.6655V292.4508L390.1575 87.9921H328.1233L256 238.2489z"/></svg></a></li></ul></footer></article></main><footer class=footer><span>&copy; 2025 <a href=https://iranzo.io/es/>Pablo Iranzo Gómez blog</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><center><small>This blog is a participant in the Amazon Associate Program, an affiliate advertising program designed to provide a means for sites to earn advertising fees by advertising and linking to Amazon.</small></center><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copiar";function s(){t.innerHTML="¡copiado!",setTimeout(()=>{t.innerHTML="copiar"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>