---
layout: post
title: RHEV/OVIRT API with Python
date: '2012-10-24T13:38:00.003+02:00'
author: Pablo Iranzo Gómez
tags: 
modified_time: '2012-10-25T01:50:16.848+02:00'
blogger_id: tag:blogger.com,1999:blog-4564313404841923839.post-1003448890473219410
blogger_orig_url: http://iranzop.blogspot.com/2012/10/rhevovirt-api-with-python.html
---

RHEV/OVIRT api allows faster and simple development of scripts / utilities ranging from gathering of information to VM/host, etc manipulation.


For example, a simple script for connecting to API and list VM's could be:

<pre class='brush: python'><br />import sys<br />import getopt<br />import optparse<br />import os<br />import time<br /> <br />from ovirtsdk.api import API<br />from ovirtsdk.xml import params<br />from random import choice<br /><br />baseurl = "https://localhost:8443"<br />api = API(url=baseurl, username="admin@internal",password="redhat",insecure=True)<br />for vm in api.vms.list():<br />  print vm.name<br /></pre>


<br/><br/>The .list() method works pretty well, but beware, it limits collections to 100 elements for performance reasons, so in those cases, we'll need to check how many results do we have, and paginate by passing an extra argument to our ".list()" invocation, for example:<br/><pre class='brush: python'>&lt;br&gt;for vm in api.vms.list(query="page 1")</pre><br/><br/>Furthermore, we can check the number of results by using:<br/><br/><pre class='brush: python'>&lt;br&gt;len(api.vms.list(query="page 1"))</pre><br/><br/>And playing together, we could set a list that returns all results by running:<br/><br/><pre class='brush: python'>&lt;br&gt;vms = []&lt;br&gt;page = 0&lt;br&gt;length = 100&lt;br&gt;while (length &gt; 0):&lt;br&gt;  page = page + 1&lt;br&gt;  query = "%s page %s" % (oquery, page)&lt;br&gt;  tanda = api.vms.list(query=query)&lt;br&gt;  length = len(tanda)&lt;br&gt;  for vm in tanda:&lt;br&gt;    vms.append(vm)</pre><br/><br/>We can also make funny things like migrate VM's to another host by just running:<br/><br/><pre class='brush: python'>&lt;br&gt;vm.migrate()</pre><br/><br/>It's expected for RHEV 3.1 to have a developer guide (now in Beta) at <a href='https://access.redhat.com/knowledge/docs/en-US/Red_Hat_Enterprise_Virtualization/3.1-Beta/html-single/Developer_Guide/index.html'>https://access.redhat.com/knowledge/docs/en-US/Red_Hat_Enterprise_Virtualization/3.1-Beta/html-single/Developer_Guide/index.html </a><br/><br/>Check it for more examples of use and put the Virtualization to work for you!</div>
